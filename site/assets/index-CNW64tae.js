const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browserAll-DZR8wNOk.js","assets/webworkerAll-D35_AM7w.js","assets/Filter-C_nr9wlU.js","assets/WebGPURenderer-CwNZDwNR.js","assets/BufferResource-Dvq917Ln.js","assets/RenderTargetSystem-CmxQB0dx.js","assets/CanvasPool-CygTT4g9.js","assets/WebGLRenderer-BtnqX3ch.js","assets/CanvasRenderer-BIUS979K.js","assets/BitmapFont-B46MHoBj.js"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const n of i)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(i){const n={};return i.integrity&&(n.integrity=i.integrity),i.referrerPolicy&&(n.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?n.credentials="include":i.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function r(i){if(i.ep)return;i.ep=!0;const n=e(i);fetch(i.href,n)}})();const Wi=!1;var Sn=Array.isArray,xc=Array.prototype.indexOf,gs=Array.prototype.includes,Jr=Array.from,No=Object.defineProperty,Js=Object.getOwnPropertyDescriptor,$o=Object.getOwnPropertyDescriptors,bc=Object.prototype,vc=Array.prototype,Cn=Object.getPrototypeOf,sa=Object.isExtensible;const le=()=>{};function wc(s){return s()}function Vr(s){for(var t=0;t<s.length;t++)s[t]()}function Vo(){var s,t,e=new Promise((r,i)=>{s=r,t=i});return{promise:e,resolve:s,reject:t}}const pt=2,pr=4,mr=8,Wo=1<<24,de=16,Kt=32,Je=64,Hi=128,Ft=512,ut=1024,mt=2048,Yt=4096,Pt=8192,Se=16384,je=32768,Xe=65536,ra=1<<17,Ho=1<<18,Is=1<<19,jo=1<<20,oe=1<<25,Ye=65536,ji=1<<21,Pn=1<<22,Ce=1<<23,Pe=Symbol("$state"),Ac=Symbol(""),Ue=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"},Sc=!!globalThis.document?.contentType&&globalThis.document.contentType.includes("xml");function Xo(s){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function Cc(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function Pc(s,t,e){throw new Error("https://svelte.dev/e/each_key_duplicate")}function Mc(s){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Tc(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function kc(s){throw new Error("https://svelte.dev/e/effect_orphan")}function Ec(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Ic(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Rc(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function Bc(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function Fc(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Gc=1,Lc=2,Yo=4,Dc=8,Oc=16,zc=1,Uc=2,dt=Symbol(),qo="http://www.w3.org/1999/xhtml";function Nc(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function $c(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Ko(s){return s===this.v}function Zo(s,t){return s!=s?t==t:s!==t||s!==null&&typeof s=="object"||typeof s=="function"}function Qo(s){return!Zo(s,this.v)}let gr=!1,Vc=!1;function Wc(){gr=!0}let K=null;function ys(s){K=s}function Ot(s,t=!1,e){K={p:K,i:!1,c:null,e:null,s,x:null,l:gr&&!t?{s:null,u:null,$:[]}:null}}function zt(s){var t=K,e=t.e;if(e!==null){t.e=null;for(var r of e)yl(r)}return s!==void 0&&(t.x=s),t.i=!0,K=t.p,s??{}}function yr(){return!gr||K!==null&&K.l===null}let os=[];function Hc(){var s=os;os=[],Vr(s)}function Me(s){if(os.length===0){var t=os;queueMicrotask(()=>{t===os&&Hc()})}os.push(s)}function Jo(s){var t=z;if(t===null)return L.f|=Ce,s;if((t.f&je)===0&&(t.f&pr)===0)throw s;ve(s,t)}function ve(s,t){for(;t!==null;){if((t.f&Hi)!==0){if((t.f&je)===0)throw s;try{t.b.error(s);return}catch(e){s=e}}t=t.parent}throw s}const jc=-7169;function Q(s,t){s.f=s.f&jc|t}function Mn(s){(s.f&Ft)!==0||s.deps===null?Q(s,ut):Q(s,Yt)}function tl(s){if(s!==null)for(const t of s)(t.f&pt)===0||(t.f&Ye)===0||(t.f^=Ye,tl(t.deps))}function el(s,t,e){(s.f&mt)!==0?t.add(s):(s.f&Yt)!==0&&e.add(s),tl(s.deps),Q(s,ut)}const wr=new Set;let H=null,Xi=null,Wt=null,It=[],Tn=null,Yi=!1,us=class sl{current=new Map;previous=new Map;#e=new Set;#o=new Set;#t=0;#n=0;#s=null;#a=new Set;#r=new Set;#i=new Map;is_fork=!1;#l=!1;#c(){return this.is_fork||this.#n>0}skip_effect(t){this.#i.has(t)||this.#i.set(t,{d:[],m:[]})}unskip_effect(t){var e=this.#i.get(t);if(e){this.#i.delete(t);for(var r of e.d)Q(r,mt),jt(r);for(r of e.m)Q(r,Yt),jt(r)}}process(t){It=[],this.apply();var e=[],r=[];for(const i of t)this.#h(i,e,r);if(this.#c()){this.#u(r),this.#u(e);for(const[i,n]of this.#i)nl(i,n)}else{for(const i of this.#e)i();this.#e.clear(),this.#t===0&&this.#f(),Xi=this,H=null,ia(r),ia(e),Xi=null,this.#s?.resolve()}Wt=null}#h(t,e,r){t.f^=ut;for(var i=t.first;i!==null;){var n=i.f,a=(n&(Kt|Je))!==0,o=a&&(n&ut)!==0,l=o||(n&Pt)!==0||this.#i.has(i);if(!l&&i.fn!==null){a?i.f^=ut:(n&pr)!==0?e.push(i):xr(i)&&((n&de)!==0&&this.#r.add(i),xs(i));var h=i.first;if(h!==null){i=h;continue}}for(;i!==null;){var c=i.next;if(c!==null){i=c;break}i=i.parent}}}#u(t){for(var e=0;e<t.length;e+=1)el(t[e],this.#a,this.#r)}capture(t,e){e!==dt&&!this.previous.has(t)&&this.previous.set(t,e),(t.f&Ce)===0&&(this.current.set(t,t.v),Wt?.set(t,t.v))}activate(){H=this,this.apply()}deactivate(){H===this&&(H=null,Wt=null)}flush(){if(this.activate(),It.length>0){if(Xc(),H!==null&&H!==this)return}else this.#t===0&&this.process([]);this.deactivate()}discard(){for(const t of this.#o)t(this);this.#o.clear()}#f(){if(wr.size>1){this.previous.clear();var t=Wt,e=!0;for(const i of wr){if(i===this){e=!1;continue}const n=[];for(const[o,l]of this.current){if(i.current.has(o))if(e&&l!==i.current.get(o))i.current.set(o,l);else continue;n.push(o)}if(n.length===0)continue;const a=[...i.current.keys()].filter(o=>!this.current.has(o));if(a.length>0){var r=It;It=[];const o=new Set,l=new Map;for(const h of n)rl(h,a,o,l);if(It.length>0){H=i,i.apply();for(const h of It)i.#h(h,[],[]);i.deactivate()}It=r}}H=null,Wt=t}wr.delete(this)}increment(t){this.#t+=1,t&&(this.#n+=1)}decrement(t){this.#t-=1,t&&(this.#n-=1),!this.#l&&(this.#l=!0,Me(()=>{this.#l=!1,this.#c()?It.length>0&&this.flush():this.revive()}))}revive(){for(const t of this.#a)this.#r.delete(t),Q(t,mt),jt(t);for(const t of this.#r)Q(t,Yt),jt(t);this.flush()}oncommit(t){this.#e.add(t)}ondiscard(t){this.#o.add(t)}settled(){return(this.#s??=Vo()).promise}static ensure(){if(H===null){const t=H=new sl;wr.add(H),Me(()=>{H===t&&t.flush()})}return H}apply(){}};function Xc(){Yi=!0;var s=null;try{for(var t=0;It.length>0;){var e=us.ensure();if(t++>1e3){var r,i;Yc()}e.process(It),Te.clear()}}finally{It=[],Yi=!1,Tn=null}}function Yc(){try{Ec()}catch(s){ve(s,Tn)}}let ae=null;function ia(s){var t=s.length;if(t!==0){for(var e=0;e<t;){var r=s[e++];if((r.f&(Se|Pt))===0&&xr(r)&&(ae=new Set,xs(r),r.deps===null&&r.first===null&&r.nodes===null&&r.teardown===null&&r.ac===null&&vl(r),ae?.size>0)){Te.clear();for(const i of ae){if((i.f&(Se|Pt))!==0)continue;const n=[i];let a=i.parent;for(;a!==null;)ae.has(a)&&(ae.delete(a),n.push(a)),a=a.parent;for(let o=n.length-1;o>=0;o--){const l=n[o];(l.f&(Se|Pt))===0&&xs(l)}}ae.clear()}}ae=null}}function rl(s,t,e,r){if(!e.has(s)&&(e.add(s),s.reactions!==null))for(const i of s.reactions){const n=i.f;(n&pt)!==0?rl(i,t,e,r):(n&(Pn|de))!==0&&(n&mt)===0&&il(i,t,r)&&(Q(i,mt),jt(i))}}function il(s,t,e){const r=e.get(s);if(r!==void 0)return r;if(s.deps!==null)for(const i of s.deps){if(gs.call(t,i))return!0;if((i.f&pt)!==0&&il(i,t,e))return e.set(i,!0),!0}return e.set(s,!1),!1}function jt(s){var t=Tn=s,e=t.b;if(e?.is_pending&&(s.f&(pr|mr|Wo))!==0&&(s.f&je)===0){e.defer_effect(s);return}for(;t.parent!==null;){t=t.parent;var r=t.f;if(Yi&&t===z&&(r&de)!==0&&(r&Ho)===0&&(r&je)!==0)return;if((r&(Je|Kt))!==0){if((r&ut)===0)return;t.f^=ut}}It.push(t)}function nl(s,t){if(!((s.f&Kt)!==0&&(s.f&ut)!==0)){(s.f&mt)!==0?t.d.push(s):(s.f&Yt)!==0&&t.m.push(s),Q(s,ut);for(var e=s.first;e!==null;)nl(e,t),e=e.next}}function qc(s){let t=0,e=qe(0),r;return()=>{In()&&(B(e),xl(()=>(t===0&&(r=Rs(()=>s(()=>tr(e)))),t+=1,()=>{Me(()=>{t-=1,t===0&&(r?.(),r=void 0,tr(e))})})))}}var Kc=Xe|Is;function Zc(s,t,e,r){new Qc(s,t,e,r)}class Qc{parent;is_pending=!1;transform_error;#e;#o=null;#t;#n;#s;#a=null;#r=null;#i=null;#l=null;#c=0;#h=0;#u=!1;#f=new Set;#p=new Set;#d=null;#x=qc(()=>(this.#d=qe(this.#c),()=>{this.#d=null}));constructor(t,e,r,i){this.#e=t,this.#t=e,this.#n=n=>{var a=z;a.b=this,a.f|=Hi,r(n)},this.parent=z.b,this.transform_error=i??this.parent?.transform_error??(n=>n),this.#s=ei(()=>{this.#y()},Kc)}#b(){try{this.#a=Rt(()=>this.#n(this.#e))}catch(t){this.error(t)}}#v(t){const e=this.#t.failed;e&&(this.#i=Rt(()=>{e(this.#e,()=>t,()=>()=>{})}))}#w(){const t=this.#t.pending;t&&(this.is_pending=!0,this.#r=Rt(()=>t(this.#e)),Me(()=>{var e=this.#l=document.createDocumentFragment(),r=Ve();e.append(r),this.#a=this.#g(()=>(us.ensure(),Rt(()=>this.#n(r)))),this.#h===0&&(this.#e.before(e),this.#l=null,We(this.#r,()=>{this.#r=null}),this.#m())}))}#y(){try{if(this.is_pending=this.has_pending_snippet(),this.#h=0,this.#c=0,this.#a=Rt(()=>{this.#n(this.#e)}),this.#h>0){var t=this.#l=document.createDocumentFragment();Sl(this.#a,t);const e=this.#t.pending;this.#r=Rt(()=>e(this.#e))}else this.#m()}catch(e){this.error(e)}}#m(){this.is_pending=!1;for(const t of this.#f)Q(t,mt),jt(t);for(const t of this.#p)Q(t,Yt),jt(t);this.#f.clear(),this.#p.clear()}defer_effect(t){el(t,this.#f,this.#p)}is_rendered(){return!this.is_pending&&(!this.parent||this.parent.is_rendered())}has_pending_snippet(){return!!this.#t.pending}#g(t){var e=z,r=L,i=K;te(this.#s),Dt(this.#s),ys(this.#s.ctx);try{return t()}catch(n){return Jo(n),null}finally{te(e),Dt(r),ys(i)}}#_(t){if(!this.has_pending_snippet()){this.parent&&this.parent.#_(t);return}this.#h+=t,this.#h===0&&(this.#m(),this.#r&&We(this.#r,()=>{this.#r=null}),this.#l&&(this.#e.before(this.#l),this.#l=null))}update_pending_count(t){this.#_(t),this.#c+=t,!(!this.#d||this.#u)&&(this.#u=!0,Me(()=>{this.#u=!1,this.#d&&_s(this.#d,this.#c)}))}get_effect_pending(){return this.#x(),B(this.#d)}error(t){var e=this.#t.onerror;let r=this.#t.failed;if(!e&&!r)throw t;this.#a&&(vt(this.#a),this.#a=null),this.#r&&(vt(this.#r),this.#r=null),this.#i&&(vt(this.#i),this.#i=null);var i=!1,n=!1;const a=()=>{if(i){$c();return}i=!0,n&&Fc(),this.#i!==null&&We(this.#i,()=>{this.#i=null}),this.#g(()=>{us.ensure(),this.#y()})},o=l=>{try{n=!0,e?.(l,a),n=!1}catch(h){ve(h,this.#s&&this.#s.parent)}r&&(this.#i=this.#g(()=>{us.ensure();try{return Rt(()=>{var h=z;h.b=this,h.f|=Hi,r(this.#e,()=>l,()=>a)})}catch(h){return ve(h,this.#s.parent),null}}))};Me(()=>{var l;try{l=this.transform_error(t)}catch(h){ve(h,this.#s&&this.#s.parent);return}l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(o,h=>ve(h,this.#s&&this.#s.parent)):o(l)})}}function Jc(s,t,e,r){const i=yr()?ti:al;var n=s.filter(u=>!u.settled);if(e.length===0&&n.length===0){r(t.map(i));return}var a=z,o=tu(),l=n.length===1?n[0].promise:n.length>1?Promise.all(n.map(u=>u.promise)):null;function h(u){o();try{r(u)}catch(f){(a.f&Se)===0&&ve(f,a)}qi()}if(e.length===0){l.then(()=>h(t.map(i)));return}function c(){o(),Promise.all(e.map(u=>su(u))).then(u=>h([...t.map(i),...u])).catch(u=>ve(u,a))}l?l.then(c):c()}function tu(){var s=z,t=L,e=K,r=H;return function(n=!0){te(s),Dt(t),ys(e),n&&r?.activate()}}function qi(s=!0){te(null),Dt(null),ys(null),s&&H?.deactivate()}function eu(){var s=z.b,t=H,e=s.is_rendered();return s.update_pending_count(1),t.increment(e),()=>{s.update_pending_count(-1),t.decrement(e)}}function ti(s){var t=pt|mt,e=L!==null&&(L.f&pt)!==0?L:null;return z!==null&&(z.f|=Is),{ctx:K,deps:null,effects:null,equals:Ko,f:t,fn:s,reactions:null,rv:0,v:dt,wv:0,parent:e??z,ac:null}}function su(s,t,e){z===null&&Cc();var i=void 0,n=qe(dt),a=!L,o=new Map;return _u(()=>{var l=Vo();i=l.promise;try{Promise.resolve(s()).then(l.resolve,l.reject).finally(qi)}catch(f){l.reject(f),qi()}var h=H;if(a){var c=eu();o.get(h)?.reject(Ue),o.delete(h),o.set(h,l)}const u=(f,d=void 0)=>{if(h.activate(),d)d!==Ue&&(n.f|=Ce,_s(n,d));else{(n.f&Ce)!==0&&(n.f^=Ce),_s(n,f);for(const[p,y]of o){if(o.delete(p),p===h)break;y.reject(Ue)}}c&&c()};l.promise.then(u,f=>u(null,f||"unknown"))}),Rn(()=>{for(const l of o.values())l.reject(Ue)}),new Promise(l=>{function h(c){function u(){c===i?l(n):h(i)}c.then(u,u)}h(i)})}function ru(s){const t=ti(s);return Cl(t),t}function al(s){const t=ti(s);return t.equals=Qo,t}function iu(s){var t=s.effects;if(t!==null){s.effects=null;for(var e=0;e<t.length;e+=1)vt(t[e])}}function nu(s){for(var t=s.parent;t!==null;){if((t.f&pt)===0)return(t.f&Se)===0?t:null;t=t.parent}return null}function kn(s){var t,e=z;te(nu(s));try{s.f&=~Ye,iu(s),t=kl(s)}finally{te(e)}return t}function ol(s){var t=kn(s);if(!s.equals(t)&&(s.wv=Ml(),(!H?.is_fork||s.deps===null)&&(s.v=t,s.deps===null))){Q(s,ut);return}Ke||(Wt!==null?(In()||H?.is_fork)&&Wt.set(s,t):Mn(s))}function au(s){if(s.effects!==null)for(const t of s.effects)(t.teardown||t.ac)&&(t.teardown?.(),t.ac?.abort(Ue),t.teardown=le,t.ac=null,or(t,0),Bn(t))}function ll(s){if(s.effects!==null)for(const t of s.effects)t.teardown&&xs(t)}let Ki=new Set;const Te=new Map;let hl=!1;function qe(s,t){var e={f:0,v:s,reactions:null,equals:Ko,rv:0,wv:0};return e}function ft(s,t){const e=qe(s);return Cl(e),e}function cl(s,t=!1,e=!0){const r=qe(s);return t||(r.equals=Qo),gr&&e&&K!==null&&K.l!==null&&(K.l.s??=[]).push(r),r}function et(s,t,e=!1){L!==null&&(!Xt||(L.f&ra)!==0)&&yr()&&(L.f&(pt|de|Pn|ra))!==0&&(Gt===null||!gs.call(Gt,s))&&Bc();let r=e?Ne(t):t;return _s(s,r)}function _s(s,t){if(!s.equals(t)){var e=s.v;Ke?Te.set(s,t):Te.set(s,e),s.v=t;var r=us.ensure();if(r.capture(s,e),(s.f&pt)!==0){const i=s;(s.f&mt)!==0&&kn(i),Mn(i)}s.wv=Ml(),ul(s,mt),yr()&&z!==null&&(z.f&ut)!==0&&(z.f&(Kt|Je))===0&&(Et===null?vu([s]):Et.push(s)),!r.is_fork&&Ki.size>0&&!hl&&ou()}return t}function ou(){hl=!1;for(const s of Ki)(s.f&ut)!==0&&Q(s,Yt),xr(s)&&xs(s);Ki.clear()}function tr(s){et(s,s.v+1)}function ul(s,t){var e=s.reactions;if(e!==null)for(var r=yr(),i=e.length,n=0;n<i;n++){var a=e[n],o=a.f;if(!(!r&&a===z)){var l=(o&mt)===0;if(l&&Q(a,t),(o&pt)!==0){var h=a;Wt?.delete(h),(o&Ye)===0&&(o&Ft&&(a.f|=Ye),ul(h,Yt))}else l&&((o&de)!==0&&ae!==null&&ae.add(a),jt(a))}}}function Ne(s){if(typeof s!="object"||s===null||Pe in s)return s;const t=Cn(s);if(t!==bc&&t!==vc)return s;var e=new Map,r=Sn(s),i=ft(0),n=He,a=o=>{if(He===n)return o();var l=L,h=He;Dt(null),ha(n);var c=o();return Dt(l),ha(h),c};return r&&e.set("length",ft(s.length)),new Proxy(s,{defineProperty(o,l,h){(!("value"in h)||h.configurable===!1||h.enumerable===!1||h.writable===!1)&&Ic();var c=e.get(l);return c===void 0?a(()=>{var u=ft(h.value);return e.set(l,u),u}):et(c,h.value,!0),!0},deleteProperty(o,l){var h=e.get(l);if(h===void 0){if(l in o){const c=a(()=>ft(dt));e.set(l,c),tr(i)}}else et(h,dt),tr(i);return!0},get(o,l,h){if(l===Pe)return s;var c=e.get(l),u=l in o;if(c===void 0&&(!u||Js(o,l)?.writable)&&(c=a(()=>{var d=Ne(u?o[l]:dt),p=ft(d);return p}),e.set(l,c)),c!==void 0){var f=B(c);return f===dt?void 0:f}return Reflect.get(o,l,h)},getOwnPropertyDescriptor(o,l){var h=Reflect.getOwnPropertyDescriptor(o,l);if(h&&"value"in h){var c=e.get(l);c&&(h.value=B(c))}else if(h===void 0){var u=e.get(l),f=u?.v;if(u!==void 0&&f!==dt)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return h},has(o,l){if(l===Pe)return!0;var h=e.get(l),c=h!==void 0&&h.v!==dt||Reflect.has(o,l);if(h!==void 0||z!==null&&(!c||Js(o,l)?.writable)){h===void 0&&(h=a(()=>{var f=c?Ne(o[l]):dt,d=ft(f);return d}),e.set(l,h));var u=B(h);if(u===dt)return!1}return c},set(o,l,h,c){var u=e.get(l),f=l in o;if(r&&l==="length")for(var d=h;d<u.v;d+=1){var p=e.get(d+"");p!==void 0?et(p,dt):d in o&&(p=a(()=>ft(dt)),e.set(d+"",p))}if(u===void 0)(!f||Js(o,l)?.writable)&&(u=a(()=>ft(void 0)),et(u,Ne(h)),e.set(l,u));else{f=u.v!==dt;var y=a(()=>Ne(h));et(u,y)}var m=Reflect.getOwnPropertyDescriptor(o,l);if(m?.set&&m.set.call(c,h),!f){if(r&&typeof l=="string"){var g=e.get("length"),x=Number(l);Number.isInteger(x)&&x>=g.v&&et(g,x+1)}tr(i)}return!0},ownKeys(o){B(i);var l=Reflect.ownKeys(o).filter(u=>{var f=e.get(u);return f===void 0||f.v!==dt});for(var[h,c]of e)c.v!==dt&&!(h in o)&&l.push(h);return l},setPrototypeOf(){Rc()}})}function na(s){try{if(s!==null&&typeof s=="object"&&Pe in s)return s[Pe]}catch{}return s}function lu(s,t){return Object.is(na(s),na(t))}var aa,dl,fl,pl;function hu(){if(aa===void 0){aa=window,dl=/Firefox/.test(navigator.userAgent);var s=Element.prototype,t=Node.prototype,e=Text.prototype;fl=Js(t,"firstChild").get,pl=Js(t,"nextSibling").get,sa(s)&&(s.__click=void 0,s.__className=void 0,s.__attributes=null,s.__style=void 0,s.__e=void 0),sa(e)&&(e.__t=void 0)}}function Ve(s=""){return document.createTextNode(s)}function Wr(s){return fl.call(s)}function _r(s){return pl.call(s)}function F(s,t){return Wr(s)}function cu(s,t=!1){{var e=Wr(s);return e instanceof Comment&&e.data===""?_r(e):e}}function I(s,t=1,e=!1){let r=s;for(;t--;)r=_r(r);return r}function uu(s){s.textContent=""}function ml(){return!1}function du(s,t,e){return document.createElementNS(qo,s,void 0)}let oa=!1;function fu(){oa||(oa=!0,document.addEventListener("reset",s=>{Promise.resolve().then(()=>{if(!s.defaultPrevented)for(const t of s.target.elements)t.__on_r?.()})},{capture:!0}))}function En(s){var t=L,e=z;Dt(null),te(null);try{return s()}finally{Dt(t),te(e)}}function pu(s,t,e,r=e){s.addEventListener(t,()=>En(e));const i=s.__on_r;i?s.__on_r=()=>{i(),r(!0)}:s.__on_r=()=>r(!0),fu()}function gl(s){z===null&&(L===null&&kc(),Tc()),Ke&&Mc()}function mu(s,t){var e=t.last;e===null?t.last=t.first=s:(e.next=s,s.prev=e,t.last=s)}function ee(s,t,e){var r=z;r!==null&&(r.f&Pt)!==0&&(s|=Pt);var i={ctx:K,deps:null,nodes:null,f:s|mt|Ft,first:null,fn:t,last:null,next:null,parent:r,b:r&&r.b,prev:null,teardown:null,wv:0,ac:null};if(e)try{xs(i)}catch(o){throw vt(i),o}else t!==null&&jt(i);var n=i;if(e&&n.deps===null&&n.teardown===null&&n.nodes===null&&n.first===n.last&&(n.f&Is)===0&&(n=n.first,(s&de)!==0&&(s&Xe)!==0&&n!==null&&(n.f|=Xe)),n!==null&&(n.parent=r,r!==null&&mu(n,r),L!==null&&(L.f&pt)!==0&&(s&Je)===0)){var a=L;(a.effects??=[]).push(n)}return i}function In(){return L!==null&&!Xt}function Rn(s){const t=ee(mr,null,!1);return Q(t,ut),t.teardown=s,t}function Hr(s){gl();var t=z.f,e=!L&&(t&Kt)!==0&&(t&je)===0;if(e){var r=K;(r.e??=[]).push(s)}else return yl(s)}function yl(s){return ee(pr|jo,s,!1)}function gu(s){return gl(),ee(mr|jo,s,!0)}function yu(s){us.ensure();const t=ee(Je|Is,s,!0);return(e={})=>new Promise(r=>{e.outro?We(t,()=>{vt(t),r(void 0)}):(vt(t),r(void 0))})}function _l(s){return ee(pr,s,!1)}function _u(s){return ee(Pn|Is,s,!0)}function xl(s,t=0){return ee(mr|t,s,!0)}function Mt(s,t=[],e=[],r=[]){Jc(r,t,e,i=>{ee(mr,()=>s(...i.map(B)),!0)})}function ei(s,t=0){var e=ee(de|t,s,!0);return e}function Rt(s){return ee(Kt|Is,s,!0)}function bl(s){var t=s.teardown;if(t!==null){const e=Ke,r=L;la(!0),Dt(null);try{t.call(null)}finally{la(e),Dt(r)}}}function Bn(s,t=!1){var e=s.first;for(s.first=s.last=null;e!==null;){const i=e.ac;i!==null&&En(()=>{i.abort(Ue)});var r=e.next;(e.f&Je)!==0?e.parent=null:vt(e,t),e=r}}function xu(s){for(var t=s.first;t!==null;){var e=t.next;(t.f&Kt)===0&&vt(t),t=e}}function vt(s,t=!0){var e=!1;(t||(s.f&Ho)!==0)&&s.nodes!==null&&s.nodes.end!==null&&(bu(s.nodes.start,s.nodes.end),e=!0),Bn(s,t&&!e),or(s,0),Q(s,Se);var r=s.nodes&&s.nodes.t;if(r!==null)for(const n of r)n.stop();bl(s);var i=s.parent;i!==null&&i.first!==null&&vl(s),s.next=s.prev=s.teardown=s.ctx=s.deps=s.fn=s.nodes=s.ac=null}function bu(s,t){for(;s!==null;){var e=s===t?null:_r(s);s.remove(),s=e}}function vl(s){var t=s.parent,e=s.prev,r=s.next;e!==null&&(e.next=r),r!==null&&(r.prev=e),t!==null&&(t.first===s&&(t.first=r),t.last===s&&(t.last=e))}function We(s,t,e=!0){var r=[];wl(s,r,!0);var i=()=>{e&&vt(s),t&&t()},n=r.length;if(n>0){var a=()=>--n||i();for(var o of r)o.out(a)}else i()}function wl(s,t,e){if((s.f&Pt)===0){s.f^=Pt;var r=s.nodes&&s.nodes.t;if(r!==null)for(const o of r)(o.is_global||e)&&t.push(o);for(var i=s.first;i!==null;){var n=i.next,a=(i.f&Xe)!==0||(i.f&Kt)!==0&&(s.f&de)!==0;wl(i,t,a?e:!1),i=n}}}function Fn(s){Al(s,!0)}function Al(s,t){if((s.f&Pt)!==0){s.f^=Pt,(s.f&ut)===0&&(Q(s,mt),jt(s));for(var e=s.first;e!==null;){var r=e.next,i=(e.f&Xe)!==0||(e.f&Kt)!==0;Al(e,i?t:!1),e=r}var n=s.nodes&&s.nodes.t;if(n!==null)for(const a of n)(a.is_global||t)&&a.in()}}function Sl(s,t){if(s.nodes)for(var e=s.nodes.start,r=s.nodes.end;e!==null;){var i=e===r?null:_r(e);t.append(e),e=i}}let zr=!1,Ke=!1;function la(s){Ke=s}let L=null,Xt=!1;function Dt(s){L=s}let z=null;function te(s){z=s}let Gt=null;function Cl(s){L!==null&&(Gt===null?Gt=[s]:Gt.push(s))}let xt=null,Ct=0,Et=null;function vu(s){Et=s}let Pl=1,$e=0,He=$e;function ha(s){He=s}function Ml(){return++Pl}function xr(s){var t=s.f;if((t&mt)!==0)return!0;if(t&pt&&(s.f&=~Ye),(t&Yt)!==0){for(var e=s.deps,r=e.length,i=0;i<r;i++){var n=e[i];if(xr(n)&&ol(n),n.wv>s.wv)return!0}(t&Ft)!==0&&Wt===null&&Q(s,ut)}return!1}function Tl(s,t,e=!0){var r=s.reactions;if(r!==null&&!(Gt!==null&&gs.call(Gt,s)))for(var i=0;i<r.length;i++){var n=r[i];(n.f&pt)!==0?Tl(n,t,!1):t===n&&(e?Q(n,mt):(n.f&ut)!==0&&Q(n,Yt),jt(n))}}function kl(s){var t=xt,e=Ct,r=Et,i=L,n=Gt,a=K,o=Xt,l=He,h=s.f;xt=null,Ct=0,Et=null,L=(h&(Kt|Je))===0?s:null,Gt=null,ys(s.ctx),Xt=!1,He=++$e,s.ac!==null&&(En(()=>{s.ac.abort(Ue)}),s.ac=null);try{s.f|=ji;var c=s.fn,u=c();s.f|=je;var f=s.deps,d=H?.is_fork;if(xt!==null){var p;if(d||or(s,Ct),f!==null&&Ct>0)for(f.length=Ct+xt.length,p=0;p<xt.length;p++)f[Ct+p]=xt[p];else s.deps=f=xt;if(In()&&(s.f&Ft)!==0)for(p=Ct;p<f.length;p++)(f[p].reactions??=[]).push(s)}else!d&&f!==null&&Ct<f.length&&(or(s,Ct),f.length=Ct);if(yr()&&Et!==null&&!Xt&&f!==null&&(s.f&(pt|Yt|mt))===0)for(p=0;p<Et.length;p++)Tl(Et[p],s);if(i!==null&&i!==s){if($e++,i.deps!==null)for(let y=0;y<e;y+=1)i.deps[y].rv=$e;if(t!==null)for(const y of t)y.rv=$e;Et!==null&&(r===null?r=Et:r.push(...Et))}return(s.f&Ce)!==0&&(s.f^=Ce),u}catch(y){return Jo(y)}finally{s.f^=ji,xt=t,Ct=e,Et=r,L=i,Gt=n,ys(a),Xt=o,He=l}}function wu(s,t){let e=t.reactions;if(e!==null){var r=xc.call(e,s);if(r!==-1){var i=e.length-1;i===0?e=t.reactions=null:(e[r]=e[i],e.pop())}}if(e===null&&(t.f&pt)!==0&&(xt===null||!gs.call(xt,t))){var n=t;(n.f&Ft)!==0&&(n.f^=Ft,n.f&=~Ye),Mn(n),au(n),or(n,0)}}function or(s,t){var e=s.deps;if(e!==null)for(var r=t;r<e.length;r++)wu(s,e[r])}function xs(s){var t=s.f;if((t&Se)===0){Q(s,ut);var e=z,r=zr;z=s,zr=!0;try{(t&(de|Wo))!==0?xu(s):Bn(s),bl(s);var i=kl(s);s.teardown=typeof i=="function"?i:null,s.wv=Pl;var n;Wi&&Vc&&(s.f&mt)!==0&&s.deps}finally{zr=r,z=e}}}function B(s){var t=s.f,e=(t&pt)!==0;if(L!==null&&!Xt){var r=z!==null&&(z.f&Se)!==0;if(!r&&(Gt===null||!gs.call(Gt,s))){var i=L.deps;if((L.f&ji)!==0)s.rv<$e&&(s.rv=$e,xt===null&&i!==null&&i[Ct]===s?Ct++:xt===null?xt=[s]:xt.push(s));else{(L.deps??=[]).push(s);var n=s.reactions;n===null?s.reactions=[L]:gs.call(n,L)||n.push(L)}}}if(Ke&&Te.has(s))return Te.get(s);if(e){var a=s;if(Ke){var o=a.v;return((a.f&ut)===0&&a.reactions!==null||Il(a))&&(o=kn(a)),Te.set(a,o),o}var l=(a.f&Ft)===0&&!Xt&&L!==null&&(zr||(L.f&Ft)!==0),h=(a.f&je)===0;xr(a)&&(l&&(a.f|=Ft),ol(a)),l&&!h&&(ll(a),El(a))}if(Wt?.has(s))return Wt.get(s);if((s.f&Ce)!==0)throw s.v;return s.v}function El(s){if(s.f|=Ft,s.deps!==null)for(const t of s.deps)(t.reactions??=[]).push(s),(t.f&pt)!==0&&(t.f&Ft)===0&&(ll(t),El(t))}function Il(s){if(s.v===dt)return!0;if(s.deps===null)return!1;for(const t of s.deps)if(Te.has(t)||(t.f&pt)!==0&&Il(t))return!0;return!1}function Rs(s){var t=Xt;try{return Xt=!0,s()}finally{Xt=t}}function Au(s){if(!(typeof s!="object"||!s||s instanceof EventTarget)){if(Pe in s)Zi(s);else if(!Array.isArray(s))for(let t in s){const e=s[t];typeof e=="object"&&e&&Pe in e&&Zi(e)}}}function Zi(s,t=new Set){if(typeof s=="object"&&s!==null&&!(s instanceof EventTarget)&&!t.has(s)){t.add(s),s instanceof Date&&s.getTime();for(let r in s)try{Zi(s[r],t)}catch{}const e=Cn(s);if(e!==Object.prototype&&e!==Array.prototype&&e!==Map.prototype&&e!==Set.prototype&&e!==Date.prototype){const r=$o(e);for(let i in r){const n=r[i].get;if(n)try{n.call(s)}catch{}}}}}const Su=["touchstart","touchmove"];function Cu(s){return Su.includes(s)}const js=Symbol("events"),Rl=new Set,Qi=new Set;function st(s,t,e){(t[js]??={})[s]=e}function fe(s){for(var t=0;t<s.length;t++)Rl.add(s[t]);for(var e of Qi)e(s)}let ca=null;function ua(s){var t=this,e=t.ownerDocument,r=s.type,i=s.composedPath?.()||[],n=i[0]||s.target;ca=s;var a=0,o=ca===s&&s[js];if(o){var l=i.indexOf(o);if(l!==-1&&(t===document||t===window)){s[js]=t;return}var h=i.indexOf(t);if(h===-1)return;l<=h&&(a=l)}if(n=i[a]||s.target,n!==t){No(s,"currentTarget",{configurable:!0,get(){return n||e}});var c=L,u=z;Dt(null),te(null);try{for(var f,d=[];n!==null;){var p=n.assignedSlot||n.parentNode||n.host||null;try{var y=n[js]?.[r];y!=null&&(!n.disabled||s.target===n)&&y.call(n,s)}catch(m){f?d.push(m):f=m}if(s.cancelBubble||p===t||p===null)break;n=p}if(f){for(let m of d)queueMicrotask(()=>{throw m});throw f}}finally{s[js]=t,delete s.currentTarget,Dt(c),te(u)}}}const Pu=globalThis?.window?.trustedTypes&&globalThis.window.trustedTypes.createPolicy("svelte-trusted-html",{createHTML:s=>s});function Mu(s){return Pu?.createHTML(s)??s}function Tu(s){var t=du("template");return t.innerHTML=Mu(s.replaceAll("<!>","<!---->")),t.content}function da(s,t){var e=z;e.nodes===null&&(e.nodes={start:s,end:t,a:null,t:null})}function nt(s,t){var e=(t&zc)!==0,r=(t&Uc)!==0,i,n=!s.startsWith("<!>");return()=>{i===void 0&&(i=Tu(n?s:"<!>"+s),e||(i=Wr(i)));var a=r||dl?document.importNode(i,!0):i.cloneNode(!0);if(e){var o=Wr(a),l=a.lastChild;da(o,l)}else da(a,a);return a}}function it(s,t){s!==null&&s.before(t)}function wt(s,t){var e=t==null?"":typeof t=="object"?`${t}`:t;e!==(s.__t??=s.nodeValue)&&(s.__t=e,s.nodeValue=`${e}`)}function ku(s,t){return Eu(s,t)}const Ar=new Map;function Eu(s,{target:t,anchor:e,props:r={},events:i,context:n,intro:a=!0,transformError:o}){hu();var l=void 0,h=yu(()=>{var c=e??t.appendChild(Ve());Zc(c,{pending:()=>{}},d=>{Ot({});var p=K;n&&(p.c=n),i&&(r.$$events=i),l=s(d,r)||{},zt()},o);var u=new Set,f=d=>{for(var p=0;p<d.length;p++){var y=d[p];if(!u.has(y)){u.add(y);var m=Cu(y);for(const _ of[t,document]){var g=Ar.get(_);g===void 0&&(g=new Map,Ar.set(_,g));var x=g.get(y);x===void 0?(_.addEventListener(y,ua,{passive:m}),g.set(y,1)):g.set(y,x+1)}}}};return f(Jr(Rl)),Qi.add(f),()=>{for(var d of u)for(const m of[t,document]){var p=Ar.get(m),y=p.get(d);--y==0?(m.removeEventListener(d,ua),p.delete(d),p.size===0&&Ar.delete(m)):p.set(d,y)}Qi.delete(f),c!==e&&c.parentNode?.removeChild(c)}});return Iu.set(l,h),l}let Iu=new WeakMap;class Bl{anchor;#e=new Map;#o=new Map;#t=new Map;#n=new Set;#s=!0;constructor(t,e=!0){this.anchor=t,this.#s=e}#a=()=>{var t=H;if(this.#e.has(t)){var e=this.#e.get(t),r=this.#o.get(e);if(r)Fn(r),this.#n.delete(e);else{var i=this.#t.get(e);i&&(this.#o.set(e,i.effect),this.#t.delete(e),i.fragment.lastChild.remove(),this.anchor.before(i.fragment),r=i.effect)}for(const[n,a]of this.#e){if(this.#e.delete(n),n===t)break;const o=this.#t.get(a);o&&(vt(o.effect),this.#t.delete(a))}for(const[n,a]of this.#o){if(n===e||this.#n.has(n))continue;const o=()=>{if(Array.from(this.#e.values()).includes(n)){var h=document.createDocumentFragment();Sl(a,h),h.append(Ve()),this.#t.set(n,{effect:a,fragment:h})}else vt(a);this.#n.delete(n),this.#o.delete(n)};this.#s||!r?(this.#n.add(n),We(a,o,!1)):o()}}};#r=t=>{this.#e.delete(t);const e=Array.from(this.#e.values());for(const[r,i]of this.#t)e.includes(r)||(vt(i.effect),this.#t.delete(r))};ensure(t,e){var r=H,i=ml();if(e&&!this.#o.has(t)&&!this.#t.has(t))if(i){var n=document.createDocumentFragment(),a=Ve();n.append(a),this.#t.set(t,{effect:Rt(()=>e(a)),fragment:n})}else this.#o.set(t,Rt(()=>e(this.anchor)));if(this.#e.set(r,t),i){for(const[o,l]of this.#o)o===t?r.unskip_effect(l):r.skip_effect(l);for(const[o,l]of this.#t)o===t?r.unskip_effect(l.effect):r.skip_effect(l.effect);r.oncommit(this.#a),r.ondiscard(this.#r)}else this.#a()}}function we(s,t,e=!1){var r=new Bl(s),i=e?Xe:0;function n(a,o){r.ensure(a,o)}ei(()=>{var a=!1;t((o,l=0)=>{a=!0,n(l,o)}),a||n(!1,null)},i)}function Ru(s,t){return t}function Bu(s,t,e){for(var r=[],i=t.length,n,a=t.length,o=0;o<i;o++){let u=t[o];We(u,()=>{if(n){if(n.pending.delete(u),n.done.add(u),n.pending.size===0){var f=s.outrogroups;Ji(Jr(n.done)),f.delete(n),f.size===0&&(s.outrogroups=null)}}else a-=1},!1)}if(a===0){var l=r.length===0&&e!==null;if(l){var h=e,c=h.parentNode;uu(c),c.append(h),s.items.clear()}Ji(t,!l)}else n={pending:new Set(t),done:new Set},(s.outrogroups??=new Set).add(n)}function Ji(s,t=!0){for(var e=0;e<s.length;e++)vt(s[e],t)}var fa;function jr(s,t,e,r,i,n=null){var a=s,o=new Map,l=(t&Yo)!==0;if(l){var h=s;a=h.appendChild(Ve())}var c=null,u=al(()=>{var g=e();return Sn(g)?g:g==null?[]:Jr(g)}),f,d=!0;function p(){m.fallback=c,Fu(m,f,a,t,r),c!==null&&(f.length===0?(c.f&oe)===0?Fn(c):(c.f^=oe,Xs(c,null,a)):We(c,()=>{c=null}))}var y=ei(()=>{f=B(u);for(var g=f.length,x=new Set,_=H,b=ml(),S=0;S<g;S+=1){var v=f[S],w=r(v,S),P=d?null:o.get(w);P?(P.v&&_s(P.v,v),P.i&&_s(P.i,S),b&&_.unskip_effect(P.e)):(P=Gu(o,d?a:fa??=Ve(),v,w,S,i,t,e),d||(P.e.f|=oe),o.set(w,P)),x.add(w)}if(g===0&&n&&!c&&(d?c=Rt(()=>n(a)):(c=Rt(()=>n(fa??=Ve())),c.f|=oe)),g>x.size&&Pc(),!d)if(b){for(const[C,A]of o)x.has(C)||_.skip_effect(A.e);_.oncommit(p),_.ondiscard(()=>{})}else p();B(u)}),m={effect:y,items:o,outrogroups:null,fallback:c};d=!1}function Os(s){for(;s!==null&&(s.f&Kt)===0;)s=s.next;return s}function Fu(s,t,e,r,i){var n=(r&Dc)!==0,a=t.length,o=s.items,l=Os(s.effect.first),h,c=null,u,f=[],d=[],p,y,m,g;if(n)for(g=0;g<a;g+=1)p=t[g],y=i(p,g),m=o.get(y).e,(m.f&oe)===0&&(m.nodes?.a?.measure(),(u??=new Set).add(m));for(g=0;g<a;g+=1){if(p=t[g],y=i(p,g),m=o.get(y).e,s.outrogroups!==null)for(const A of s.outrogroups)A.pending.delete(m),A.done.delete(m);if((m.f&oe)!==0)if(m.f^=oe,m===l)Xs(m,null,e);else{var x=c?c.next:l;m===s.effect.last&&(s.effect.last=m.prev),m.prev&&(m.prev.next=m.next),m.next&&(m.next.prev=m.prev),xe(s,c,m),xe(s,m,x),Xs(m,x,e),c=m,f=[],d=[],l=Os(c.next);continue}if((m.f&Pt)!==0&&(Fn(m),n&&(m.nodes?.a?.unfix(),(u??=new Set).delete(m))),m!==l){if(h!==void 0&&h.has(m)){if(f.length<d.length){var _=d[0],b;c=_.prev;var S=f[0],v=f[f.length-1];for(b=0;b<f.length;b+=1)Xs(f[b],_,e);for(b=0;b<d.length;b+=1)h.delete(d[b]);xe(s,S.prev,v.next),xe(s,c,S),xe(s,v,_),l=_,c=v,g-=1,f=[],d=[]}else h.delete(m),Xs(m,l,e),xe(s,m.prev,m.next),xe(s,m,c===null?s.effect.first:c.next),xe(s,c,m),c=m;continue}for(f=[],d=[];l!==null&&l!==m;)(h??=new Set).add(l),d.push(l),l=Os(l.next);if(l===null)continue}(m.f&oe)===0&&f.push(m),c=m,l=Os(m.next)}if(s.outrogroups!==null){for(const A of s.outrogroups)A.pending.size===0&&(Ji(Jr(A.done)),s.outrogroups?.delete(A));s.outrogroups.size===0&&(s.outrogroups=null)}if(l!==null||h!==void 0){var w=[];if(h!==void 0)for(m of h)(m.f&Pt)===0&&w.push(m);for(;l!==null;)(l.f&Pt)===0&&l!==s.fallback&&w.push(l),l=Os(l.next);var P=w.length;if(P>0){var C=(r&Yo)!==0&&a===0?e:null;if(n){for(g=0;g<P;g+=1)w[g].nodes?.a?.measure();for(g=0;g<P;g+=1)w[g].nodes?.a?.fix()}Bu(s,w,C)}}n&&Me(()=>{if(u!==void 0)for(m of u)m.nodes?.a?.apply()})}function Gu(s,t,e,r,i,n,a,o){var l=(a&Gc)!==0?(a&Oc)===0?cl(e,!1,!1):qe(e):null,h=(a&Lc)!==0?qe(i):null;return{v:l,i:h,e:Rt(()=>(n(t,l??e,h??i,o),()=>{s.delete(r)}))}}function Xs(s,t,e){if(s.nodes)for(var r=s.nodes.start,i=s.nodes.end,n=t&&(t.f&oe)===0?t.nodes.start:e;r!==null;){var a=_r(r);if(n.before(r),r===i)return;r=a}}function xe(s,t,e){t===null?s.effect.first=e:t.next=e,e===null?s.effect.last=t:e.prev=t}function Lu(s,t,...e){var r=new Bl(s);ei(()=>{const i=t()??null;r.ensure(i,i&&(n=>i(n,...e)))},Xe)}const pa=[...` 	
\r\fÂ \v\uFEFF`];function Du(s,t,e){var r=s==null?"":""+s;if(e){for(var i of Object.keys(e))if(e[i])r=r?r+" "+i:i;else if(r.length)for(var n=i.length,a=0;(a=r.indexOf(i,a))>=0;){var o=a+n;(a===0||pa.includes(r[a-1]))&&(o===r.length||pa.includes(r[o]))?r=(a===0?"":r.substring(0,a))+r.substring(o+1):a=o}}return r===""?null:r}function ma(s,t=!1){var e=t?" !important;":";",r="";for(var i of Object.keys(s)){var n=s[i];n!=null&&n!==""&&(r+=" "+i+": "+n+e)}return r}function Ou(s,t){if(t){var e="",r,i;return Array.isArray(t)?(r=t[0],i=t[1]):r=t,r&&(e+=ma(r)),i&&(e+=ma(i,!0)),e=e.trim(),e===""?null:e}return String(s)}function lr(s,t,e,r,i,n){var a=s.__className;if(a!==e||a===void 0){var o=Du(e,r,n);o==null?s.removeAttribute("class"):s.className=o,s.__className=e}else if(n&&i!==n)for(var l in n){var h=!!n[l];(i==null||h!==!!i[l])&&s.classList.toggle(l,h)}return n}function ui(s,t={},e,r){for(var i in e){var n=e[i];t[i]!==n&&(e[i]==null?s.style.removeProperty(i):s.style.setProperty(i,n,r))}}function zu(s,t,e,r){var i=s.__style;if(i!==t){var n=Ou(t,r);n==null?s.removeAttribute("style"):s.style.cssText=n,s.__style=t}else r&&(Array.isArray(r)?(ui(s,e?.[0],r[0]),ui(s,e?.[1],r[1],"important")):ui(s,e,r));return r}function Fl(s,t,e=!1){if(s.multiple){if(t==null)return;if(!Sn(t))return Nc();for(var r of s.options)r.selected=t.includes(er(r));return}for(r of s.options){var i=er(r);if(lu(i,t)){r.selected=!0;return}}(!e||t!==void 0)&&(s.selectedIndex=-1)}function Uu(s){var t=new MutationObserver(()=>{Fl(s,s.__value)});t.observe(s,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Rn(()=>{t.disconnect()})}function Nu(s,t,e=t){var r=new WeakSet,i=!0;pu(s,"change",n=>{var a=n?"[selected]":":checked",o;if(s.multiple)o=[].map.call(s.querySelectorAll(a),er);else{var l=s.querySelector(a)??s.querySelector("option:not([disabled])");o=l&&er(l)}e(o),H!==null&&r.add(H)}),_l(()=>{var n=t();if(s===document.activeElement){var a=Xi??H;if(r.has(a))return}if(Fl(s,n,i),i&&n===void 0){var o=s.querySelector(":checked");o!==null&&(n=er(o),e(n))}s.__value=n,i=!1}),Uu(s)}function er(s){return"__value"in s?s.__value:s.value}const $u=Symbol("is custom element"),Vu=Symbol("is html"),Wu=Sc?"progress":"PROGRESS";function Gl(s,t){var e=Gn(s);e.value===(e.value=t??void 0)||s.value===t&&(t!==0||s.nodeName!==Wu)||(s.value=t??"")}function di(s,t){var e=Gn(s);e.checked!==(e.checked=t??void 0)&&(s.checked=t)}function ls(s,t,e,r){var i=Gn(s);i[t]!==(i[t]=e)&&(t==="loading"&&(s[Ac]=e),e==null?s.removeAttribute(t):typeof e!="string"&&Hu(s).includes(t)?s[t]=e:s.setAttribute(t,e))}function Gn(s){return s.__attributes??={[$u]:s.nodeName.includes("-"),[Vu]:s.namespaceURI===qo}}var ga=new Map;function Hu(s){var t=s.getAttribute("is")||s.nodeName,e=ga.get(t);if(e)return e;ga.set(t,e=[]);for(var r,i=s,n=Element.prototype;n!==i;){r=$o(i);for(var a in r)r[a].set&&e.push(a);i=Cn(i)}return e}function ya(s,t){return s===t||s?.[Pe]===t}function Ll(s={},t,e,r){return _l(()=>{var i,n;return xl(()=>{i=n,n=[],Rs(()=>{s!==e(...n)&&(t(s,...n),i&&ya(e(...i),s)&&t(null,...i))})}),()=>{Me(()=>{n&&ya(e(...n),s)&&t(null,...n)})}}),s}function ju(s=!1){const t=K,e=t.l.u;if(!e)return;let r=()=>Au(t.s);if(s){let i=0,n={};const a=ti(()=>{let o=!1;const l=t.s;for(const h in l)l[h]!==n[h]&&(n[h]=l[h],o=!0);return o&&i++,i});r=()=>B(a)}e.b.length&&gu(()=>{_a(t,r),Vr(e.b)}),Hr(()=>{const i=Rs(()=>e.m.map(wc));return()=>{for(const n of i)typeof n=="function"&&n()}}),e.a.length&&Hr(()=>{_a(t,r),Vr(e.a)})}function _a(s,t){if(s.l.s)for(const e of s.l.s)B(e);t()}function Ln(s,t,e){if(s==null)return t(void 0),e&&e(void 0),le;const r=Rs(()=>s.subscribe(t,e));return r.unsubscribe?()=>r.unsubscribe():r}const ss=[];function Xu(s,t){return{subscribe:at(s,t).subscribe}}function at(s,t=le){let e=null;const r=new Set;function i(o){if(Zo(s,o)&&(s=o,e)){const l=!ss.length;for(const h of r)h[1](),ss.push(h,s);if(l){for(let h=0;h<ss.length;h+=2)ss[h][0](ss[h+1]);ss.length=0}}}function n(o){i(o(s))}function a(o,l=le){const h=[o,l];return r.add(h),r.size===1&&(e=t(i,n)||le),o(s),()=>{r.delete(h),r.size===0&&e&&(e(),e=null)}}return{set:i,update:n,subscribe:a}}function Yu(s,t,e){const r=!Array.isArray(s),i=r?[s]:s;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const n=t.length<2;return Xu(e,(a,o)=>{let l=!1;const h=[];let c=0,u=le;const f=()=>{if(c)return;u();const p=t(r?h[0]:h,a,o);n?a(p):u=typeof p=="function"?p:le},d=i.map((p,y)=>Ln(p,m=>{h[y]=m,c&=~(1<<y),l&&f()},()=>{c|=1<<y}));return l=!0,f(),function(){Vr(d),u(),l=!1}})}function kt(s){let t;return Ln(s,e=>t=e)(),t}let tn=Symbol();function Z(s,t,e){const r=e[t]??={store:null,source:cl(void 0),unsubscribe:le};if(r.store!==s&&!(tn in e))if(r.unsubscribe(),r.store=s??null,s==null)r.source.v=void 0,r.unsubscribe=le;else{var i=!0;r.unsubscribe=Ln(s,n=>{i?r.source.v=n:et(r.source,n)}),i=!1}return s&&tn in e?kt(s):B(r.source)}function si(){const s={};function t(){Rn(()=>{for(var e in s)s[e].unsubscribe();No(s,tn,{enumerable:!1,value:!0})})}return[s,t]}function xa(s,t,e,r){var i=r,n=!0,a=()=>(n&&(n=!1,i=r),i),o;o=s[t],o===void 0&&r!==void 0&&(o=a());var l;return l=()=>{var h=s[t];return h===void 0?a():(n=!0,h)},l}function Dl(s){K===null&&Xo(),gr&&K.l!==null?Ku(K).m.push(s):Hr(()=>{const t=Rs(s);if(typeof t=="function")return t})}function qu(s){K===null&&Xo(),Dl(()=>()=>Rs(s))}function Ku(s){var t=s.l;return t.u??={a:[],b:[],m:[]}}const Zu="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Zu);const Qu="modulepreload",Ju=function(s){return"/ForFun_PicIsFalling/site/"+s},ba={},ds=function(t,e,r){let i=Promise.resolve();if(e&&e.length>0){let l=function(h){return Promise.all(h.map(c=>Promise.resolve(c).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");i=l(e.map(h=>{if(h=Ju(h),h in ba)return;ba[h]=!0;const c=h.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${u}`))return;const f=document.createElement("link");if(f.rel=c?"stylesheet":Qu,c||(f.as="script"),f.crossOrigin="",f.href=h,o&&f.setAttribute("nonce",o),document.head.appendChild(f),c)return new Promise((d,p)=>{f.addEventListener("load",d),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${h}`)))})}))}function n(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&n(o.reason);return t().catch(n)})};var k=(s=>(s.Application="application",s.WebGLPipes="webgl-pipes",s.WebGLPipesAdaptor="webgl-pipes-adaptor",s.WebGLSystem="webgl-system",s.WebGPUPipes="webgpu-pipes",s.WebGPUPipesAdaptor="webgpu-pipes-adaptor",s.WebGPUSystem="webgpu-system",s.CanvasSystem="canvas-system",s.CanvasPipesAdaptor="canvas-pipes-adaptor",s.CanvasPipes="canvas-pipes",s.Asset="asset",s.LoadParser="load-parser",s.ResolveParser="resolve-parser",s.CacheParser="cache-parser",s.DetectionParser="detection-parser",s.MaskEffect="mask-effect",s.BlendMode="blend-mode",s.TextureSource="texture-source",s.Environment="environment",s.ShapeBuilder="shape-builder",s.Batcher="batcher",s))(k||{});const en=s=>{if(typeof s=="function"||typeof s=="object"&&s.extension){if(!s.extension)throw new Error("Extension class must have an extension object");s={...typeof s.extension!="object"?{type:s.extension}:s.extension,ref:s}}if(typeof s=="object")s={...s};else throw new Error("Invalid extension type");return typeof s.type=="string"&&(s.type=[s.type]),s},Sr=(s,t)=>en(s).priority??t,X={_addHandlers:{},_removeHandlers:{},_queue:{},remove(...s){return s.map(en).forEach(t=>{t.type.forEach(e=>this._removeHandlers[e]?.(t))}),this},add(...s){return s.map(en).forEach(t=>{t.type.forEach(e=>{const r=this._addHandlers,i=this._queue;r[e]?r[e]?.(t):(i[e]=i[e]||[],i[e]?.push(t))})}),this},handle(s,t,e){const r=this._addHandlers,i=this._removeHandlers;if(r[s]||i[s])throw new Error(`Extension type ${s} already has a handler`);r[s]=t,i[s]=e;const n=this._queue;return n[s]&&(n[s]?.forEach(a=>t(a)),delete n[s]),this},handleByMap(s,t){return this.handle(s,e=>{e.name&&(t[e.name]=e.ref)},e=>{e.name&&delete t[e.name]})},handleByNamedList(s,t,e=-1){return this.handle(s,r=>{t.findIndex(n=>n.name===r.name)>=0||(t.push({name:r.name,value:r.ref}),t.sort((n,a)=>Sr(a.value,e)-Sr(n.value,e)))},r=>{const i=t.findIndex(n=>n.name===r.name);i!==-1&&t.splice(i,1)})},handleByList(s,t,e=-1){return this.handle(s,r=>{t.includes(r.ref)||(t.push(r.ref),t.sort((i,n)=>Sr(n,e)-Sr(i,e)))},r=>{const i=t.indexOf(r.ref);i!==-1&&t.splice(i,1)})},mixin(s,...t){for(const e of t)Object.defineProperties(s.prototype,Object.getOwnPropertyDescriptors(e))}},td={extension:{type:k.Environment,name:"browser",priority:-1},test:()=>!0,load:async()=>{await ds(()=>import("./browserAll-DZR8wNOk.js"),__vite__mapDeps([0,1,2]))}},ed={extension:{type:k.Environment,name:"webworker",priority:0},test:()=>typeof self<"u"&&self.WorkerGlobalScope!==void 0,load:async()=>{await ds(()=>import("./webworkerAll-D35_AM7w.js"),__vite__mapDeps([1,2]))}};class gt{constructor(t,e,r){this._x=e||0,this._y=r||0,this._observer=t}clone(t){return new gt(t??this._observer,this._x,this._y)}set(t=0,e=t){return(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this._observer._onUpdate(this)),this}copyFrom(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this._observer._onUpdate(this)),this}copyTo(t){return t.set(this._x,this._y),t}equals(t){return t.x===this._x&&t.y===this._y}toString(){return`[pixi.js/math:ObservablePoint x=${this._x} y=${this._y} scope=${this._observer}]`}get x(){return this._x}set x(t){this._x!==t&&(this._x=t,this._observer._onUpdate(this))}get y(){return this._y}set y(t){this._y!==t&&(this._y=t,this._observer._onUpdate(this))}}function Ol(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}var fi={exports:{}},va;function sd(){return va||(va=1,(function(s){var t=Object.prototype.hasOwnProperty,e="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(e=!1));function i(l,h,c){this.fn=l,this.context=h,this.once=c||!1}function n(l,h,c,u,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new i(c,u||l,f),p=e?e+h:h;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],d]:l._events[p].push(d):(l._events[p]=d,l._eventsCount++),l}function a(l,h){--l._eventsCount===0?l._events=new r:delete l._events[h]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var h=[],c,u;if(this._eventsCount===0)return h;for(u in c=this._events)t.call(c,u)&&h.push(e?u.slice(1):u);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(c)):h},o.prototype.listeners=function(h){var c=e?e+h:h,u=this._events[c];if(!u)return[];if(u.fn)return[u.fn];for(var f=0,d=u.length,p=new Array(d);f<d;f++)p[f]=u[f].fn;return p},o.prototype.listenerCount=function(h){var c=e?e+h:h,u=this._events[c];return u?u.fn?1:u.length:0},o.prototype.emit=function(h,c,u,f,d,p){var y=e?e+h:h;if(!this._events[y])return!1;var m=this._events[y],g=arguments.length,x,_;if(m.fn){switch(m.once&&this.removeListener(h,m.fn,void 0,!0),g){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,c),!0;case 3:return m.fn.call(m.context,c,u),!0;case 4:return m.fn.call(m.context,c,u,f),!0;case 5:return m.fn.call(m.context,c,u,f,d),!0;case 6:return m.fn.call(m.context,c,u,f,d,p),!0}for(_=1,x=new Array(g-1);_<g;_++)x[_-1]=arguments[_];m.fn.apply(m.context,x)}else{var b=m.length,S;for(_=0;_<b;_++)switch(m[_].once&&this.removeListener(h,m[_].fn,void 0,!0),g){case 1:m[_].fn.call(m[_].context);break;case 2:m[_].fn.call(m[_].context,c);break;case 3:m[_].fn.call(m[_].context,c,u);break;case 4:m[_].fn.call(m[_].context,c,u,f);break;default:if(!x)for(S=1,x=new Array(g-1);S<g;S++)x[S-1]=arguments[S];m[_].fn.apply(m[_].context,x)}}return!0},o.prototype.on=function(h,c,u){return n(this,h,c,u,!1)},o.prototype.once=function(h,c,u){return n(this,h,c,u,!0)},o.prototype.removeListener=function(h,c,u,f){var d=e?e+h:h;if(!this._events[d])return this;if(!c)return a(this,d),this;var p=this._events[d];if(p.fn)p.fn===c&&(!f||p.once)&&(!u||p.context===u)&&a(this,d);else{for(var y=0,m=[],g=p.length;y<g;y++)(p[y].fn!==c||f&&!p[y].once||u&&p[y].context!==u)&&m.push(p[y]);m.length?this._events[d]=m.length===1?m[0]:m:a(this,d)}return this},o.prototype.removeAllListeners=function(h){var c;return h?(c=e?e+h:h,this._events[c]&&a(this,c)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,s.exports=o})(fi)),fi.exports}var rd=sd();const pe=Ol(rd),id=Math.PI*2,nd=180/Math.PI,ad=Math.PI/180;class yt{constructor(t=0,e=0){this.x=0,this.y=0,this.x=t,this.y=e}clone(){return new yt(this.x,this.y)}copyFrom(t){return this.set(t.x,t.y),this}copyTo(t){return t.set(this.x,this.y),t}equals(t){return t.x===this.x&&t.y===this.y}set(t=0,e=t){return this.x=t,this.y=e,this}toString(){return`[pixi.js/math:Point x=${this.x} y=${this.y}]`}static get shared(){return pi.x=0,pi.y=0,pi}}const pi=new yt;class D{constructor(t=1,e=0,r=0,i=1,n=0,a=0){this.array=null,this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=a}fromArray(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]}set(t,e,r,i,n,a){return this.a=t,this.b=e,this.c=r,this.d=i,this.tx=n,this.ty=a,this}toArray(t,e){this.array||(this.array=new Float32Array(9));const r=e||this.array;return t?(r[0]=this.a,r[1]=this.b,r[2]=0,r[3]=this.c,r[4]=this.d,r[5]=0,r[6]=this.tx,r[7]=this.ty,r[8]=1):(r[0]=this.a,r[1]=this.c,r[2]=this.tx,r[3]=this.b,r[4]=this.d,r[5]=this.ty,r[6]=0,r[7]=0,r[8]=1),r}apply(t,e){e=e||new yt;const r=t.x,i=t.y;return e.x=this.a*r+this.c*i+this.tx,e.y=this.b*r+this.d*i+this.ty,e}applyInverse(t,e){e=e||new yt;const r=this.a,i=this.b,n=this.c,a=this.d,o=this.tx,l=this.ty,h=1/(r*a+n*-i),c=t.x,u=t.y;return e.x=a*h*c+-n*h*u+(l*n-o*a)*h,e.y=r*h*u+-i*h*c+(-l*r+o*i)*h,e}translate(t,e){return this.tx+=t,this.ty+=e,this}scale(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this}rotate(t){const e=Math.cos(t),r=Math.sin(t),i=this.a,n=this.c,a=this.tx;return this.a=i*e-this.b*r,this.b=i*r+this.b*e,this.c=n*e-this.d*r,this.d=n*r+this.d*e,this.tx=a*e-this.ty*r,this.ty=a*r+this.ty*e,this}append(t){const e=this.a,r=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*r+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*r+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*r+t.ty*n+this.ty,this}appendFrom(t,e){const r=t.a,i=t.b,n=t.c,a=t.d,o=t.tx,l=t.ty,h=e.a,c=e.b,u=e.c,f=e.d;return this.a=r*h+i*u,this.b=r*c+i*f,this.c=n*h+a*u,this.d=n*c+a*f,this.tx=o*h+l*u+e.tx,this.ty=o*c+l*f+e.ty,this}setTransform(t,e,r,i,n,a,o,l,h){return this.a=Math.cos(o+h)*n,this.b=Math.sin(o+h)*n,this.c=-Math.sin(o-l)*a,this.d=Math.cos(o-l)*a,this.tx=t-(r*this.a+i*this.c),this.ty=e-(r*this.b+i*this.d),this}prepend(t){const e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){const r=this.a,i=this.c;this.a=r*t.a+this.b*t.c,this.b=r*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this}decompose(t){const e=this.a,r=this.b,i=this.c,n=this.d,a=t.pivot,o=-Math.atan2(-i,n),l=Math.atan2(r,e),h=Math.abs(o+l);return h<1e-5||Math.abs(id-h)<1e-5?(t.rotation=l,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=l),t.scale.x=Math.sqrt(e*e+r*r),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx+(a.x*e+a.y*i),t.position.y=this.ty+(a.x*r+a.y*n),t}invert(){const t=this.a,e=this.b,r=this.c,i=this.d,n=this.tx,a=t*i-e*r;return this.a=i/a,this.b=-e/a,this.c=-r/a,this.d=t/a,this.tx=(r*this.ty-i*n)/a,this.ty=-(t*this.ty-e*n)/a,this}isIdentity(){return this.a===1&&this.b===0&&this.c===0&&this.d===1&&this.tx===0&&this.ty===0}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this}clone(){const t=new D;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyTo(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t}copyFrom(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this}equals(t){return t.a===this.a&&t.b===this.b&&t.c===this.c&&t.d===this.d&&t.tx===this.tx&&t.ty===this.ty}toString(){return`[pixi.js:Matrix a=${this.a} b=${this.b} c=${this.c} d=${this.d} tx=${this.tx} ty=${this.ty}]`}static get IDENTITY(){return ld.identity()}static get shared(){return od.identity()}}const od=new D,ld=new D,Ge=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],Le=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],De=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],Oe=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],sn=[],zl=[],Cr=Math.sign;function hd(){for(let s=0;s<16;s++){const t=[];sn.push(t);for(let e=0;e<16;e++){const r=Cr(Ge[s]*Ge[e]+De[s]*Le[e]),i=Cr(Le[s]*Ge[e]+Oe[s]*Le[e]),n=Cr(Ge[s]*De[e]+De[s]*Oe[e]),a=Cr(Le[s]*De[e]+Oe[s]*Oe[e]);for(let o=0;o<16;o++)if(Ge[o]===r&&Le[o]===i&&De[o]===n&&Oe[o]===a){t.push(o);break}}}for(let s=0;s<16;s++){const t=new D;t.set(Ge[s],Le[s],De[s],Oe[s],0,0),zl.push(t)}}hd();const W={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:s=>Ge[s],uY:s=>Le[s],vX:s=>De[s],vY:s=>Oe[s],inv:s=>s&8?s&15:-s&7,add:(s,t)=>sn[s][t],sub:(s,t)=>sn[s][W.inv(t)],rotate180:s=>s^4,isVertical:s=>(s&3)===2,byDirection:(s,t)=>Math.abs(s)*2<=Math.abs(t)?t>=0?W.S:W.N:Math.abs(t)*2<=Math.abs(s)?s>0?W.E:W.W:t>0?s>0?W.SE:W.SW:s>0?W.NE:W.NW,matrixAppendRotationInv:(s,t,e=0,r=0,i=0,n=0)=>{const a=zl[W.inv(t)],o=a.a,l=a.b,h=a.c,c=a.d,u=e-Math.min(0,o*i,h*n,o*i+h*n),f=r-Math.min(0,l*i,c*n,l*i+c*n),d=s.a,p=s.b,y=s.c,m=s.d;s.a=o*d+l*y,s.b=o*p+l*m,s.c=h*d+c*y,s.d=h*p+c*m,s.tx=u*d+f*y+s.tx,s.ty=u*p+f*m+s.ty},transformRectCoords:(s,t,e,r)=>{const{x:i,y:n,width:a,height:o}=s,{x:l,y:h,width:c,height:u}=t;return e===W.E?(r.set(i+l,n+h,a,o),r):e===W.S?r.set(c-n-o+l,i+h,o,a):e===W.W?r.set(c-i-a+l,u-n-o+h,a,o):e===W.N?r.set(n+l,u-i-a+h,o,a):r.set(i+l,n+h,a,o)}},Pr=[new yt,new yt,new yt,new yt];class ct{constructor(t=0,e=0,r=0,i=0){this.type="rectangle",this.x=Number(t),this.y=Number(e),this.width=Number(r),this.height=Number(i)}get left(){return this.x}get right(){return this.x+this.width}get top(){return this.y}get bottom(){return this.y+this.height}isEmpty(){return this.left===this.right||this.top===this.bottom}static get EMPTY(){return new ct(0,0,0,0)}clone(){return new ct(this.x,this.y,this.width,this.height)}copyFromBounds(t){return this.x=t.minX,this.y=t.minY,this.width=t.maxX-t.minX,this.height=t.maxY-t.minY,this}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height}strokeContains(t,e,r,i=.5){const{width:n,height:a}=this;if(n<=0||a<=0)return!1;const o=this.x,l=this.y,h=r*(1-i),c=r-h,u=o-h,f=o+n+h,d=l-h,p=l+a+h,y=o+c,m=o+n-c,g=l+c,x=l+a-c;return t>=u&&t<=f&&e>=d&&e<=p&&!(t>y&&t<m&&e>g&&e<x)}intersects(t,e){if(!e){const P=this.x<t.x?t.x:this.x;if((this.right>t.right?t.right:this.right)<=P)return!1;const A=this.y<t.y?t.y:this.y;return(this.bottom>t.bottom?t.bottom:this.bottom)>A}const r=this.left,i=this.right,n=this.top,a=this.bottom;if(i<=r||a<=n)return!1;const o=Pr[0].set(t.left,t.top),l=Pr[1].set(t.left,t.bottom),h=Pr[2].set(t.right,t.top),c=Pr[3].set(t.right,t.bottom);if(h.x<=o.x||l.y<=o.y)return!1;const u=Math.sign(e.a*e.d-e.b*e.c);if(u===0||(e.apply(o,o),e.apply(l,l),e.apply(h,h),e.apply(c,c),Math.max(o.x,l.x,h.x,c.x)<=r||Math.min(o.x,l.x,h.x,c.x)>=i||Math.max(o.y,l.y,h.y,c.y)<=n||Math.min(o.y,l.y,h.y,c.y)>=a))return!1;const f=u*(l.y-o.y),d=u*(o.x-l.x),p=f*r+d*n,y=f*i+d*n,m=f*r+d*a,g=f*i+d*a;if(Math.max(p,y,m,g)<=f*o.x+d*o.y||Math.min(p,y,m,g)>=f*c.x+d*c.y)return!1;const x=u*(o.y-h.y),_=u*(h.x-o.x),b=x*r+_*n,S=x*i+_*n,v=x*r+_*a,w=x*i+_*a;return!(Math.max(b,S,v,w)<=x*o.x+_*o.y||Math.min(b,S,v,w)>=x*c.x+_*c.y)}pad(t=0,e=t){return this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this}fit(t){const e=Math.max(this.x,t.x),r=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(r-e,0),this.y=i,this.height=Math.max(n-i,0),this}ceil(t=1,e=.001){const r=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=r-this.x,this.height=i-this.y,this}scale(t,e=t){return this.x*=t,this.y*=e,this.width*=t,this.height*=e,this}enlarge(t){const e=Math.min(this.x,t.x),r=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=r-e,this.y=i,this.height=n-i,this}getBounds(t){return t||(t=new ct),t.copyFrom(this),t}containsRect(t){if(this.width<=0||this.height<=0)return!1;const e=t.x,r=t.y,i=t.x+t.width,n=t.y+t.height;return e>=this.x&&e<this.x+this.width&&r>=this.y&&r<this.y+this.height&&i>=this.x&&i<this.x+this.width&&n>=this.y&&n<this.y+this.height}set(t,e,r,i){return this.x=t,this.y=e,this.width=r,this.height=i,this}toString(){return`[pixi.js/math:Rectangle x=${this.x} y=${this.y} width=${this.width} height=${this.height}]`}}const mi={default:-1};function J(s="default"){return mi[s]===void 0&&(mi[s]=-1),++mi[s]}const wa=new Set,rt="8.0.0",cd="8.3.4",hs={quiet:!1,noColor:!1},V=((s,t,e=3)=>{if(hs.quiet||wa.has(t))return;let r=new Error().stack;const i=`${t}
Deprecated since v${s}`,n=typeof console.groupCollapsed=="function"&&!hs.noColor;typeof r>"u"?console.warn("PixiJS Deprecation Warning: ",i):(r=r.split(`
`).splice(e).join(`
`),n?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",i),console.warn(r),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",i),console.warn(r))),wa.add(t)});Object.defineProperties(V,{quiet:{get:()=>hs.quiet,set:s=>{hs.quiet=s},enumerable:!0,configurable:!1},noColor:{get:()=>hs.noColor,set:s=>{hs.noColor=s},enumerable:!0,configurable:!1}});const Ul=()=>{};function Aa(s){return s+=s===0?1:0,--s,s|=s>>>1,s|=s>>>2,s|=s>>>4,s|=s>>>8,s|=s>>>16,s+1}function Sa(s){return!(s&s-1)&&!!s}function Nl(s){const t={};for(const e in s)s[e]!==void 0&&(t[e]=s[e]);return t}const Ca=Object.create(null);function ud(s){const t=Ca[s];return t===void 0&&(Ca[s]=J("resource")),t}const $l=class Vl extends pe{constructor(t={}){super(),this._resourceType="textureSampler",this._touched=0,this._maxAnisotropy=1,this.destroyed=!1,t={...Vl.defaultOptions,...t},this.addressMode=t.addressMode,this.addressModeU=t.addressModeU??this.addressModeU,this.addressModeV=t.addressModeV??this.addressModeV,this.addressModeW=t.addressModeW??this.addressModeW,this.scaleMode=t.scaleMode,this.magFilter=t.magFilter??this.magFilter,this.minFilter=t.minFilter??this.minFilter,this.mipmapFilter=t.mipmapFilter??this.mipmapFilter,this.lodMinClamp=t.lodMinClamp,this.lodMaxClamp=t.lodMaxClamp,this.compare=t.compare,this.maxAnisotropy=t.maxAnisotropy??1}set addressMode(t){this.addressModeU=t,this.addressModeV=t,this.addressModeW=t}get addressMode(){return this.addressModeU}set wrapMode(t){V(rt,"TextureStyle.wrapMode is now TextureStyle.addressMode"),this.addressMode=t}get wrapMode(){return this.addressMode}set scaleMode(t){this.magFilter=t,this.minFilter=t,this.mipmapFilter=t}get scaleMode(){return this.magFilter}set maxAnisotropy(t){this._maxAnisotropy=Math.min(t,16),this._maxAnisotropy>1&&(this.scaleMode="linear")}get maxAnisotropy(){return this._maxAnisotropy}get _resourceId(){return this._sharedResourceId||this._generateResourceId()}update(){this._sharedResourceId=null,this.emit("change",this)}_generateResourceId(){const t=`${this.addressModeU}-${this.addressModeV}-${this.addressModeW}-${this.magFilter}-${this.minFilter}-${this.mipmapFilter}-${this.lodMinClamp}-${this.lodMaxClamp}-${this.compare}-${this._maxAnisotropy}`;return this._sharedResourceId=ud(t),this._resourceId}destroy(){this.destroyed=!0,this.emit("destroy",this),this.emit("change",this),this.removeAllListeners()}};$l.defaultOptions={addressMode:"clamp-to-edge",scaleMode:"linear"};let Wl=$l;const Hl=class jl extends pe{constructor(t={}){super(),this.options=t,this._gpuData=Object.create(null),this._gcLastUsed=-1,this.uid=J("textureSource"),this._resourceType="textureSource",this._resourceId=J("resource"),this.uploadMethodId="unknown",this._resolution=1,this.pixelWidth=1,this.pixelHeight=1,this.width=1,this.height=1,this.sampleCount=1,this.mipLevelCount=1,this.autoGenerateMipmaps=!1,this.format="rgba8unorm",this.dimension="2d",this.viewDimension="2d",this.arrayLayerCount=1,this.antialias=!1,this._touched=0,this._batchTick=-1,this._textureBindLocation=-1,t={...jl.defaultOptions,...t},this.label=t.label??"",this.resource=t.resource,this.autoGarbageCollect=t.autoGarbageCollect,this._resolution=t.resolution,t.width?this.pixelWidth=t.width*this._resolution:this.pixelWidth=this.resource?this.resourceWidth??1:1,t.height?this.pixelHeight=t.height*this._resolution:this.pixelHeight=this.resource?this.resourceHeight??1:1,this.width=this.pixelWidth/this._resolution,this.height=this.pixelHeight/this._resolution,this.format=t.format,this.dimension=t.dimensions,this.viewDimension=t.viewDimension??t.dimensions,this.arrayLayerCount=t.arrayLayerCount,this.mipLevelCount=t.mipLevelCount,this.autoGenerateMipmaps=t.autoGenerateMipmaps,this.sampleCount=t.sampleCount,this.antialias=t.antialias,this.alphaMode=t.alphaMode,this.style=new Wl(Nl(t)),this.destroyed=!1,this._refreshPOT()}get source(){return this}get style(){return this._style}set style(t){this.style!==t&&(this._style?.off("change",this._onStyleChange,this),this._style=t,this._style?.on("change",this._onStyleChange,this),this._onStyleChange())}set maxAnisotropy(t){this._style.maxAnisotropy=t}get maxAnisotropy(){return this._style.maxAnisotropy}get addressMode(){return this._style.addressMode}set addressMode(t){this._style.addressMode=t}get repeatMode(){return this._style.addressMode}set repeatMode(t){this._style.addressMode=t}get magFilter(){return this._style.magFilter}set magFilter(t){this._style.magFilter=t}get minFilter(){return this._style.minFilter}set minFilter(t){this._style.minFilter=t}get mipmapFilter(){return this._style.mipmapFilter}set mipmapFilter(t){this._style.mipmapFilter=t}get lodMinClamp(){return this._style.lodMinClamp}set lodMinClamp(t){this._style.lodMinClamp=t}get lodMaxClamp(){return this._style.lodMaxClamp}set lodMaxClamp(t){this._style.lodMaxClamp=t}_onStyleChange(){this.emit("styleChange",this)}update(){if(this.resource){const t=this._resolution;if(this.resize(this.resourceWidth/t,this.resourceHeight/t))return}this.emit("update",this)}destroy(){this.destroyed=!0,this.unload(),this.emit("destroy",this),this._style&&(this._style.destroy(),this._style=null),this.uploadMethodId=null,this.resource=null,this.removeAllListeners()}unload(){this._resourceId=J("resource"),this.emit("change",this),this.emit("unload",this);for(const t in this._gpuData)this._gpuData[t]?.destroy?.();this._gpuData=Object.create(null)}get resourceWidth(){const{resource:t}=this;return t.naturalWidth||t.videoWidth||t.displayWidth||t.width}get resourceHeight(){const{resource:t}=this;return t.naturalHeight||t.videoHeight||t.displayHeight||t.height}get resolution(){return this._resolution}set resolution(t){this._resolution!==t&&(this._resolution=t,this.width=this.pixelWidth/t,this.height=this.pixelHeight/t)}resize(t,e,r){r||(r=this._resolution),t||(t=this.width),e||(e=this.height);const i=Math.round(t*r),n=Math.round(e*r);return this.width=i/r,this.height=n/r,this._resolution=r,this.pixelWidth===i&&this.pixelHeight===n?!1:(this._refreshPOT(),this.pixelWidth=i,this.pixelHeight=n,this.emit("resize",this),this._resourceId=J("resource"),this.emit("change",this),!0)}updateMipmaps(){this.autoGenerateMipmaps&&this.mipLevelCount>1&&this.emit("updateMipmaps",this)}set wrapMode(t){this._style.wrapMode=t}get wrapMode(){return this._style.wrapMode}set scaleMode(t){this._style.scaleMode=t}get scaleMode(){return this._style.scaleMode}_refreshPOT(){this.isPowerOfTwo=Sa(this.pixelWidth)&&Sa(this.pixelHeight)}static test(t){throw new Error("Unimplemented")}};Hl.defaultOptions={resolution:1,format:"bgra8unorm",alphaMode:"premultiply-alpha-on-upload",dimensions:"2d",viewDimension:"2d",arrayLayerCount:1,mipLevelCount:1,autoGenerateMipmaps:!1,sampleCount:1,antialias:!1,autoGarbageCollect:!1};let Ut=Hl;class Dn extends Ut{constructor(t){const e=t.resource||new Float32Array(t.width*t.height*4);let r=t.format;r||(e instanceof Float32Array?r="rgba32float":e instanceof Int32Array||e instanceof Uint32Array?r="rgba32uint":e instanceof Int16Array||e instanceof Uint16Array?r="rgba16uint":(e instanceof Int8Array,r="bgra8unorm")),super({...t,resource:e,format:r}),this.uploadMethodId="buffer"}static test(t){return t instanceof Int8Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array}}Dn.extension=k.TextureSource;const Pa=new D;class dd{constructor(t,e){this.mapCoord=new D,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,typeof e>"u"?this.clampMargin=t.width<10?0:.5:this.clampMargin=e,this.isSimple=!1,this.texture=t}get texture(){return this._texture}set texture(t){this.texture!==t&&(this._texture?.removeListener("update",this.update,this),this._texture=t,this._texture.addListener("update",this.update,this),this.update())}multiplyUvs(t,e){e===void 0&&(e=t);const r=this.mapCoord;for(let i=0;i<t.length;i+=2){const n=t[i],a=t[i+1];e[i]=n*r.a+a*r.c+r.tx,e[i+1]=n*r.b+a*r.d+r.ty}return e}update(){const t=this._texture;this._updateID++;const e=t.uvs;this.mapCoord.set(e.x1-e.x0,e.y1-e.y0,e.x3-e.x0,e.y3-e.y0,e.x0,e.y0);const r=t.orig,i=t.trim;i&&(Pa.set(r.width/i.width,0,0,r.height/i.height,-i.x/i.width,-i.y/i.height),this.mapCoord.append(Pa));const n=t.source,a=this.uClampFrame,o=this.clampMargin/n._resolution,l=this.clampOffset/n._resolution;return a[0]=(t.frame.x+o+l)/n.width,a[1]=(t.frame.y+o+l)/n.height,a[2]=(t.frame.x+t.frame.width-o+l)/n.width,a[3]=(t.frame.y+t.frame.height-o+l)/n.height,this.uClampOffset[0]=this.clampOffset/n.pixelWidth,this.uClampOffset[1]=this.clampOffset/n.pixelHeight,this.isSimple=t.frame.width===n.width&&t.frame.height===n.height&&t.rotate===0,!0}}class U extends pe{constructor({source:t,label:e,frame:r,orig:i,trim:n,defaultAnchor:a,defaultBorders:o,rotate:l,dynamic:h}={}){if(super(),this.uid=J("texture"),this.uvs={x0:0,y0:0,x1:0,y1:0,x2:0,y2:0,x3:0,y3:0},this.frame=new ct,this.noFrame=!1,this.dynamic=!1,this.isTexture=!0,this.label=e,this.source=t?.source??new Ut,this.noFrame=!r,r)this.frame.copyFrom(r);else{const{width:c,height:u}=this._source;this.frame.width=c,this.frame.height=u}this.orig=i||this.frame,this.trim=n,this.rotate=l??0,this.defaultAnchor=a,this.defaultBorders=o,this.destroyed=!1,this.dynamic=h||!1,this.updateUvs()}set source(t){this._source&&this._source.off("resize",this.update,this),this._source=t,t.on("resize",this.update,this),this.emit("update",this)}get source(){return this._source}get textureMatrix(){return this._textureMatrix||(this._textureMatrix=new dd(this)),this._textureMatrix}get width(){return this.orig.width}get height(){return this.orig.height}updateUvs(){const{uvs:t,frame:e}=this,{width:r,height:i}=this._source,n=e.x/r,a=e.y/i,o=e.width/r,l=e.height/i;let h=this.rotate;if(h){const c=o/2,u=l/2,f=n+c,d=a+u;h=W.add(h,W.NW),t.x0=f+c*W.uX(h),t.y0=d+u*W.uY(h),h=W.add(h,2),t.x1=f+c*W.uX(h),t.y1=d+u*W.uY(h),h=W.add(h,2),t.x2=f+c*W.uX(h),t.y2=d+u*W.uY(h),h=W.add(h,2),t.x3=f+c*W.uX(h),t.y3=d+u*W.uY(h)}else t.x0=n,t.y0=a,t.x1=n+o,t.y1=a,t.x2=n+o,t.y2=a+l,t.x3=n,t.y3=a+l}destroy(t=!1){this._source&&(this._source.off("resize",this.update,this),t&&(this._source.destroy(),this._source=null)),this._textureMatrix=null,this.destroyed=!0,this.emit("destroy",this),this.removeAllListeners()}update(){this.noFrame&&(this.frame.width=this._source.width,this.frame.height=this._source.height),this.updateUvs(),this.emit("update",this)}get baseTexture(){return V(rt,"Texture.baseTexture is now Texture.source"),this._source}}U.EMPTY=new U({label:"EMPTY",source:new Ut({label:"EMPTY"})});U.EMPTY.destroy=Ul;U.WHITE=new U({source:new Dn({resource:new Uint8Array([255,255,255,255]),width:1,height:1,alphaMode:"premultiply-alpha-on-upload",label:"WHITE"}),label:"WHITE"});U.WHITE.destroy=Ul;function fd(s,t,e){const{width:r,height:i}=e.orig,n=e.trim;if(n){const a=n.width,o=n.height;s.minX=n.x-t._x*r,s.maxX=s.minX+a,s.minY=n.y-t._y*i,s.maxY=s.minY+o}else s.minX=-t._x*r,s.maxX=s.minX+r,s.minY=-t._y*i,s.maxY=s.minY+i}const Ma=new D;class qt{constructor(t=1/0,e=1/0,r=-1/0,i=-1/0){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Ma,this.minX=t,this.minY=e,this.maxX=r,this.maxY=i}isEmpty(){return this.minX>this.maxX||this.minY>this.maxY}get rectangle(){this._rectangle||(this._rectangle=new ct);const t=this._rectangle;return this.minX>this.maxX||this.minY>this.maxY?(t.x=0,t.y=0,t.width=0,t.height=0):t.copyFromBounds(this),t}clear(){return this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.matrix=Ma,this}set(t,e,r,i){this.minX=t,this.minY=e,this.maxX=r,this.maxY=i}addFrame(t,e,r,i,n){n||(n=this.matrix);const a=n.a,o=n.b,l=n.c,h=n.d,c=n.tx,u=n.ty;let f=this.minX,d=this.minY,p=this.maxX,y=this.maxY,m=a*t+l*e+c,g=o*t+h*e+u;m<f&&(f=m),g<d&&(d=g),m>p&&(p=m),g>y&&(y=g),m=a*r+l*e+c,g=o*r+h*e+u,m<f&&(f=m),g<d&&(d=g),m>p&&(p=m),g>y&&(y=g),m=a*t+l*i+c,g=o*t+h*i+u,m<f&&(f=m),g<d&&(d=g),m>p&&(p=m),g>y&&(y=g),m=a*r+l*i+c,g=o*r+h*i+u,m<f&&(f=m),g<d&&(d=g),m>p&&(p=m),g>y&&(y=g),this.minX=f,this.minY=d,this.maxX=p,this.maxY=y}addRect(t,e){this.addFrame(t.x,t.y,t.x+t.width,t.y+t.height,e)}addBounds(t,e){this.addFrame(t.minX,t.minY,t.maxX,t.maxY,e)}addBoundsMask(t){this.minX=this.minX>t.minX?this.minX:t.minX,this.minY=this.minY>t.minY?this.minY:t.minY,this.maxX=this.maxX<t.maxX?this.maxX:t.maxX,this.maxY=this.maxY<t.maxY?this.maxY:t.maxY}applyMatrix(t){const e=this.minX,r=this.minY,i=this.maxX,n=this.maxY,{a,b:o,c:l,d:h,tx:c,ty:u}=t;let f=a*e+l*r+c,d=o*e+h*r+u;this.minX=f,this.minY=d,this.maxX=f,this.maxY=d,f=a*i+l*r+c,d=o*i+h*r+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=a*e+l*n+c,d=o*e+h*n+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY,f=a*i+l*n+c,d=o*i+h*n+u,this.minX=f<this.minX?f:this.minX,this.minY=d<this.minY?d:this.minY,this.maxX=f>this.maxX?f:this.maxX,this.maxY=d>this.maxY?d:this.maxY}fit(t){return this.minX<t.left&&(this.minX=t.left),this.maxX>t.right&&(this.maxX=t.right),this.minY<t.top&&(this.minY=t.top),this.maxY>t.bottom&&(this.maxY=t.bottom),this}fitBounds(t,e,r,i){return this.minX<t&&(this.minX=t),this.maxX>e&&(this.maxX=e),this.minY<r&&(this.minY=r),this.maxY>i&&(this.maxY=i),this}pad(t,e=t){return this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e,this}ceil(){return this.minX=Math.floor(this.minX),this.minY=Math.floor(this.minY),this.maxX=Math.ceil(this.maxX),this.maxY=Math.ceil(this.maxY),this}clone(){return new qt(this.minX,this.minY,this.maxX,this.maxY)}scale(t,e=t){return this.minX*=t,this.minY*=e,this.maxX*=t,this.maxY*=e,this}get x(){return this.minX}set x(t){const e=this.maxX-this.minX;this.minX=t,this.maxX=t+e}get y(){return this.minY}set y(t){const e=this.maxY-this.minY;this.minY=t,this.maxY=t+e}get width(){return this.maxX-this.minX}set width(t){this.maxX=this.minX+t}get height(){return this.maxY-this.minY}set height(t){this.maxY=this.minY+t}get left(){return this.minX}get right(){return this.maxX}get top(){return this.minY}get bottom(){return this.maxY}get isPositive(){return this.maxX-this.minX>0&&this.maxY-this.minY>0}get isValid(){return this.minX+this.minY!==1/0}addVertexData(t,e,r,i){let n=this.minX,a=this.minY,o=this.maxX,l=this.maxY;i||(i=this.matrix);const h=i.a,c=i.b,u=i.c,f=i.d,d=i.tx,p=i.ty;for(let y=e;y<r;y+=2){const m=t[y],g=t[y+1],x=h*m+u*g+d,_=c*m+f*g+p;n=x<n?x:n,a=_<a?_:a,o=x>o?x:o,l=_>l?_:l}this.minX=n,this.minY=a,this.maxX=o,this.maxY=l}containsPoint(t,e){return this.minX<=t&&this.minY<=e&&this.maxX>=t&&this.maxY>=e}toString(){return`[pixi.js:Bounds minX=${this.minX} minY=${this.minY} maxX=${this.maxX} maxY=${this.maxY} width=${this.width} height=${this.height}]`}copyFrom(t){return this.minX=t.minX,this.minY=t.minY,this.maxX=t.maxX,this.maxY=t.maxY,this}}var pd={grad:.9,turn:360,rad:360/(2*Math.PI)},ne=function(s){return typeof s=="string"?s.length>0:typeof s=="number"},ot=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=Math.pow(10,t)),Math.round(e*s)/e+0},Bt=function(s,t,e){return t===void 0&&(t=0),e===void 0&&(e=1),s>e?e:s>t?s:t},Xl=function(s){return(s=isFinite(s)?s%360:0)>0?s:s+360},Ta=function(s){return{r:Bt(s.r,0,255),g:Bt(s.g,0,255),b:Bt(s.b,0,255),a:Bt(s.a)}},gi=function(s){return{r:ot(s.r),g:ot(s.g),b:ot(s.b),a:ot(s.a,3)}},md=/^#([0-9a-f]{3,8})$/i,Mr=function(s){var t=s.toString(16);return t.length<2?"0"+t:t},Yl=function(s){var t=s.r,e=s.g,r=s.b,i=s.a,n=Math.max(t,e,r),a=n-Math.min(t,e,r),o=a?n===t?(e-r)/a:n===e?2+(r-t)/a:4+(t-e)/a:0;return{h:60*(o<0?o+6:o),s:n?a/n*100:0,v:n/255*100,a:i}},ql=function(s){var t=s.h,e=s.s,r=s.v,i=s.a;t=t/360*6,e/=100,r/=100;var n=Math.floor(t),a=r*(1-e),o=r*(1-(t-n)*e),l=r*(1-(1-t+n)*e),h=n%6;return{r:255*[r,o,a,a,l,r][h],g:255*[l,r,r,o,a,a][h],b:255*[a,a,l,r,r,o][h],a:i}},ka=function(s){return{h:Xl(s.h),s:Bt(s.s,0,100),l:Bt(s.l,0,100),a:Bt(s.a)}},Ea=function(s){return{h:ot(s.h),s:ot(s.s),l:ot(s.l),a:ot(s.a,3)}},Ia=function(s){return ql((e=(t=s).s,{h:t.h,s:(e*=((r=t.l)<50?r:100-r)/100)>0?2*e/(r+e)*100:0,v:r+e,a:t.a}));var t,e,r},sr=function(s){return{h:(t=Yl(s)).h,s:(i=(200-(e=t.s))*(r=t.v)/100)>0&&i<200?e*r/100/(i<=100?i:200-i)*100:0,l:i/2,a:t.a};var t,e,r,i},gd=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,yd=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_d=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,xd=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,rn={string:[[function(s){var t=md.exec(s);return t?(s=t[1]).length<=4?{r:parseInt(s[0]+s[0],16),g:parseInt(s[1]+s[1],16),b:parseInt(s[2]+s[2],16),a:s.length===4?ot(parseInt(s[3]+s[3],16)/255,2):1}:s.length===6||s.length===8?{r:parseInt(s.substr(0,2),16),g:parseInt(s.substr(2,2),16),b:parseInt(s.substr(4,2),16),a:s.length===8?ot(parseInt(s.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(s){var t=_d.exec(s)||xd.exec(s);return t?t[2]!==t[4]||t[4]!==t[6]?null:Ta({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:t[7]===void 0?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(s){var t=gd.exec(s)||yd.exec(s);if(!t)return null;var e,r,i=ka({h:(e=t[1],r=t[2],r===void 0&&(r="deg"),Number(e)*(pd[r]||1)),s:Number(t[3]),l:Number(t[4]),a:t[5]===void 0?1:Number(t[5])/(t[6]?100:1)});return Ia(i)},"hsl"]],object:[[function(s){var t=s.r,e=s.g,r=s.b,i=s.a,n=i===void 0?1:i;return ne(t)&&ne(e)&&ne(r)?Ta({r:Number(t),g:Number(e),b:Number(r),a:Number(n)}):null},"rgb"],[function(s){var t=s.h,e=s.s,r=s.l,i=s.a,n=i===void 0?1:i;if(!ne(t)||!ne(e)||!ne(r))return null;var a=ka({h:Number(t),s:Number(e),l:Number(r),a:Number(n)});return Ia(a)},"hsl"],[function(s){var t=s.h,e=s.s,r=s.v,i=s.a,n=i===void 0?1:i;if(!ne(t)||!ne(e)||!ne(r))return null;var a=(function(o){return{h:Xl(o.h),s:Bt(o.s,0,100),v:Bt(o.v,0,100),a:Bt(o.a)}})({h:Number(t),s:Number(e),v:Number(r),a:Number(n)});return ql(a)},"hsv"]]},Ra=function(s,t){for(var e=0;e<t.length;e++){var r=t[e][0](s);if(r)return[r,t[e][1]]}return[null,void 0]},bd=function(s){return typeof s=="string"?Ra(s.trim(),rn.string):typeof s=="object"&&s!==null?Ra(s,rn.object):[null,void 0]},yi=function(s,t){var e=sr(s);return{h:e.h,s:Bt(e.s+100*t,0,100),l:e.l,a:e.a}},_i=function(s){return(299*s.r+587*s.g+114*s.b)/1e3/255},Ba=function(s,t){var e=sr(s);return{h:e.h,s:e.s,l:Bt(e.l+100*t,0,100),a:e.a}},nn=(function(){function s(t){this.parsed=bd(t)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return s.prototype.isValid=function(){return this.parsed!==null},s.prototype.brightness=function(){return ot(_i(this.rgba),2)},s.prototype.isDark=function(){return _i(this.rgba)<.5},s.prototype.isLight=function(){return _i(this.rgba)>=.5},s.prototype.toHex=function(){return t=gi(this.rgba),e=t.r,r=t.g,i=t.b,a=(n=t.a)<1?Mr(ot(255*n)):"","#"+Mr(e)+Mr(r)+Mr(i)+a;var t,e,r,i,n,a},s.prototype.toRgb=function(){return gi(this.rgba)},s.prototype.toRgbString=function(){return t=gi(this.rgba),e=t.r,r=t.g,i=t.b,(n=t.a)<1?"rgba("+e+", "+r+", "+i+", "+n+")":"rgb("+e+", "+r+", "+i+")";var t,e,r,i,n},s.prototype.toHsl=function(){return Ea(sr(this.rgba))},s.prototype.toHslString=function(){return t=Ea(sr(this.rgba)),e=t.h,r=t.s,i=t.l,(n=t.a)<1?"hsla("+e+", "+r+"%, "+i+"%, "+n+")":"hsl("+e+", "+r+"%, "+i+"%)";var t,e,r,i,n},s.prototype.toHsv=function(){return t=Yl(this.rgba),{h:ot(t.h),s:ot(t.s),v:ot(t.v),a:ot(t.a,3)};var t},s.prototype.invert=function(){return Qt({r:255-(t=this.rgba).r,g:255-t.g,b:255-t.b,a:t.a});var t},s.prototype.saturate=function(t){return t===void 0&&(t=.1),Qt(yi(this.rgba,t))},s.prototype.desaturate=function(t){return t===void 0&&(t=.1),Qt(yi(this.rgba,-t))},s.prototype.grayscale=function(){return Qt(yi(this.rgba,-1))},s.prototype.lighten=function(t){return t===void 0&&(t=.1),Qt(Ba(this.rgba,t))},s.prototype.darken=function(t){return t===void 0&&(t=.1),Qt(Ba(this.rgba,-t))},s.prototype.rotate=function(t){return t===void 0&&(t=15),this.hue(this.hue()+t)},s.prototype.alpha=function(t){return typeof t=="number"?Qt({r:(e=this.rgba).r,g:e.g,b:e.b,a:t}):ot(this.rgba.a,3);var e},s.prototype.hue=function(t){var e=sr(this.rgba);return typeof t=="number"?Qt({h:t,s:e.s,l:e.l,a:e.a}):ot(e.h)},s.prototype.isEqual=function(t){return this.toHex()===Qt(t).toHex()},s})(),Qt=function(s){return s instanceof nn?s:new nn(s)},Fa=[],vd=function(s){s.forEach(function(t){Fa.indexOf(t)<0&&(t(nn,rn),Fa.push(t))})};function wd(s,t){var e={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var i in e)r[e[i]]=i;var n={};s.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,l,h=r[this.toHex()];if(h)return h;if(a?.closest){var c=this.toRgb(),u=1/0,f="black";if(!n.length)for(var d in e)n[d]=new s(e[d]).toRgb();for(var p in e){var y=(o=c,l=n[p],Math.pow(o.r-l.r,2)+Math.pow(o.g-l.g,2)+Math.pow(o.b-l.b,2));y<u&&(u=y,f=p)}return f}},t.string.push([function(a){var o=a.toLowerCase(),l=o==="transparent"?"#0000":e[o];return l?new s(l).toRgb():null},"name"])}vd([wd]);const bs=class Ys{constructor(t=16777215){this._value=null,this._components=new Float32Array(4),this._components.fill(1),this._int=16777215,this.value=t}get red(){return this._components[0]}get green(){return this._components[1]}get blue(){return this._components[2]}get alpha(){return this._components[3]}setValue(t){return this.value=t,this}set value(t){if(t instanceof Ys)this._value=this._cloneSource(t._value),this._int=t._int,this._components.set(t._components);else{if(t===null)throw new Error("Cannot set Color#value to null");(this._value===null||!this._isSourceEqual(this._value,t))&&(this._value=this._cloneSource(t),this._normalize(this._value))}}get value(){return this._value}_cloneSource(t){return typeof t=="string"||typeof t=="number"||t instanceof Number||t===null?t:Array.isArray(t)||ArrayBuffer.isView(t)?t.slice(0):typeof t=="object"&&t!==null?{...t}:t}_isSourceEqual(t,e){const r=typeof t;if(r!==typeof e)return!1;if(r==="number"||r==="string"||t instanceof Number)return t===e;if(Array.isArray(t)&&Array.isArray(e)||ArrayBuffer.isView(t)&&ArrayBuffer.isView(e))return t.length!==e.length?!1:t.every((n,a)=>n===e[a]);if(t!==null&&e!==null){const n=Object.keys(t),a=Object.keys(e);return n.length!==a.length?!1:n.every(o=>t[o]===e[o])}return t===e}toRgba(){const[t,e,r,i]=this._components;return{r:t,g:e,b:r,a:i}}toRgb(){const[t,e,r]=this._components;return{r:t,g:e,b:r}}toRgbaString(){const[t,e,r]=this.toUint8RgbArray();return`rgba(${t},${e},${r},${this.alpha})`}toUint8RgbArray(t){const[e,r,i]=this._components;return this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb),t[0]=Math.round(e*255),t[1]=Math.round(r*255),t[2]=Math.round(i*255),t}toArray(t){this._arrayRgba||(this._arrayRgba=[]),t||(t=this._arrayRgba);const[e,r,i,n]=this._components;return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t}toRgbArray(t){this._arrayRgb||(this._arrayRgb=[]),t||(t=this._arrayRgb);const[e,r,i]=this._components;return t[0]=e,t[1]=r,t[2]=i,t}toNumber(){return this._int}toBgrNumber(){const[t,e,r]=this.toUint8RgbArray();return(r<<16)+(e<<8)+t}toLittleEndianNumber(){const t=this._int;return(t>>16)+(t&65280)+((t&255)<<16)}multiply(t){const[e,r,i,n]=Ys._temp.setValue(t)._components;return this._components[0]*=e,this._components[1]*=r,this._components[2]*=i,this._components[3]*=n,this._refreshInt(),this._value=null,this}premultiply(t,e=!0){return e&&(this._components[0]*=t,this._components[1]*=t,this._components[2]*=t),this._components[3]=t,this._refreshInt(),this._value=null,this}toPremultiplied(t,e=!0){if(t===1)return(255<<24)+this._int;if(t===0)return e?0:this._int;let r=this._int>>16&255,i=this._int>>8&255,n=this._int&255;return e&&(r=r*t+.5|0,i=i*t+.5|0,n=n*t+.5|0),(t*255<<24)+(r<<16)+(i<<8)+n}toHex(){const t=this._int.toString(16);return`#${"000000".substring(0,6-t.length)+t}`}toHexa(){const e=Math.round(this._components[3]*255).toString(16);return this.toHex()+"00".substring(0,2-e.length)+e}setAlpha(t){return this._components[3]=this._clamp(t),this}_normalize(t){let e,r,i,n;if((typeof t=="number"||t instanceof Number)&&t>=0&&t<=16777215){const a=t;e=(a>>16&255)/255,r=(a>>8&255)/255,i=(a&255)/255,n=1}else if((Array.isArray(t)||t instanceof Float32Array)&&t.length>=3&&t.length<=4)t=this._clamp(t),[e,r,i,n=1]=t;else if((t instanceof Uint8Array||t instanceof Uint8ClampedArray)&&t.length>=3&&t.length<=4)t=this._clamp(t,0,255),[e,r,i,n=255]=t,e/=255,r/=255,i/=255,n/=255;else if(typeof t=="string"||typeof t=="object"){if(typeof t=="string"){const o=Ys.HEX_PATTERN.exec(t);o&&(t=`#${o[2]}`)}const a=Qt(t);a.isValid()&&({r:e,g:r,b:i,a:n}=a.rgba,e/=255,r/=255,i/=255)}if(e!==void 0)this._components[0]=e,this._components[1]=r,this._components[2]=i,this._components[3]=n,this._refreshInt();else throw new Error(`Unable to convert color ${t}`)}_refreshInt(){this._clamp(this._components);const[t,e,r]=this._components;this._int=(t*255<<16)+(e*255<<8)+(r*255|0)}_clamp(t,e=0,r=1){return typeof t=="number"?Math.min(Math.max(t,e),r):(t.forEach((i,n)=>{t[n]=Math.min(Math.max(i,e),r)}),t)}static isColorLike(t){return typeof t=="number"||typeof t=="string"||t instanceof Number||t instanceof Ys||Array.isArray(t)||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Float32Array||t.r!==void 0&&t.g!==void 0&&t.b!==void 0||t.r!==void 0&&t.g!==void 0&&t.b!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0||t.h!==void 0&&t.s!==void 0&&t.l!==void 0&&t.a!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0||t.h!==void 0&&t.s!==void 0&&t.v!==void 0&&t.a!==void 0}};bs.shared=new bs;bs._temp=new bs;bs.HEX_PATTERN=/^(#|0x)?(([a-f0-9]{3}){1,2}([a-f0-9]{2})?)$/i;let Lt=bs;const Ad={cullArea:null,cullable:!1,cullableChildren:!0};let xi=0;const Ga=500;function q(...s){xi!==Ga&&(xi++,xi===Ga?console.warn("PixiJS Warning: too many warnings, no more warnings will be reported to the console by PixiJS."):console.warn("PixiJS Warning: ",...s))}const ri={_registeredResources:new Set,register(s){this._registeredResources.add(s)},unregister(s){this._registeredResources.delete(s)},release(){this._registeredResources.forEach(s=>s.clear())},get registeredCount(){return this._registeredResources.size},isRegistered(s){return this._registeredResources.has(s)},reset(){this._registeredResources.clear()}};class Sd{constructor(t,e){this._pool=[],this._count=0,this._index=0,this._classType=t,e&&this.prepopulate(e)}prepopulate(t){for(let e=0;e<t;e++)this._pool[this._index++]=new this._classType;this._count+=t}get(t){let e;return this._index>0?e=this._pool[--this._index]:(e=new this._classType,this._count++),e.init?.(t),e}return(t){t.reset?.(),this._pool[this._index++]=t}get totalSize(){return this._count}get totalFree(){return this._index}get totalUsed(){return this._count-this._index}clear(){if(this._pool.length>0&&this._pool[0].destroy)for(let t=0;t<this._index;t++)this._pool[t].destroy();this._pool.length=0,this._count=0,this._index=0}}class Cd{constructor(){this._poolsByClass=new Map}prepopulate(t,e){this.getPool(t).prepopulate(e)}get(t,e){return this.getPool(t).get(e)}return(t){this.getPool(t.constructor).return(t)}getPool(t){return this._poolsByClass.has(t)||this._poolsByClass.set(t,new Sd(t)),this._poolsByClass.get(t)}stats(){const t={};return this._poolsByClass.forEach(e=>{const r=t[e._classType.name]?e._classType.name+e._classType.ID:e._classType.name;t[r]={free:e.totalFree,used:e.totalUsed,size:e.totalSize}}),t}clear(){this._poolsByClass.forEach(t=>t.clear()),this._poolsByClass.clear()}}const At=new Cd;ri.register(At);const Pd={get isCachedAsTexture(){return!!this.renderGroup?.isCachedAsTexture},cacheAsTexture(s){typeof s=="boolean"&&s===!1?this.disableRenderGroup():(this.enableRenderGroup(),this.renderGroup.enableCacheAsTexture(s===!0?{}:s))},updateCacheTexture(){this.renderGroup?.updateCacheTexture()},get cacheAsBitmap(){return this.isCachedAsTexture},set cacheAsBitmap(s){V("v8.6.0","cacheAsBitmap is deprecated, use cacheAsTexture instead."),this.cacheAsTexture(s)}};function Md(s,t,e){const r=s.length;let i;if(t>=r||e===0)return;e=t+e>r?r-t:e;const n=r-e;for(i=t;i<n;++i)s[i]=s[i+e];s.length=n}const Td={allowChildren:!0,removeChildren(s=0,t){const e=t??this.children.length,r=e-s,i=[];if(r>0&&r<=e){for(let a=e-1;a>=s;a--){const o=this.children[a];o&&(i.push(o),o.parent=null)}Md(this.children,s,e);const n=this.renderGroup||this.parentRenderGroup;n&&n.removeChildren(i);for(let a=0;a<i.length;++a){const o=i[a];o.parentRenderLayer?.detach(o),this.emit("childRemoved",o,this,a),i[a].emit("removed",this)}return i.length>0&&this._didViewChangeTick++,i}else if(r===0&&this.children.length===0)return i;throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},removeChildAt(s){const t=this.getChildAt(s);return this.removeChild(t)},getChildAt(s){if(s<0||s>=this.children.length)throw new Error(`getChildAt: Index (${s}) does not exist.`);return this.children[s]},setChildIndex(s,t){if(t<0||t>=this.children.length)throw new Error(`The index ${t} supplied is out of bounds ${this.children.length}`);this.getChildIndex(s),this.addChildAt(s,t)},getChildIndex(s){const t=this.children.indexOf(s);if(t===-1)throw new Error("The supplied Container must be a child of the caller");return t},addChildAt(s,t){this.allowChildren||V(rt,"addChildAt: Only Containers will be allowed to add children in v8.0.0");const{children:e}=this;if(t<0||t>e.length)throw new Error(`${s}addChildAt: The index ${t} supplied is out of bounds ${e.length}`);if(s.parent){const i=s.parent.children.indexOf(s);if(s.parent===this&&i===t)return s;i!==-1&&s.parent.children.splice(i,1)}t===e.length?e.push(s):e.splice(t,0,s),s.parent=this,s.didChange=!0,s._updateFlags=15;const r=this.renderGroup||this.parentRenderGroup;return r&&r.addChild(s),this.sortableChildren&&(this.sortDirty=!0),this.emit("childAdded",s,this,t),s.emit("added",this),s},swapChildren(s,t){if(s===t)return;const e=this.getChildIndex(s),r=this.getChildIndex(t);this.children[e]=t,this.children[r]=s;const i=this.renderGroup||this.parentRenderGroup;i&&(i.structureDidChange=!0),this._didContainerChangeTick++},removeFromParent(){this.parent?.removeChild(this)},reparentChild(...s){return s.length===1?this.reparentChildAt(s[0],this.children.length):(s.forEach(t=>this.reparentChildAt(t,this.children.length)),s[0])},reparentChildAt(s,t){if(s.parent===this)return this.setChildIndex(s,t),s;const e=s.worldTransform.clone();s.removeFromParent(),this.addChildAt(s,t);const r=this.worldTransform.clone();return r.invert(),e.prepend(r),s.setFromMatrix(e),s},replaceChild(s,t){s.updateLocalTransform(),this.addChildAt(t,this.getChildIndex(s)),t.setFromMatrix(s.localTransform),t.updateLocalTransform(),this.removeChild(s)}},kd={collectRenderables(s,t,e){this.parentRenderLayer&&this.parentRenderLayer!==e||this.globalDisplayStatus<7||!this.includeInBuild||(this.sortableChildren&&this.sortChildren(),this.isSimple?this.collectRenderablesSimple(s,t,e):this.renderGroup?t.renderPipes.renderGroup.addRenderGroup(this.renderGroup,s):this.collectRenderablesWithEffects(s,t,e))},collectRenderablesSimple(s,t,e){const r=this.children,i=r.length;for(let n=0;n<i;n++)r[n].collectRenderables(s,t,e)},collectRenderablesWithEffects(s,t,e){const{renderPipes:r}=t;for(let i=0;i<this.effects.length;i++){const n=this.effects[i];r[n.pipe].push(n,this,s)}this.collectRenderablesSimple(s,t,e);for(let i=this.effects.length-1;i>=0;i--){const n=this.effects[i];r[n.pipe].pop(n,this,s)}}};class La{constructor(){this.pipe="filter",this.priority=1}destroy(){for(let t=0;t<this.filters.length;t++)this.filters[t].destroy();this.filters=null,this.filterArea=null}}class Ed{constructor(){this._effectClasses=[],this._tests=[],this._initialized=!1}init(){this._initialized||(this._initialized=!0,this._effectClasses.forEach(t=>{this.add({test:t.test,maskClass:t})}))}add(t){this._tests.push(t)}getMaskEffect(t){this._initialized||this.init();for(let e=0;e<this._tests.length;e++){const r=this._tests[e];if(r.test(t))return At.get(r.maskClass,t)}return t}returnMaskEffect(t){At.return(t)}}const an=new Ed;X.handleByList(k.MaskEffect,an._effectClasses);const Id={_maskEffect:null,_maskOptions:{inverse:!1},_filterEffect:null,effects:[],_markStructureAsChanged(){const s=this.renderGroup||this.parentRenderGroup;s&&(s.structureDidChange=!0)},addEffect(s){this.effects.indexOf(s)===-1&&(this.effects.push(s),this.effects.sort((e,r)=>e.priority-r.priority),this._markStructureAsChanged(),this._updateIsSimple())},removeEffect(s){const t=this.effects.indexOf(s);t!==-1&&(this.effects.splice(t,1),this._markStructureAsChanged(),this._updateIsSimple())},set mask(s){const t=this._maskEffect;t?.mask!==s&&(t&&(this.removeEffect(t),an.returnMaskEffect(t),this._maskEffect=null),s!=null&&(this._maskEffect=an.getMaskEffect(s),this.addEffect(this._maskEffect)))},get mask(){return this._maskEffect?.mask},setMask(s){this._maskOptions={...this._maskOptions,...s},s.mask&&(this.mask=s.mask),this._markStructureAsChanged()},set filters(s){!Array.isArray(s)&&s&&(s=[s]);const t=this._filterEffect||(this._filterEffect=new La);s=s;const e=s?.length>0,r=t.filters?.length>0,i=e!==r;s=Array.isArray(s)?s.slice(0):s,t.filters=Object.freeze(s),i&&(e?this.addEffect(t):(this.removeEffect(t),t.filters=s??null))},get filters(){return this._filterEffect?.filters},set filterArea(s){this._filterEffect||(this._filterEffect=new La),this._filterEffect.filterArea=s},get filterArea(){return this._filterEffect?.filterArea}},Rd={label:null,get name(){return V(rt,"Container.name property has been removed, use Container.label instead"),this.label},set name(s){V(rt,"Container.name property has been removed, use Container.label instead"),this.label=s},getChildByName(s,t=!1){return this.getChildByLabel(s,t)},getChildByLabel(s,t=!1){const e=this.children;for(let r=0;r<e.length;r++){const i=e[r];if(i.label===s||s instanceof RegExp&&s.test(i.label))return i}if(t)for(let r=0;r<e.length;r++){const n=e[r].getChildByLabel(s,!0);if(n)return n}return null},getChildrenByLabel(s,t=!1,e=[]){const r=this.children;for(let i=0;i<r.length;i++){const n=r[i];(n.label===s||s instanceof RegExp&&s.test(n.label))&&e.push(n)}if(t)for(let i=0;i<r.length;i++)r[i].getChildrenByLabel(s,!0,e);return e}},_t=At.getPool(D),he=At.getPool(qt),Bd=new D,Fd={getFastGlobalBounds(s,t){t||(t=new qt),t.clear(),this._getGlobalBoundsRecursive(!!s,t,this.parentRenderLayer),t.isValid||t.set(0,0,0,0);const e=this.renderGroup||this.parentRenderGroup;return t.applyMatrix(e.worldTransform),t},_getGlobalBoundsRecursive(s,t,e){let r=t;if(s&&this.parentRenderLayer&&this.parentRenderLayer!==e||this.localDisplayStatus!==7||!this.measurable)return;const i=!!this.effects.length;if((this.renderGroup||i)&&(r=he.get().clear()),this.boundsArea)t.addRect(this.boundsArea,this.worldTransform);else{if(this.renderPipeId){const a=this.bounds;r.addFrame(a.minX,a.minY,a.maxX,a.maxY,this.groupTransform)}const n=this.children;for(let a=0;a<n.length;a++)n[a]._getGlobalBoundsRecursive(s,r,e)}if(i){let n=!1;const a=this.renderGroup||this.parentRenderGroup;for(let o=0;o<this.effects.length;o++)this.effects[o].addBounds&&(n||(n=!0,r.applyMatrix(a.worldTransform)),this.effects[o].addBounds(r,!0));n&&r.applyMatrix(a.worldTransform.copyTo(Bd).invert()),t.addBounds(r),he.return(r)}else this.renderGroup&&(t.addBounds(r,this.relativeGroupTransform),he.return(r))}};function Kl(s,t,e){e.clear();let r,i;return s.parent?t?r=s.parent.worldTransform:(i=_t.get().identity(),r=On(s,i)):r=D.IDENTITY,Zl(s,e,r,t),i&&_t.return(i),e.isValid||e.set(0,0,0,0),e}function Zl(s,t,e,r){if(!s.visible||!s.measurable)return;let i;r?i=s.worldTransform:(s.updateLocalTransform(),i=_t.get(),i.appendFrom(s.localTransform,e));const n=t,a=!!s.effects.length;if(a&&(t=he.get().clear()),s.boundsArea)t.addRect(s.boundsArea,i);else{const o=s.bounds;o&&!o.isEmpty()&&(t.matrix=i,t.addBounds(o));for(let l=0;l<s.children.length;l++)Zl(s.children[l],t,i,r)}if(a){for(let o=0;o<s.effects.length;o++)s.effects[o].addBounds?.(t);n.addBounds(t,D.IDENTITY),he.return(t)}r||_t.return(i)}function On(s,t){const e=s.parent;return e&&(On(e,t),e.updateLocalTransform(),t.append(e.localTransform)),t}function Ql(s,t){if(s===16777215||!t)return t;if(t===16777215||!s)return s;const e=s>>16&255,r=s>>8&255,i=s&255,n=t>>16&255,a=t>>8&255,o=t&255,l=e*n/255|0,h=r*a/255|0,c=i*o/255|0;return(l<<16)+(h<<8)+c}const Da=16777215;function Oa(s,t){return s===Da?t:t===Da?s:Ql(s,t)}function Ur(s){return((s&255)<<16)+(s&65280)+(s>>16&255)}const Gd={getGlobalAlpha(s){if(s)return this.renderGroup?this.renderGroup.worldAlpha:this.parentRenderGroup?this.parentRenderGroup.worldAlpha*this.alpha:this.alpha;let t=this.alpha,e=this.parent;for(;e;)t*=e.alpha,e=e.parent;return t},getGlobalTransform(s=new D,t){if(t)return s.copyFrom(this.worldTransform);this.updateLocalTransform();const e=On(this,_t.get().identity());return s.appendFrom(this.localTransform,e),_t.return(e),s},getGlobalTint(s){if(s)return this.renderGroup?Ur(this.renderGroup.worldColor):this.parentRenderGroup?Ur(Oa(this.localColor,this.parentRenderGroup.worldColor)):this.tint;let t=this.localColor,e=this.parent;for(;e;)t=Oa(t,e.localColor),e=e.parent;return Ur(t)}};function Jl(s,t,e){return t.clear(),e||(e=D.IDENTITY),th(s,t,e,s,!0),t.isValid||t.set(0,0,0,0),t}function th(s,t,e,r,i){let n;if(i)n=_t.get(),n=e.copyTo(n);else{if(!s.visible||!s.measurable)return;s.updateLocalTransform();const l=s.localTransform;n=_t.get(),n.appendFrom(l,e)}const a=t,o=!!s.effects.length;if(o&&(t=he.get().clear()),s.boundsArea)t.addRect(s.boundsArea,n);else{s.renderPipeId&&(t.matrix=n,t.addBounds(s.bounds));const l=s.children;for(let h=0;h<l.length;h++)th(l[h],t,n,r,!1)}if(o){for(let l=0;l<s.effects.length;l++)s.effects[l].addLocalBounds?.(t,r);a.addBounds(t,D.IDENTITY),he.return(t)}_t.return(n)}function eh(s,t){const e=s.children;for(let r=0;r<e.length;r++){const i=e[r],n=i.uid,a=(i._didViewChangeTick&65535)<<16|i._didContainerChangeTick&65535,o=t.index;(t.data[o]!==n||t.data[o+1]!==a)&&(t.data[t.index]=n,t.data[t.index+1]=a,t.didChange=!0),t.index=o+2,i.children.length&&eh(i,t)}return t.didChange}const Ld=new D,Dd={_localBoundsCacheId:-1,_localBoundsCacheData:null,_setWidth(s,t){const e=Math.sign(this.scale.x)||1;t!==0?this.scale.x=s/t*e:this.scale.x=e},_setHeight(s,t){const e=Math.sign(this.scale.y)||1;t!==0?this.scale.y=s/t*e:this.scale.y=e},getLocalBounds(){this._localBoundsCacheData||(this._localBoundsCacheData={data:[],index:1,didChange:!1,localBounds:new qt});const s=this._localBoundsCacheData;return s.index=1,s.didChange=!1,s.data[0]!==this._didViewChangeTick&&(s.didChange=!0,s.data[0]=this._didViewChangeTick),eh(this,s),s.didChange&&Jl(this,s.localBounds,Ld),s.localBounds},getBounds(s,t){return Kl(this,s,t||new qt)}},Od={_onRender:null,set onRender(s){const t=this.renderGroup||this.parentRenderGroup;if(!s){this._onRender&&t?.removeOnRender(this),this._onRender=null;return}this._onRender||t?.addOnRender(this),this._onRender=s},get onRender(){return this._onRender}},zd={_zIndex:0,sortDirty:!1,sortableChildren:!1,get zIndex(){return this._zIndex},set zIndex(s){this._zIndex!==s&&(this._zIndex=s,this.depthOfChildModified())},depthOfChildModified(){this.parent&&(this.parent.sortableChildren=!0,this.parent.sortDirty=!0),this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0)},sortChildren(){this.sortDirty&&(this.sortDirty=!1,this.children.sort(Ud))}};function Ud(s,t){return s._zIndex-t._zIndex}const Nd={getGlobalPosition(s=new yt,t=!1){return this.parent?this.parent.toGlobal(this._position,s,t):(s.x=this._position.x,s.y=this._position.y),s},toGlobal(s,t,e=!1){const r=this.getGlobalTransform(_t.get(),e);return t=r.apply(s,t),_t.return(r),t},toLocal(s,t,e,r){t&&(s=t.toGlobal(s,e,r));const i=this.getGlobalTransform(_t.get(),r);return e=i.applyInverse(s,e),_t.return(i),e}};class zn{constructor(){this.uid=J("instructionSet"),this.instructions=[],this.instructionSize=0,this.renderables=[],this.gcTick=0}reset(){this.instructionSize=0}destroy(){this.instructions.length=0,this.renderables.length=0,this.renderPipes=null,this.gcTick=0}add(t){this.instructions[this.instructionSize++]=t}log(){this.instructions.length=this.instructionSize,console.table(this.instructions,["type","action"])}}let $d=0;class Vd{constructor(t){this._poolKeyHash=Object.create(null),this._texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this.textureStyle=new Wl(this.textureOptions)}createTexture(t,e,r){const i=new Ut({...this.textureOptions,width:t,height:e,resolution:1,antialias:r,autoGarbageCollect:!1});return new U({source:i,label:`texturePool_${$d++}`})}getOptimalTexture(t,e,r=1,i){let n=Math.ceil(t*r-1e-6),a=Math.ceil(e*r-1e-6);n=Aa(n),a=Aa(a);const o=(n<<17)+(a<<1)+(i?1:0);this._texturePool[o]||(this._texturePool[o]=[]);let l=this._texturePool[o].pop();return l||(l=this.createTexture(n,a,i)),l.source._resolution=r,l.source.width=n/r,l.source.height=a/r,l.source.pixelWidth=n,l.source.pixelHeight=a,l.frame.x=0,l.frame.y=0,l.frame.width=t,l.frame.height=e,l.updateUvs(),this._poolKeyHash[l.uid]=o,l}getSameSizeTexture(t,e=!1){const r=t.source;return this.getOptimalTexture(t.width,t.height,r._resolution,e)}returnTexture(t,e=!1){const r=this._poolKeyHash[t.uid];e&&(t.source.style=this.textureStyle),this._texturePool[r].push(t)}clear(t){if(t=t!==!1,t)for(const e in this._texturePool){const r=this._texturePool[e];if(r)for(let i=0;i<r.length;i++)r[i].destroy(!0)}this._texturePool={}}}const sh=new Vd;ri.register(sh);class Wd{constructor(){this.renderPipeId="renderGroup",this.root=null,this.canBundle=!1,this.renderGroupParent=null,this.renderGroupChildren=[],this.worldTransform=new D,this.worldColorAlpha=4294967295,this.worldColor=16777215,this.worldAlpha=1,this.childrenToUpdate=Object.create(null),this.updateTick=0,this.gcTick=0,this.childrenRenderablesToUpdate={list:[],index:0},this.structureDidChange=!0,this.instructionSet=new zn,this._onRenderContainers=[],this.textureNeedsUpdate=!0,this.isCachedAsTexture=!1,this._matrixDirty=7}init(t){this.root=t,t._onRender&&this.addOnRender(t),t.didChange=!0;const e=t.children;for(let r=0;r<e.length;r++){const i=e[r];i._updateFlags=15,this.addChild(i)}}enableCacheAsTexture(t={}){this.textureOptions=t,this.isCachedAsTexture=!0,this.textureNeedsUpdate=!0}disableCacheAsTexture(){this.isCachedAsTexture=!1,this.texture&&(sh.returnTexture(this.texture,!0),this.texture=null)}updateCacheTexture(){this.textureNeedsUpdate=!0;const t=this._parentCacheAsTextureRenderGroup;t&&!t.textureNeedsUpdate&&t.updateCacheTexture()}reset(){this.renderGroupChildren.length=0;for(const t in this.childrenToUpdate){const e=this.childrenToUpdate[t];e.list.fill(null),e.index=0}this.childrenRenderablesToUpdate.index=0,this.childrenRenderablesToUpdate.list.fill(null),this.root=null,this.updateTick=0,this.structureDidChange=!0,this._onRenderContainers.length=0,this.renderGroupParent=null,this.disableCacheAsTexture()}get localTransform(){return this.root.localTransform}addRenderGroupChild(t){t.renderGroupParent&&t.renderGroupParent._removeRenderGroupChild(t),t.renderGroupParent=this,this.renderGroupChildren.push(t)}_removeRenderGroupChild(t){const e=this.renderGroupChildren.indexOf(t);e>-1&&this.renderGroupChildren.splice(e,1),t.renderGroupParent=null}addChild(t){if(this.structureDidChange=!0,t.parentRenderGroup=this,t.updateTick=-1,t.parent===this.root?t.relativeRenderGroupDepth=1:t.relativeRenderGroupDepth=t.parent.relativeRenderGroupDepth+1,t.didChange=!0,this.onChildUpdate(t),t.renderGroup){this.addRenderGroupChild(t.renderGroup);return}t._onRender&&this.addOnRender(t);const e=t.children;for(let r=0;r<e.length;r++)this.addChild(e[r])}removeChild(t){if(this.structureDidChange=!0,t._onRender&&(t.renderGroup||this.removeOnRender(t)),t.parentRenderGroup=null,t.renderGroup){this._removeRenderGroupChild(t.renderGroup);return}const e=t.children;for(let r=0;r<e.length;r++)this.removeChild(e[r])}removeChildren(t){for(let e=0;e<t.length;e++)this.removeChild(t[e])}onChildUpdate(t){let e=this.childrenToUpdate[t.relativeRenderGroupDepth];e||(e=this.childrenToUpdate[t.relativeRenderGroupDepth]={index:0,list:[]}),e.list[e.index++]=t}updateRenderable(t){t.globalDisplayStatus<7||(this.instructionSet.renderPipes[t.renderPipeId].updateRenderable(t),t.didViewUpdate=!1)}onChildViewUpdate(t){this.childrenRenderablesToUpdate.list[this.childrenRenderablesToUpdate.index++]=t}get isRenderable(){return this.root.localDisplayStatus===7&&this.worldAlpha>0}addOnRender(t){this._onRenderContainers.push(t)}removeOnRender(t){this._onRenderContainers.splice(this._onRenderContainers.indexOf(t),1)}runOnRender(t){for(let e=0;e<this._onRenderContainers.length;e++)this._onRenderContainers[e]._onRender(t)}destroy(){this.disableCacheAsTexture(),this.renderGroupParent=null,this.root=null,this.childrenRenderablesToUpdate=null,this.childrenToUpdate=null,this.renderGroupChildren=null,this._onRenderContainers=null,this.instructionSet=null}getChildren(t=[]){const e=this.root.children;for(let r=0;r<e.length;r++)this._getChildren(e[r],t);return t}_getChildren(t,e=[]){if(e.push(t),t.renderGroup)return e;const r=t.children;for(let i=0;i<r.length;i++)this._getChildren(r[i],e);return e}invalidateMatrices(){this._matrixDirty=7}get inverseWorldTransform(){return(this._matrixDirty&1)===0?this._inverseWorldTransform:(this._matrixDirty&=-2,this._inverseWorldTransform||(this._inverseWorldTransform=new D),this._inverseWorldTransform.copyFrom(this.worldTransform).invert())}get textureOffsetInverseTransform(){return(this._matrixDirty&2)===0?this._textureOffsetInverseTransform:(this._matrixDirty&=-3,this._textureOffsetInverseTransform||(this._textureOffsetInverseTransform=new D),this._textureOffsetInverseTransform.copyFrom(this.inverseWorldTransform).translate(-this._textureBounds.x,-this._textureBounds.y))}get inverseParentTextureTransform(){if((this._matrixDirty&4)===0)return this._inverseParentTextureTransform;this._matrixDirty&=-5;const t=this._parentCacheAsTextureRenderGroup;return t?(this._inverseParentTextureTransform||(this._inverseParentTextureTransform=new D),this._inverseParentTextureTransform.copyFrom(this.worldTransform).prepend(t.inverseWorldTransform).translate(-t._textureBounds.x,-t._textureBounds.y)):this.worldTransform}get cacheToLocalTransform(){return this.isCachedAsTexture?this.textureOffsetInverseTransform:this._parentCacheAsTextureRenderGroup?this._parentCacheAsTextureRenderGroup.textureOffsetInverseTransform:null}}function Hd(s,t,e={}){for(const r in t)!e[r]&&t[r]!==void 0&&(s[r]=t[r])}const bi=new gt(null),Tr=new gt(null),vi=new gt(null,1,1),kr=new gt(null),za=1,jd=2,wi=4;class ue extends pe{constructor(t={}){super(),this.uid=J("renderable"),this._updateFlags=15,this.renderGroup=null,this.parentRenderGroup=null,this.parentRenderGroupIndex=0,this.didChange=!1,this.didViewUpdate=!1,this.relativeRenderGroupDepth=0,this.children=[],this.parent=null,this.includeInBuild=!0,this.measurable=!0,this.isSimple=!0,this.parentRenderLayer=null,this.updateTick=-1,this.localTransform=new D,this.relativeGroupTransform=new D,this.groupTransform=this.relativeGroupTransform,this.destroyed=!1,this._position=new gt(this,0,0),this._scale=vi,this._pivot=Tr,this._origin=kr,this._skew=bi,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._rotation=0,this.localColor=16777215,this.localAlpha=1,this.groupAlpha=1,this.groupColor=16777215,this.groupColorAlpha=4294967295,this.localBlendMode="inherit",this.groupBlendMode="normal",this.localDisplayStatus=7,this.globalDisplayStatus=7,this._didContainerChangeTick=0,this._didViewChangeTick=0,this._didLocalTransformChangeId=-1,this.effects=[],Hd(this,t,{children:!0,parent:!0,effects:!0}),t.children?.forEach(e=>this.addChild(e)),t.parent?.addChild(this)}static mixin(t){V("8.8.0","Container.mixin is deprecated, please use extensions.mixin instead."),X.mixin(ue,t)}set _didChangeId(t){this._didViewChangeTick=t>>12&4095,this._didContainerChangeTick=t&4095}get _didChangeId(){return this._didContainerChangeTick&4095|(this._didViewChangeTick&4095)<<12}addChild(...t){if(this.allowChildren||V(rt,"addChild: Only Containers will be allowed to add children in v8.0.0"),t.length>1){for(let i=0;i<t.length;i++)this.addChild(t[i]);return t[0]}const e=t[0],r=this.renderGroup||this.parentRenderGroup;return e.parent===this?(this.children.splice(this.children.indexOf(e),1),this.children.push(e),r&&(r.structureDidChange=!0),e):(e.parent&&e.parent.removeChild(e),this.children.push(e),this.sortableChildren&&(this.sortDirty=!0),e.parent=this,e.didChange=!0,e._updateFlags=15,r&&r.addChild(e),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this),this._didViewChangeTick++,e._zIndex!==0&&e.depthOfChildModified(),e)}removeChild(...t){if(t.length>1){for(let i=0;i<t.length;i++)this.removeChild(t[i]);return t[0]}const e=t[0],r=this.children.indexOf(e);return r>-1&&(this._didViewChangeTick++,this.children.splice(r,1),this.renderGroup?this.renderGroup.removeChild(e):this.parentRenderGroup&&this.parentRenderGroup.removeChild(e),e.parentRenderLayer&&e.parentRenderLayer.detach(e),e.parent=null,this.emit("childRemoved",e,this,r),e.emit("removed",this)),e}_onUpdate(t){t&&t===this._skew&&this._updateSkew(),this._didContainerChangeTick++,!this.didChange&&(this.didChange=!0,this.parentRenderGroup&&this.parentRenderGroup.onChildUpdate(this))}set isRenderGroup(t){!!this.renderGroup!==t&&(t?this.enableRenderGroup():this.disableRenderGroup())}get isRenderGroup(){return!!this.renderGroup}enableRenderGroup(){if(this.renderGroup)return;const t=this.parentRenderGroup;t?.removeChild(this),this.renderGroup=At.get(Wd,this),this.groupTransform=D.IDENTITY,t?.addChild(this),this._updateIsSimple()}disableRenderGroup(){if(!this.renderGroup)return;const t=this.parentRenderGroup;t?.removeChild(this),At.return(this.renderGroup),this.renderGroup=null,this.groupTransform=this.relativeGroupTransform,t?.addChild(this),this._updateIsSimple()}_updateIsSimple(){this.isSimple=!this.renderGroup&&this.effects.length===0}get worldTransform(){return this._worldTransform||(this._worldTransform=new D),this.renderGroup?this._worldTransform.copyFrom(this.renderGroup.worldTransform):this.parentRenderGroup&&this._worldTransform.appendFrom(this.relativeGroupTransform,this.parentRenderGroup.worldTransform),this._worldTransform}get x(){return this._position.x}set x(t){this._position.x=t}get y(){return this._position.y}set y(t){this._position.y=t}get position(){return this._position}set position(t){this._position.copyFrom(t)}get rotation(){return this._rotation}set rotation(t){this._rotation!==t&&(this._rotation=t,this._onUpdate(this._skew))}get angle(){return this.rotation*nd}set angle(t){this.rotation=t*ad}get pivot(){return this._pivot===Tr&&(this._pivot=new gt(this,0,0)),this._pivot}set pivot(t){this._pivot===Tr&&(this._pivot=new gt(this,0,0),this._origin!==kr&&q("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._pivot.set(t):this._pivot.copyFrom(t)}get skew(){return this._skew===bi&&(this._skew=new gt(this,0,0)),this._skew}set skew(t){this._skew===bi&&(this._skew=new gt(this,0,0)),this._skew.copyFrom(t)}get scale(){return this._scale===vi&&(this._scale=new gt(this,1,1)),this._scale}set scale(t){this._scale===vi&&(this._scale=new gt(this,0,0)),typeof t=="string"&&(t=parseFloat(t)),typeof t=="number"?this._scale.set(t):this._scale.copyFrom(t)}get origin(){return this._origin===kr&&(this._origin=new gt(this,0,0)),this._origin}set origin(t){this._origin===kr&&(this._origin=new gt(this,0,0),this._pivot!==Tr&&q("Setting both a pivot and origin on a Container is not recommended. This can lead to unexpected behavior if not handled carefully.")),typeof t=="number"?this._origin.set(t):this._origin.copyFrom(t)}get width(){return Math.abs(this.scale.x*this.getLocalBounds().width)}set width(t){const e=this.getLocalBounds().width;this._setWidth(t,e)}get height(){return Math.abs(this.scale.y*this.getLocalBounds().height)}set height(t){const e=this.getLocalBounds().height;this._setHeight(t,e)}getSize(t){t||(t={});const e=this.getLocalBounds();return t.width=Math.abs(this.scale.x*e.width),t.height=Math.abs(this.scale.y*e.height),t}setSize(t,e){const r=this.getLocalBounds();typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,r.width),e!==void 0&&this._setHeight(e,r.height)}_updateSkew(){const t=this._rotation,e=this._skew;this._cx=Math.cos(t+e._y),this._sx=Math.sin(t+e._y),this._cy=-Math.sin(t-e._x),this._sy=Math.cos(t-e._x)}updateTransform(t){return this.position.set(typeof t.x=="number"?t.x:this.position.x,typeof t.y=="number"?t.y:this.position.y),this.scale.set(typeof t.scaleX=="number"?t.scaleX||1:this.scale.x,typeof t.scaleY=="number"?t.scaleY||1:this.scale.y),this.rotation=typeof t.rotation=="number"?t.rotation:this.rotation,this.skew.set(typeof t.skewX=="number"?t.skewX:this.skew.x,typeof t.skewY=="number"?t.skewY:this.skew.y),this.pivot.set(typeof t.pivotX=="number"?t.pivotX:this.pivot.x,typeof t.pivotY=="number"?t.pivotY:this.pivot.y),this.origin.set(typeof t.originX=="number"?t.originX:this.origin.x,typeof t.originY=="number"?t.originY:this.origin.y),this}setFromMatrix(t){t.decompose(this)}updateLocalTransform(){const t=this._didContainerChangeTick;if(this._didLocalTransformChangeId===t)return;this._didLocalTransformChangeId=t;const e=this.localTransform,r=this._scale,i=this._pivot,n=this._origin,a=this._position,o=r._x,l=r._y,h=i._x,c=i._y,u=-n._x,f=-n._y;e.a=this._cx*o,e.b=this._sx*o,e.c=this._cy*l,e.d=this._sy*l,e.tx=a._x-(h*e.a+c*e.c)+(u*e.a+f*e.c)-u,e.ty=a._y-(h*e.b+c*e.d)+(u*e.b+f*e.d)-f}set alpha(t){t!==this.localAlpha&&(this.localAlpha=t,this._updateFlags|=za,this._onUpdate())}get alpha(){return this.localAlpha}set tint(t){const r=Lt.shared.setValue(t??16777215).toBgrNumber();r!==this.localColor&&(this.localColor=r,this._updateFlags|=za,this._onUpdate())}get tint(){return Ur(this.localColor)}set blendMode(t){this.localBlendMode!==t&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=jd,this.localBlendMode=t,this._onUpdate())}get blendMode(){return this.localBlendMode}get visible(){return!!(this.localDisplayStatus&2)}set visible(t){const e=t?2:0;(this.localDisplayStatus&2)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=wi,this.localDisplayStatus^=2,this._onUpdate())}get culled(){return!(this.localDisplayStatus&4)}set culled(t){const e=t?0:4;(this.localDisplayStatus&4)!==e&&(this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._updateFlags|=wi,this.localDisplayStatus^=4,this._onUpdate())}get renderable(){return!!(this.localDisplayStatus&1)}set renderable(t){const e=t?1:0;(this.localDisplayStatus&1)!==e&&(this._updateFlags|=wi,this.localDisplayStatus^=1,this.parentRenderGroup&&(this.parentRenderGroup.structureDidChange=!0),this._onUpdate())}get isRenderable(){return this.localDisplayStatus===7&&this.groupAlpha>0}destroy(t=!1){if(this.destroyed)return;this.destroyed=!0;let e;if(this.children.length&&(e=this.removeChildren(0,this.children.length)),this.removeFromParent(),this.parent=null,this._maskEffect=null,this._filterEffect=null,this.effects=null,this._position=null,this._scale=null,this._pivot=null,this._origin=null,this._skew=null,this.emit("destroyed",this),this.removeAllListeners(),(typeof t=="boolean"?t:t?.children)&&e)for(let i=0;i<e.length;++i)e[i].destroy(t);this.renderGroup?.destroy(),this.renderGroup=null}}X.mixin(ue,Td,Fd,Nd,Od,Dd,Id,Rd,zd,Ad,Pd,Gd,kd);class rh extends ue{constructor(t){super(t),this.canBundle=!0,this.allowChildren=!1,this._roundPixels=0,this._lastUsed=-1,this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this._bounds=new qt(0,1,0,0),this._boundsDirty=!0,this.autoGarbageCollect=t.autoGarbageCollect??!0}get bounds(){return this._boundsDirty?(this.updateBounds(),this._boundsDirty=!1,this._bounds):this._bounds}get roundPixels(){return!!this._roundPixels}set roundPixels(t){this._roundPixels=t?1:0}containsPoint(t){const e=this.bounds,{x:r,y:i}=t;return r>=e.minX&&r<=e.maxX&&i>=e.minY&&i<=e.maxY}onViewUpdate(){if(this._didViewChangeTick++,this._boundsDirty=!0,this.didViewUpdate)return;this.didViewUpdate=!0;const t=this.renderGroup||this.parentRenderGroup;t&&t.onChildViewUpdate(this)}unload(){this.emit("unload",this);for(const t in this._gpuData)this._gpuData[t]?.destroy();this._gpuData=Object.create(null),this.onViewUpdate()}destroy(t){this.unload(),super.destroy(t),this._bounds=null}collectRenderablesSimple(t,e,r){const{renderPipes:i}=e;i.blendMode.pushBlendMode(this,this.groupBlendMode,t);const a=i[this.renderPipeId];a?.addRenderable&&a.addRenderable(this,t),this.didViewUpdate=!1;const o=this.children,l=o.length;for(let h=0;h<l;h++)o[h].collectRenderables(t,e,r);i.blendMode.popBlendMode(t)}}class Ze extends rh{constructor(t=U.EMPTY){t instanceof U&&(t={texture:t});const{texture:e=U.EMPTY,anchor:r,roundPixels:i,width:n,height:a,...o}=t;super({label:"Sprite",...o}),this.renderPipeId="sprite",this.batched=!0,this._visualBounds={minX:0,maxX:1,minY:0,maxY:0},this._anchor=new gt({_onUpdate:()=>{this.onViewUpdate()}}),r?this.anchor=r:e.defaultAnchor&&(this.anchor=e.defaultAnchor),this.texture=e,this.allowChildren=!1,this.roundPixels=i??!1,n!==void 0&&(this.width=n),a!==void 0&&(this.height=a)}static from(t,e=!1){return t instanceof U?new Ze(t):new Ze(U.from(t,e))}set texture(t){t||(t=U.EMPTY);const e=this._texture;e!==t&&(e&&e.dynamic&&e.off("update",this.onViewUpdate,this),t.dynamic&&t.on("update",this.onViewUpdate,this),this._texture=t,this._width&&this._setWidth(this._width,this._texture.orig.width),this._height&&this._setHeight(this._height,this._texture.orig.height),this.onViewUpdate())}get texture(){return this._texture}get visualBounds(){return fd(this._visualBounds,this._anchor,this._texture),this._visualBounds}get sourceBounds(){return V("8.6.1","Sprite.sourceBounds is deprecated, use visualBounds instead."),this.visualBounds}updateBounds(){const t=this._anchor,e=this._texture,r=this._bounds,{width:i,height:n}=e.orig;r.minX=-t._x*i,r.maxX=r.minX+i,r.minY=-t._y*n,r.maxY=r.minY+n}destroy(t=!1){if(super.destroy(t),typeof t=="boolean"?t:t?.texture){const r=typeof t=="boolean"?t:t?.textureSource;this._texture.destroy(r)}this._texture=null,this._visualBounds=null,this._bounds=null,this._anchor=null}get anchor(){return this._anchor}set anchor(t){typeof t=="number"?this._anchor.set(t):this._anchor.copyFrom(t)}get width(){return Math.abs(this.scale.x)*this._texture.orig.width}set width(t){this._setWidth(t,this._texture.orig.width),this._width=t}get height(){return Math.abs(this.scale.y)*this._texture.orig.height}set height(t){this._setHeight(t,this._texture.orig.height),this._height=t}getSize(t){return t||(t={}),t.width=Math.abs(this.scale.x)*this._texture.orig.width,t.height=Math.abs(this.scale.y)*this._texture.orig.height,t}setSize(t,e){typeof t=="object"?(e=t.height??t.width,t=t.width):e??(e=t),t!==void 0&&this._setWidth(t,this._texture.orig.width),e!==void 0&&this._setHeight(e,this._texture.orig.height)}}const Xd=new qt;function ih(s,t,e){const r=Xd;s.measurable=!0,Kl(s,e,r),t.addBoundsMask(r),s.measurable=!1}function nh(s,t,e){const r=he.get();s.measurable=!0;const i=_t.get().identity(),n=ah(s,e,i);Jl(s,r,n),s.measurable=!1,t.addBoundsMask(r),_t.return(i),he.return(r)}function ah(s,t,e){return s?(s!==t&&(ah(s.parent,t,e),s.updateLocalTransform(),e.append(s.localTransform)),e):(q("Mask bounds, renderable is not inside the root container"),e)}class oh{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof Ze),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask=null)}addBounds(t,e){this.inverse||ih(this.mask,t,e)}addLocalBounds(t,e){nh(this.mask,t,e)}containsPoint(t,e){const r=this.mask;return e(r,t)}destroy(){this.reset()}static test(t){return t instanceof Ze}}oh.extension=k.MaskEffect;class lh{constructor(t){this.priority=0,this.pipe="colorMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return typeof t=="number"}}lh.extension=k.MaskEffect;class hh{constructor(t){this.priority=0,this.pipe="stencilMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){this.mask!==null&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(t,e){ih(this.mask,t,e)}addLocalBounds(t,e){nh(this.mask,t,e)}containsPoint(t,e){const r=this.mask;return e(r,t)}destroy(){this.reset()}static test(t){return t instanceof ue}}hh.extension=k.MaskEffect;const Yd={createCanvas:(s,t)=>{const e=document.createElement("canvas");return e.width=s,e.height=t,e},createImage:()=>new Image,getCanvasRenderingContext2D:()=>CanvasRenderingContext2D,getWebGLRenderingContext:()=>WebGLRenderingContext,getNavigator:()=>navigator,getBaseUrl:()=>document.baseURI??window.location.href,getFontFaceSet:()=>document.fonts,fetch:(s,t)=>fetch(s,t),parseXML:s=>new DOMParser().parseFromString(s,"text/xml")};let Ua=Yd;const tt={get(){return Ua},set(s){Ua=s}};class ch extends Ut{constructor(t){t.resource||(t.resource=tt.get().createCanvas()),t.width||(t.width=t.resource.width,t.autoDensity||(t.width/=t.resolution)),t.height||(t.height=t.resource.height,t.autoDensity||(t.height/=t.resolution)),super(t),this.uploadMethodId="image",this.autoDensity=t.autoDensity,this.resizeCanvas(),this.transparent=!!t.transparent}resizeCanvas(){this.autoDensity&&"style"in this.resource&&(this.resource.style.width=`${this.width}px`,this.resource.style.height=`${this.height}px`),(this.resource.width!==this.pixelWidth||this.resource.height!==this.pixelHeight)&&(this.resource.width=this.pixelWidth,this.resource.height=this.pixelHeight)}resize(t=this.width,e=this.height,r=this._resolution){const i=super.resize(t,e,r);return i&&this.resizeCanvas(),i}static test(t){return globalThis.HTMLCanvasElement&&t instanceof HTMLCanvasElement||globalThis.OffscreenCanvas&&t instanceof OffscreenCanvas}get context2D(){return this._context2D||(this._context2D=this.resource.getContext("2d"))}}ch.extension=k.TextureSource;class vs extends Ut{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}vs.extension=k.TextureSource;var Xr=(s=>(s[s.INTERACTION=50]="INTERACTION",s[s.HIGH=25]="HIGH",s[s.NORMAL=0]="NORMAL",s[s.LOW=-25]="LOW",s[s.UTILITY=-50]="UTILITY",s))(Xr||{});class Ai{constructor(t,e=null,r=0,i=!1){this.next=null,this.previous=null,this._destroyed=!1,this._fn=t,this._context=e,this.priority=r,this._once=i}match(t,e=null){return this._fn===t&&this._context===e}emit(t){this._fn&&(this._context?this._fn.call(this._context,t):this._fn(t));const e=this.next;return this._once&&this.destroy(!0),this._destroyed&&(this.next=null),e}connect(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this}destroy(t=!1){this._destroyed=!0,this._fn=null,this._context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);const e=this.next;return this.next=t?null:e,this.previous=null,e}}const uh=class St{constructor(){this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new Ai(null,null,1/0),this.deltaMS=1/St.targetFPMS,this.elapsedMS=1/St.targetFPMS,this._tick=t=>{this._requestId=null,this.started&&(this.update(t),this.started&&this._requestId===null&&this._head.next&&(this._requestId=requestAnimationFrame(this._tick)))}}_requestIfNeeded(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))}_cancelIfNeeded(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)}_startIfPossible(){this.started?this._requestIfNeeded():this.autoStart&&this.start()}add(t,e,r=Xr.NORMAL){return this._addListener(new Ai(t,e,r))}addOnce(t,e,r=Xr.NORMAL){return this._addListener(new Ai(t,e,r,!0))}_addListener(t){let e=this._head.next,r=this._head;if(!e)t.connect(r);else{for(;e;){if(t.priority>e.priority){t.connect(r);break}r=e,e=e.next}t.previous||t.connect(r)}return this._startIfPossible(),this}remove(t,e){let r=this._head.next;for(;r;)r.match(t,e)?r=r.destroy():r=r.next;return this._head.next||this._cancelIfNeeded(),this}get count(){if(!this._head)return 0;let t=0,e=this._head;for(;e=e.next;)t++;return t}start(){this.started||(this.started=!0,this._requestIfNeeded())}stop(){this.started&&(this.started=!1,this._cancelIfNeeded())}destroy(){if(!this._protected){this.stop();let t=this._head.next;for(;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}}update(t=performance.now()){let e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){const n=t-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=t-n%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*St.targetFPMS;const r=this._head;let i=r.next;for(;i;)i=i.emit(this);r.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t}get FPS(){return 1e3/this.elapsedMS}get minFPS(){return 1e3/this._maxElapsedMS}set minFPS(t){const e=Math.min(this.maxFPS,t),r=Math.min(Math.max(0,e)/1e3,St.targetFPMS);this._maxElapsedMS=1/r}get maxFPS(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0}set maxFPS(t){if(t===0)this._minElapsedMS=0;else{const e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}}static get shared(){if(!St._shared){const t=St._shared=new St;t.autoStart=!0,t._protected=!0}return St._shared}static get system(){if(!St._system){const t=St._system=new St;t.autoStart=!0,t._protected=!0}return St._system}};uh.targetFPMS=.06;let cs=uh,Si;async function dh(){return Si??(Si=(async()=>{const t=tt.get().createCanvas(1,1).getContext("webgl");if(!t)return"premultiply-alpha-on-upload";const e=await new Promise(a=>{const o=document.createElement("video");o.onloadeddata=()=>a(o),o.onerror=()=>a(null),o.autoplay=!1,o.crossOrigin="anonymous",o.preload="auto",o.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",o.load()});if(!e)return"premultiply-alpha-on-upload";const r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);const n=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,n),t.deleteFramebuffer(i),t.deleteTexture(r),t.getExtension("WEBGL_lose_context")?.loseContext(),n[0]<=n[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),Si}const ii=class fh extends Ut{constructor(t){super(t),this.isReady=!1,this.uploadMethodId="video",t={...fh.defaultOptions,...t},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=t.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=t.autoPlay!==!1,this.alphaMode=t.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),t.autoLoad!==!1&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){const t=cs.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;const t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await dh(),this._load=new Promise((r,i)=>{this.isValid?r(this):(this._resolve=r,this._reject=i,e.preloadTimeoutMs!==void 0&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){const t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){const t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();const t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(cs.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),this._videoFrameRequestCallbackHandle===null&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(cs.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(this._videoFrameRequestCallbackHandle!==null&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(cs.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};ii.extension=k.TextureSource;ii.defaultOptions={...Ut.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1};ii.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"};let rr=ii;const Ht=(s,t,e=!1)=>(Array.isArray(s)||(s=[s]),t?s.map(r=>typeof r=="string"||e?t(r):r):s);class qd{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){const e=this._cache.get(t);return e||q(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){const r=Ht(t);let i;for(let l=0;l<this.parsers.length;l++){const h=this.parsers[l];if(h.test(e)){i=h.getCacheableAssets(r,e);break}}const n=new Map(Object.entries(i||{}));i||r.forEach(l=>{n.set(l,e)});const a=[...n.keys()],o={cacheKeys:a,keys:r};r.forEach(l=>{this._cacheMap.set(l,o)}),a.forEach(l=>{const h=i?i[l]:e;this._cache.has(l)&&this._cache.get(l)!==h&&q("[Cache] already has key:",l),this._cache.set(l,n.get(l))})}remove(t){if(!this._cacheMap.has(t)){q(`[Assets] Asset id ${t} was not found in the Cache`);return}const e=this._cacheMap.get(t);e.cacheKeys.forEach(i=>{this._cache.delete(i)}),e.keys.forEach(i=>{this._cacheMap.delete(i)})}get parsers(){return this._parsers}}const ht=new qd,on=[];X.handleByList(k.TextureSource,on);function ph(s={}){const t=s&&s.resource,e=t?s.resource:s,r=t?s:{resource:s};for(let i=0;i<on.length;i++){const n=on[i];if(n.test(e))return new n(r)}throw new Error(`Could not find a source type for resource: ${r.resource}`)}function Kd(s={},t=!1){const e=s&&s.resource,r=e?s.resource:s,i=e?s:{resource:s};if(!t&&ht.has(r))return ht.get(r);const n=new U({source:ph(i)});return n.on("destroy",()=>{ht.has(r)&&ht.remove(r)}),t||ht.set(r,n),n}function Zd(s,t=!1){return typeof s=="string"?ht.get(s):s instanceof Ut?new U({source:s}):Kd(s,t)}U.from=Zd;Ut.from=ph;X.add(oh,lh,hh,rr,vs,ch,Dn);var ke=(s=>(s[s.Low=0]="Low",s[s.Normal=1]="Normal",s[s.High=2]="High",s))(ke||{});function Vt(s){if(typeof s!="string")throw new TypeError(`Path must be a string. Received ${JSON.stringify(s)}`)}function zs(s){return s.split("?")[0].split("#")[0]}function Qd(s){return s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Jd(s,t,e){return s.replace(new RegExp(Qd(t),"g"),e)}function tf(s,t){let e="",r=0,i=-1,n=0,a=-1;for(let o=0;o<=s.length;++o){if(o<s.length)a=s.charCodeAt(o);else{if(a===47)break;a=47}if(a===47){if(!(i===o-1||n===1))if(i!==o-1&&n===2){if(e.length<2||r!==2||e.charCodeAt(e.length-1)!==46||e.charCodeAt(e.length-2)!==46){if(e.length>2){const l=e.lastIndexOf("/");if(l!==e.length-1){l===-1?(e="",r=0):(e=e.slice(0,l),r=e.length-1-e.lastIndexOf("/")),i=o,n=0;continue}}else if(e.length===2||e.length===1){e="",r=0,i=o,n=0;continue}}}else e.length>0?e+=`/${s.slice(i+1,o)}`:e=s.slice(i+1,o),r=o-i-1;i=o,n=0}else a===46&&n!==-1?++n:n=-1}return e}const Tt={toPosix(s){return Jd(s,"\\","/")},isUrl(s){return/^https?:/.test(this.toPosix(s))},isDataUrl(s){return/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(s)},isBlobUrl(s){return s.startsWith("blob:")},hasProtocol(s){return/^[^/:]+:/.test(this.toPosix(s))},getProtocol(s){Vt(s),s=this.toPosix(s);const t=/^file:\/\/\//.exec(s);if(t)return t[0];const e=/^[^/:]+:\/{0,2}/.exec(s);return e?e[0]:""},toAbsolute(s,t,e){if(Vt(s),this.isDataUrl(s)||this.isBlobUrl(s))return s;const r=zs(this.toPosix(t??tt.get().getBaseUrl())),i=zs(this.toPosix(e??this.rootname(r)));return s=this.toPosix(s),s.startsWith("/")?Tt.join(i,s.slice(1)):this.isAbsolute(s)?s:this.join(r,s)},normalize(s){if(Vt(s),s.length===0)return".";if(this.isDataUrl(s)||this.isBlobUrl(s))return s;s=this.toPosix(s);let t="";const e=s.startsWith("/");this.hasProtocol(s)&&(t=this.rootname(s),s=s.slice(t.length));const r=s.endsWith("/");return s=tf(s),s.length>0&&r&&(s+="/"),e?`/${s}`:t+s},isAbsolute(s){return Vt(s),s=this.toPosix(s),this.hasProtocol(s)?!0:s.startsWith("/")},join(...s){if(s.length===0)return".";let t;for(let e=0;e<s.length;++e){const r=s[e];if(Vt(r),r.length>0)if(t===void 0)t=r;else{const i=s[e-1]??"";this.joinExtensions.includes(this.extname(i).toLowerCase())?t+=`/../${r}`:t+=`/${r}`}}return t===void 0?".":this.normalize(t)},dirname(s){if(Vt(s),s.length===0)return".";s=this.toPosix(s);let t=s.charCodeAt(0);const e=t===47;let r=-1,i=!0;const n=this.getProtocol(s),a=s;s=s.slice(n.length);for(let o=s.length-1;o>=1;--o)if(t=s.charCodeAt(o),t===47){if(!i){r=o;break}}else i=!1;return r===-1?e?"/":this.isUrl(a)?n+s:n:e&&r===1?"//":n+s.slice(0,r)},rootname(s){Vt(s),s=this.toPosix(s);let t="";if(s.startsWith("/")?t="/":t=this.getProtocol(s),this.isUrl(s)){const e=s.indexOf("/",t.length);e!==-1?t=s.slice(0,e):t=s,t.endsWith("/")||(t+="/")}return t},basename(s,t){Vt(s),t&&Vt(t),s=zs(this.toPosix(s));let e=0,r=-1,i=!0,n;if(t!==void 0&&t.length>0&&t.length<=s.length){if(t.length===s.length&&t===s)return"";let a=t.length-1,o=-1;for(n=s.length-1;n>=0;--n){const l=s.charCodeAt(n);if(l===47){if(!i){e=n+1;break}}else o===-1&&(i=!1,o=n+1),a>=0&&(l===t.charCodeAt(a)?--a===-1&&(r=n):(a=-1,r=o))}return e===r?r=o:r===-1&&(r=s.length),s.slice(e,r)}for(n=s.length-1;n>=0;--n)if(s.charCodeAt(n)===47){if(!i){e=n+1;break}}else r===-1&&(i=!1,r=n+1);return r===-1?"":s.slice(e,r)},extname(s){Vt(s),s=zs(this.toPosix(s));let t=-1,e=0,r=-1,i=!0,n=0;for(let a=s.length-1;a>=0;--a){const o=s.charCodeAt(a);if(o===47){if(!i){e=a+1;break}continue}r===-1&&(i=!1,r=a+1),o===46?t===-1?t=a:n!==1&&(n=1):t!==-1&&(n=-1)}return t===-1||r===-1||n===0||n===1&&t===r-1&&t===e+1?"":s.slice(t,r)},parse(s){Vt(s);const t={root:"",dir:"",base:"",ext:"",name:""};if(s.length===0)return t;s=zs(this.toPosix(s));let e=s.charCodeAt(0);const r=this.isAbsolute(s);let i;t.root=this.rootname(s),r||this.hasProtocol(s)?i=1:i=0;let n=-1,a=0,o=-1,l=!0,h=s.length-1,c=0;for(;h>=i;--h){if(e=s.charCodeAt(h),e===47){if(!l){a=h+1;break}continue}o===-1&&(l=!1,o=h+1),e===46?n===-1?n=h:c!==1&&(c=1):n!==-1&&(c=-1)}return n===-1||o===-1||c===0||c===1&&n===o-1&&n===a+1?o!==-1&&(a===0&&r?t.base=t.name=s.slice(1,o):t.base=t.name=s.slice(a,o)):(a===0&&r?(t.name=s.slice(1,n),t.base=s.slice(1,o)):(t.name=s.slice(a,n),t.base=s.slice(a,o)),t.ext=s.slice(n,o)),t.dir=this.dirname(s),t},sep:"/",delimiter:":",joinExtensions:[".html"]};function mh(s,t,e,r,i){const n=t[e];for(let a=0;a<n.length;a++){const o=n[a];e<t.length-1?mh(s.replace(r[e],o),t,e+1,r,i):i.push(s.replace(r[e],o))}}function ef(s){const t=/\{(.*?)\}/g,e=s.match(t),r=[];if(e){const i=[];e.forEach(n=>{const a=n.substring(1,n.length-1).split(",");i.push(a)}),mh(s,i,0,e,r)}else r.push(s);return r}const Yr=s=>!Array.isArray(s);class Bs{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar"))!=="bar")throw new Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(e=>{this._preferredOrder.push(e),e.priority||(e.priority=Object.keys(e.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){if(typeof t=="string")this._defaultSearchParams=t;else{const e=t;this._defaultSearchParams=Object.keys(e).map(r=>`${encodeURIComponent(r)}=${encodeURIComponent(e[r])}`).join("&")}}getAlias(t){const{alias:e,src:r}=t;return Ht(e||r,n=>typeof n=="string"?n:Array.isArray(n)?n.map(a=>a?.src??a):n?.src?n.src:n,!0)}addManifest(t){this._manifest&&q("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(e=>{this.addBundle(e.name,e.assets)})}addBundle(t,e){const r=[];let i=e;Array.isArray(e)||(i=Object.entries(e).map(([n,a])=>typeof a=="string"||Array.isArray(a)?{alias:n,src:a}:{alias:n,...a})),i.forEach(n=>{const a=n.src,o=n.alias;let l;if(typeof o=="string"){const h=this._createBundleAssetId(t,o);r.push(h),l=[o,h]}else{const h=o.map(c=>this._createBundleAssetId(t,c));r.push(...h),l=[...o,...h]}this.add({...n,alias:l,src:a})}),this._bundles[t]=r}add(t){const e=[];Array.isArray(t)?e.push(...t):e.push(t);let r;r=n=>{this.hasKey(n)&&q(`[Resolver] already has key: ${n} overwriting`)},Ht(e).forEach(n=>{const{src:a}=n;let{data:o,format:l,loadParser:h,parser:c}=n;const u=Ht(a).map(y=>typeof y=="string"?ef(y):Array.isArray(y)?y:[y]),f=this.getAlias(n);Array.isArray(f)?f.forEach(r):r(f);const d=[],p=y=>{const m=this._parsers.find(g=>g.test(y));return{src:y,...m?.parse(y)}};u.forEach(y=>{y.forEach(m=>{let g={};if(typeof m!="object"?g=p(m):(o=m.data??o,l=m.format??l,(m.loadParser||m.parser)&&(h=m.loadParser??h,c=m.parser??c),g={...p(m.src),...m}),!f)throw new Error(`[Resolver] alias is undefined for this asset: ${g.src}`);g=this._buildResolvedAsset(g,{aliases:f,data:o,format:l,loadParser:h,parser:c,progressSize:n.progressSize}),d.push(g)})}),f.forEach(y=>{this._assetMap[y]=d})})}resolveBundle(t){const e=Yr(t);t=Ht(t);const r={};return t.forEach(i=>{const n=this._bundles[i];if(n){const a=this.resolve(n),o={};for(const l in a){const h=a[l];o[this._extractAssetIdFromBundle(i,l)]=h}r[i]=o}}),e?r[t[0]]:r}resolveUrl(t){const e=this.resolve(t);if(typeof t!="string"){const r={};for(const i in e)r[i]=e[i].src;return r}return e.src}resolve(t){const e=Yr(t);t=Ht(t);const r={};return t.forEach(i=>{if(!this._resolverHash[i])if(this._assetMap[i]){let n=this._assetMap[i];const a=this._getPreferredOrder(n);a?.priority.forEach(o=>{a.params[o].forEach(l=>{const h=n.filter(c=>c[o]?c[o]===l:!1);h.length&&(n=h)})}),this._resolverHash[i]=n[0]}else this._resolverHash[i]=this._buildResolvedAsset({alias:[i],src:i},{});r[i]=this._resolverHash[i]}),e?r[t[0]]:r}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){const r=t[e],i=this._preferredOrder.find(n=>n.params.format.includes(r.format));if(i)return i}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;const e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){const{aliases:r,data:i,loadParser:n,parser:a,format:o,progressSize:l}=e;return(this._basePath||this._rootPath)&&(t.src=Tt.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=r??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...i||{},...t.data},t.loadParser=n??t.loadParser,t.parser=a??t.parser,t.format=o??t.format??sf(t.src),l!==void 0&&(t.progressSize=l),t}}Bs.RETINA_PREFIX=/@([0-9\.]+)x/;function sf(s){return s.split(".").pop().split("?").shift().split("#").shift()}const ln=(s,t)=>{const e=t.split("?")[1];return e&&(s+=`?${e}`),s},gh=class qs{constructor(t,e){this.linkedSheets=[];let r=t;t?.source instanceof Ut&&(r={texture:t,data:e});const{texture:i,data:n,cachePrefix:a=""}=r;this.cachePrefix=a,this._texture=i instanceof U?i:null,this.textureSource=i.source,this.textures={},this.animations={},this.data=n;const o=parseFloat(n.meta.scale);o?(this.resolution=o,i.source.resolution=this.resolution):this.resolution=i.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(t=>{this._callback=t,this._batchIndex=0,this._frameKeys.length<=qs.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}parseSync(){return this._processFrames(0,!0),this._processAnimations(),this.textures}_processFrames(t,e=!1){let r=t;const i=e?1/0:qs.BATCH_SIZE;for(;r-t<i&&r<this._frameKeys.length;){const n=this._frameKeys[r],a=this._frames[n],o=a.frame;if(o){let l=null,h=null;const c=a.trimmed!==!1&&a.sourceSize?a.sourceSize:a.frame,u=new ct(0,0,Math.floor(c.w)/this.resolution,Math.floor(c.h)/this.resolution);a.rotated?l=new ct(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.h)/this.resolution,Math.floor(o.w)/this.resolution):l=new ct(Math.floor(o.x)/this.resolution,Math.floor(o.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution),a.trimmed!==!1&&a.spriteSourceSize&&(h=new ct(Math.floor(a.spriteSourceSize.x)/this.resolution,Math.floor(a.spriteSourceSize.y)/this.resolution,Math.floor(o.w)/this.resolution,Math.floor(o.h)/this.resolution)),this.textures[n]=new U({source:this.textureSource,frame:l,orig:u,trim:h,rotate:a.rotated?2:0,defaultAnchor:a.anchor,defaultBorders:a.borders,label:n.toString()})}r++}}_processAnimations(){const t=this.data.animations||{};for(const e in t){this.animations[e]=[];for(let r=0;r<t[e].length;r++){const i=t[e][r];this.animations[e].push(this.textures[i])}}}_parseComplete(){const t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*qs.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*qs.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){for(const e in this.textures)this.textures[e].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};gh.BATCH_SIZE=1e3;let Na=gh;const rf=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"];function yh(s,t,e){const r={};if(s.forEach(i=>{r[i]=t}),Object.keys(t.textures).forEach(i=>{r[`${t.cachePrefix}${i}`]=t.textures[i]}),!e){const i=Tt.dirname(s[0]);t.linkedSheets.forEach((n,a)=>{const o=yh([`${i}/${t.data.meta.related_multi_packs[a]}`],n,!0);Object.assign(r,o)})}return r}const nf={extension:k.Asset,cache:{test:s=>s instanceof Na,getCacheableAssets:(s,t)=>yh(s,t,!1)},resolver:{extension:{type:k.ResolveParser,name:"resolveSpritesheet"},test:s=>{const e=s.split("?")[0].split("."),r=e.pop(),i=e.pop();return r==="json"&&rf.includes(i)},parse:s=>{const t=s.split(".");return{resolution:parseFloat(Bs.RETINA_PREFIX.exec(s)?.[1]??"1"),format:t[t.length-2],src:s}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:k.LoadParser,priority:ke.Normal,name:"spritesheetLoader"},async testParse(s,t){return Tt.extname(t.src).toLowerCase()===".json"&&!!s.frames},async parse(s,t,e){const{texture:r,imageFilename:i,textureOptions:n,cachePrefix:a}=t?.data??{};let o=Tt.dirname(t.src);o&&o.lastIndexOf("/")!==o.length-1&&(o+="/");let l;if(r instanceof U)l=r;else{const u=ln(o+(i??s.meta.image),t.src);l=(await e.load([{src:u,data:n}]))[u]}const h=new Na({texture:l.source,data:s,cachePrefix:a});await h.parse();const c=s?.meta?.related_multi_packs;if(Array.isArray(c)){const u=[];for(const d of c){if(typeof d!="string")continue;let p=o+d;t.data?.ignoreMultiPack||(p=ln(p,t.src),u.push(e.load({src:p,data:{textureOptions:n,ignoreMultiPack:!0}})))}const f=await Promise.all(u);h.linkedSheets=f,f.forEach(d=>{d.linkedSheets=[h].concat(h.linkedSheets.filter(p=>p!==d))})}return h},async unload(s,t,e){await e.unload(s.textureSource._sourceOrigin),s.destroy(!1)}}};X.add(nf);const Ci=Object.create(null),$a=Object.create(null);function Un(s,t){let e=$a[s];return e===void 0&&(Ci[t]===void 0&&(Ci[t]=1),$a[s]=e=Ci[t]++),e}let Er;function _h(){return(!Er||Er?.isContextLost())&&(Er=tt.get().createCanvas().getContext("webgl",{})),Er}let Ir;function af(){if(!Ir){Ir="mediump";const s=_h();s&&s.getShaderPrecisionFormat&&(Ir=s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision?"highp":"mediump")}return Ir}function of(s,t,e){return t?s:e?(s=s.replace("out vec4 finalColor;",""),`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in varying
        #define finalColor gl_FragColor
        #define texture texture2D
        #endif
        ${s}
        `):`

        #ifdef GL_ES // This checks if it is WebGL1
        #define in attribute
        #define out varying
        #endif
        ${s}
        `}function lf(s,t,e){const r=e?t.maxSupportedFragmentPrecision:t.maxSupportedVertexPrecision;if(s.substring(0,9)!=="precision"){let i=e?t.requestedFragmentPrecision:t.requestedVertexPrecision;return i==="highp"&&r!=="highp"&&(i="mediump"),`precision ${i} float;
${s}`}else if(r!=="highp"&&s.substring(0,15)==="precision highp")return s.replace("precision highp","precision mediump");return s}function hf(s,t){return t?`#version 300 es
${s}`:s}const cf={},uf={};function df(s,{name:t="pixi-program"},e=!0){t=t.replace(/\s+/g,"-"),t+=e?"-fragment":"-vertex";const r=e?cf:uf;return r[t]?(r[t]++,t+=`-${r[t]}`):r[t]=1,s.indexOf("#define SHADER_NAME")!==-1?s:`${`#define SHADER_NAME ${t}`}
${s}`}function ff(s,t){return t?s.replace("#version 300 es",""):s}const Pi={stripVersion:ff,ensurePrecision:lf,addProgramDefines:of,setProgramName:df,insertVersion:hf},Us=Object.create(null),xh=class hn{constructor(t){t={...hn.defaultOptions,...t};const e=t.fragment.indexOf("#version 300 es")!==-1,r={stripVersion:e,ensurePrecision:{requestedFragmentPrecision:t.preferredFragmentPrecision,requestedVertexPrecision:t.preferredVertexPrecision,maxSupportedVertexPrecision:"highp",maxSupportedFragmentPrecision:af()},setProgramName:{name:t.name},addProgramDefines:e,insertVersion:e};let i=t.fragment,n=t.vertex;Object.keys(Pi).forEach(a=>{const o=r[a];i=Pi[a](i,o,!0),n=Pi[a](n,o,!1)}),this.fragment=i,this.vertex=n,this.transformFeedbackVaryings=t.transformFeedbackVaryings,this._key=Un(`${this.vertex}:${this.fragment}`,"gl-program")}destroy(){this.fragment=null,this.vertex=null,this._attributeData=null,this._uniformData=null,this._uniformBlockData=null,this.transformFeedbackVaryings=null,Us[this._cacheKey]=null}static from(t){const e=`${t.vertex}:${t.fragment}`;return Us[e]||(Us[e]=new hn(t),Us[e]._cacheKey=e),Us[e]}};xh.defaultOptions={preferredVertexPrecision:"highp",preferredFragmentPrecision:"mediump"};let bh=xh;const Va={uint8x2:{size:2,stride:2,normalised:!1},uint8x4:{size:4,stride:4,normalised:!1},sint8x2:{size:2,stride:2,normalised:!1},sint8x4:{size:4,stride:4,normalised:!1},unorm8x2:{size:2,stride:2,normalised:!0},unorm8x4:{size:4,stride:4,normalised:!0},snorm8x2:{size:2,stride:2,normalised:!0},snorm8x4:{size:4,stride:4,normalised:!0},uint16x2:{size:2,stride:4,normalised:!1},uint16x4:{size:4,stride:8,normalised:!1},sint16x2:{size:2,stride:4,normalised:!1},sint16x4:{size:4,stride:8,normalised:!1},unorm16x2:{size:2,stride:4,normalised:!0},unorm16x4:{size:4,stride:8,normalised:!0},snorm16x2:{size:2,stride:4,normalised:!0},snorm16x4:{size:4,stride:8,normalised:!0},float16x2:{size:2,stride:4,normalised:!1},float16x4:{size:4,stride:8,normalised:!1},float32:{size:1,stride:4,normalised:!1},float32x2:{size:2,stride:8,normalised:!1},float32x3:{size:3,stride:12,normalised:!1},float32x4:{size:4,stride:16,normalised:!1},uint32:{size:1,stride:4,normalised:!1},uint32x2:{size:2,stride:8,normalised:!1},uint32x3:{size:3,stride:12,normalised:!1},uint32x4:{size:4,stride:16,normalised:!1},sint32:{size:1,stride:4,normalised:!1},sint32x2:{size:2,stride:8,normalised:!1},sint32x3:{size:3,stride:12,normalised:!1},sint32x4:{size:4,stride:16,normalised:!1}};function pf(s){return Va[s]??Va.float32}const mf={f32:"float32","vec2<f32>":"float32x2","vec3<f32>":"float32x3","vec4<f32>":"float32x4",vec2f:"float32x2",vec3f:"float32x3",vec4f:"float32x4",i32:"sint32","vec2<i32>":"sint32x2","vec3<i32>":"sint32x3","vec4<i32>":"sint32x4",vec2i:"sint32x2",vec3i:"sint32x3",vec4i:"sint32x4",u32:"uint32","vec2<u32>":"uint32x2","vec3<u32>":"uint32x3","vec4<u32>":"uint32x4",vec2u:"uint32x2",vec3u:"uint32x3",vec4u:"uint32x4",bool:"uint32","vec2<bool>":"uint32x2","vec3<bool>":"uint32x3","vec4<bool>":"uint32x4"},Wa=/@location\((\d+)\)\s+([a-zA-Z0-9_]+)\s*:\s*([a-zA-Z0-9_<>]+)(?:,|\s|\)|$)/g;function Ha(s,t){let e;for(;(e=Wa.exec(s))!==null;){const r=mf[e[3]]??"float32";t[e[2]]={location:parseInt(e[1],10),format:r,stride:pf(r).stride,offset:0,instance:!1,start:0}}Wa.lastIndex=0}function gf(s){return s.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"")}function yf({source:s,entryPoint:t}){const e={},r=gf(s),i=r.indexOf(`fn ${t}(`);if(i===-1)return e;const n=r.indexOf("->",i);if(n===-1)return e;const a=r.substring(i,n);if(Ha(a,e),Object.keys(e).length===0){const o=a.match(/\(\s*\w+\s*:\s*(\w+)/);if(o){const l=o[1],h=new RegExp(`struct\\s+${l}\\s*\\{([^}]+)\\}`,"s"),c=r.match(h);c&&Ha(c[1],e)}}return e}function Mi(s){const t=/(^|[^/])@(group|binding)\(\d+\)[^;]+;/g,e=/@group\((\d+)\)/,r=/@binding\((\d+)\)/,i=/var(<[^>]+>)? (\w+)/,n=/:\s*([\w<>]+)/,a=/struct\s+(\w+)\s*{([^}]+)}/g,o=/(\w+)\s*:\s*([\w\<\>]+)/g,l=/struct\s+(\w+)/,h=s.match(t)?.map(u=>({group:parseInt(u.match(e)[1],10),binding:parseInt(u.match(r)[1],10),name:u.match(i)[2],isUniform:u.match(i)[1]==="<uniform>",type:u.match(n)[1]}));if(!h)return{groups:[],structs:[]};const c=s.match(a)?.map(u=>{const f=u.match(l)[1],d=u.match(o).reduce((p,y)=>{const[m,g]=y.split(":");return p[m.trim()]=g.trim(),p},{});return d?{name:f,members:d}:null}).filter(({name:u})=>h.some(f=>f.type===u||f.type.includes(`<${u}>`)))??[];return{groups:h,structs:c}}var ze=(s=>(s[s.VERTEX=1]="VERTEX",s[s.FRAGMENT=2]="FRAGMENT",s[s.COMPUTE=4]="COMPUTE",s))(ze||{});function _f({groups:s}){const t=[];for(let e=0;e<s.length;e++){const r=s[e];t[r.group]||(t[r.group]=[]),r.isUniform?t[r.group].push({binding:r.binding,visibility:ze.VERTEX|ze.FRAGMENT,buffer:{type:"uniform"}}):r.type==="sampler"?t[r.group].push({binding:r.binding,visibility:ze.FRAGMENT,sampler:{type:"filtering"}}):r.type==="texture_2d"||r.type.startsWith("texture_2d<")?t[r.group].push({binding:r.binding,visibility:ze.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d",multisampled:!1}}):r.type==="texture_2d_array"||r.type.startsWith("texture_2d_array<")?t[r.group].push({binding:r.binding,visibility:ze.FRAGMENT,texture:{sampleType:"float",viewDimension:"2d-array",multisampled:!1}}):(r.type==="texture_cube"||r.type.startsWith("texture_cube<"))&&t[r.group].push({binding:r.binding,visibility:ze.FRAGMENT,texture:{sampleType:"float",viewDimension:"cube",multisampled:!1}})}for(let e=0;e<t.length;e++)t[e]||(t[e]=[]);return t}function xf({groups:s}){const t=[];for(let e=0;e<s.length;e++){const r=s[e];t[r.group]||(t[r.group]={}),t[r.group][r.name]=r.binding}return t}function bf(s,t){const e=new Set,r=new Set,i=[...s.structs,...t.structs].filter(a=>e.has(a.name)?!1:(e.add(a.name),!0)),n=[...s.groups,...t.groups].filter(a=>{const o=`${a.name}-${a.binding}`;return r.has(o)?!1:(r.add(o),!0)});return{structs:i,groups:n}}const Ns=Object.create(null);class ni{constructor(t){this._layoutKey=0,this._attributeLocationsKey=0;const{fragment:e,vertex:r,layout:i,gpuLayout:n,name:a}=t;if(this.name=a,this.fragment=e,this.vertex=r,e.source===r.source){const o=Mi(e.source);this.structsAndGroups=o}else{const o=Mi(r.source),l=Mi(e.source);this.structsAndGroups=bf(o,l)}this.layout=i??xf(this.structsAndGroups),this.gpuLayout=n??_f(this.structsAndGroups),this.autoAssignGlobalUniforms=this.layout[0]?.globalUniforms!==void 0,this.autoAssignLocalUniforms=this.layout[1]?.localUniforms!==void 0,this._generateProgramKey()}_generateProgramKey(){const{vertex:t,fragment:e}=this,r=t.source+e.source+t.entryPoint+e.entryPoint;this._layoutKey=Un(r,"program")}get attributeData(){return this._attributeData??(this._attributeData=yf(this.vertex)),this._attributeData}destroy(){this.gpuLayout=null,this.layout=null,this.structsAndGroups=null,this.fragment=null,this.vertex=null,Ns[this._cacheKey]=null}static from(t){const e=`${t.vertex.source}:${t.fragment.source}:${t.fragment.entryPoint}:${t.vertex.entryPoint}`;return Ns[e]||(Ns[e]=new ni(t),Ns[e]._cacheKey=e),Ns[e]}}const vh=["f32","i32","vec2<f32>","vec3<f32>","vec4<f32>","mat2x2<f32>","mat3x3<f32>","mat4x4<f32>","mat3x2<f32>","mat4x2<f32>","mat2x3<f32>","mat4x3<f32>","mat2x4<f32>","mat3x4<f32>","vec2<i32>","vec3<i32>","vec4<i32>"],vf=vh.reduce((s,t)=>(s[t]=!0,s),{});function wf(s,t){switch(s){case"f32":return 0;case"vec2<f32>":return new Float32Array(2*t);case"vec3<f32>":return new Float32Array(3*t);case"vec4<f32>":return new Float32Array(4*t);case"mat2x2<f32>":return new Float32Array([1,0,0,1]);case"mat3x3<f32>":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4x4<f32>":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}const wh=class Ah{constructor(t,e){this._touched=0,this.uid=J("uniform"),this._resourceType="uniformGroup",this._resourceId=J("resource"),this.isUniformGroup=!0,this._dirtyId=0,this.destroyed=!1,e={...Ah.defaultOptions,...e},this.uniformStructures=t;const r={};for(const i in t){const n=t[i];if(n.name=i,n.size=n.size??1,!vf[n.type]){const a=n.type.match(/^array<(\w+(?:<\w+>)?),\s*(\d+)>$/);if(a){const[,o,l]=a;throw new Error(`Uniform type ${n.type} is not supported. Use type: '${o}', size: ${l} instead.`)}throw new Error(`Uniform type ${n.type} is not supported. Supported uniform types are: ${vh.join(", ")}`)}n.value??(n.value=wf(n.type,n.size)),r[i]=n.value}this.uniforms=r,this._dirtyId=1,this.ubo=e.ubo,this.isStatic=e.isStatic,this._signature=Un(Object.keys(r).map(i=>`${i}-${t[i].type}`).join("-"),"uniform-group")}update(){this._dirtyId++}};wh.defaultOptions={ubo:!1,isStatic:!1};let Sh=wh;class Nr{constructor(t){this.resources=Object.create(null),this._dirty=!0;let e=0;for(const r in t){const i=t[r];this.setResource(i,e++)}this._updateKey()}_updateKey(){if(!this._dirty)return;this._dirty=!1;const t=[];let e=0;for(const r in this.resources)t[e++]=this.resources[r]._resourceId;this._key=t.join("|")}setResource(t,e){const r=this.resources[e];t!==r&&(r&&t.off?.("change",this.onResourceChange,this),t.on?.("change",this.onResourceChange,this),this.resources[e]=t,this._dirty=!0)}getResource(t){return this.resources[t]}_touch(t,e){const r=this.resources;for(const i in r)r[i]._gcLastUsed=t,r[i]._touched=e}destroy(){const t=this.resources;for(const e in t)t[e]?.off?.("change",this.onResourceChange,this);this.resources=null}onResourceChange(t){if(this._dirty=!0,t.destroyed){const e=this.resources;for(const r in e)e[r]===t&&(e[r]=null)}else this._updateKey()}}var cn=(s=>(s[s.WEBGL=1]="WEBGL",s[s.WEBGPU=2]="WEBGPU",s[s.CANVAS=4]="CANVAS",s[s.BOTH=3]="BOTH",s))(cn||{});class Nn extends pe{constructor(t){super(),this.uid=J("shader"),this._uniformBindMap=Object.create(null),this._ownedBindGroups=[],this._destroyed=!1;let{gpuProgram:e,glProgram:r,groups:i,resources:n,compatibleRenderers:a,groupMap:o}=t;this.gpuProgram=e,this.glProgram=r,a===void 0&&(a=0,e&&(a|=cn.WEBGPU),r&&(a|=cn.WEBGL)),this.compatibleRenderers=a;const l={};if(!n&&!i&&(n={}),n&&i)throw new Error("[Shader] Cannot have both resources and groups");if(!e&&i&&!o)throw new Error("[Shader] No group map or WebGPU shader provided - consider using resources instead.");if(!e&&i&&o)for(const h in o)for(const c in o[h]){const u=o[h][c];l[u]={group:h,binding:c,name:u}}else if(e&&i&&!o){const h=e.structsAndGroups.groups;o={},h.forEach(c=>{o[c.group]=o[c.group]||{},o[c.group][c.binding]=c.name,l[c.name]=c})}else if(n){i={},o={},e&&e.structsAndGroups.groups.forEach(u=>{o[u.group]=o[u.group]||{},o[u.group][u.binding]=u.name,l[u.name]=u});let h=0;for(const c in n)l[c]||(i[99]||(i[99]=new Nr,this._ownedBindGroups.push(i[99])),l[c]={group:99,binding:h,name:c},o[99]=o[99]||{},o[99][h]=c,h++);for(const c in n){const u=c;let f=n[c];!f.source&&!f._resourceType&&(f=new Sh(f));const d=l[u];d&&(i[d.group]||(i[d.group]=new Nr,this._ownedBindGroups.push(i[d.group])),i[d.group].setResource(f,d.binding))}}this.groups=i,this._uniformBindMap=o,this.resources=this._buildResourceAccessor(i,l)}addResource(t,e,r){var i,n;(i=this._uniformBindMap)[e]||(i[e]={}),(n=this._uniformBindMap[e])[r]||(n[r]=t),this.groups[e]||(this.groups[e]=new Nr,this._ownedBindGroups.push(this.groups[e]))}_buildResourceAccessor(t,e){const r={};for(const i in e){const n=e[i];Object.defineProperty(r,n.name,{get(){return t[n.group].getResource(n.binding)},set(a){t[n.group].setResource(a,n.binding)}})}return r}destroy(t=!1){this._destroyed||(this._destroyed=!0,this.emit("destroy",this),t&&(this.gpuProgram?.destroy(),this.glProgram?.destroy()),this.gpuProgram=null,this.glProgram=null,this.removeAllListeners(),this._uniformBindMap=null,this._ownedBindGroups.forEach(e=>{e.destroy()}),this._ownedBindGroups=null,this.resources=null,this.groups=null)}static from(t){const{gpu:e,gl:r,...i}=t;let n,a;return e&&(n=ni.from(e)),r&&(a=bh.from(r)),new Nn({gpuProgram:n,glProgram:a,...i})}}const Af={normal:0,add:1,multiply:2,screen:3,overlay:4,erase:5,"normal-npm":6,"add-npm":7,"screen-npm":8,min:9,max:10},Ti=0,ki=1,Ei=2,Ii=3,Ri=4,Bi=5,un=class Ch{constructor(){this.data=0,this.blendMode="normal",this.polygonOffset=0,this.blend=!0,this.depthMask=!0}get blend(){return!!(this.data&1<<Ti)}set blend(t){!!(this.data&1<<Ti)!==t&&(this.data^=1<<Ti)}get offsets(){return!!(this.data&1<<ki)}set offsets(t){!!(this.data&1<<ki)!==t&&(this.data^=1<<ki)}set cullMode(t){if(t==="none"){this.culling=!1;return}this.culling=!0,this.clockwiseFrontFace=t==="front"}get cullMode(){return this.culling?this.clockwiseFrontFace?"front":"back":"none"}get culling(){return!!(this.data&1<<Ei)}set culling(t){!!(this.data&1<<Ei)!==t&&(this.data^=1<<Ei)}get depthTest(){return!!(this.data&1<<Ii)}set depthTest(t){!!(this.data&1<<Ii)!==t&&(this.data^=1<<Ii)}get depthMask(){return!!(this.data&1<<Bi)}set depthMask(t){!!(this.data&1<<Bi)!==t&&(this.data^=1<<Bi)}get clockwiseFrontFace(){return!!(this.data&1<<Ri)}set clockwiseFrontFace(t){!!(this.data&1<<Ri)!==t&&(this.data^=1<<Ri)}get blendMode(){return this._blendMode}set blendMode(t){this.blend=t!=="none",this._blendMode=t,this._blendModeId=Af[t]||0}get polygonOffset(){return this._polygonOffset}set polygonOffset(t){this.offsets=!!t,this._polygonOffset=t}toString(){return`[pixi.js/core:State blendMode=${this.blendMode} clockwiseFrontFace=${this.clockwiseFrontFace} culling=${this.culling} depthMask=${this.depthMask} polygonOffset=${this.polygonOffset}]`}static for2d(){const t=new Ch;return t.depthTest=!1,t.blend=!0,t}};un.default2d=un.for2d();let Ph=un;const dn=[];X.handleByNamedList(k.Environment,dn);async function Sf(s){if(!s)for(let t=0;t<dn.length;t++){const e=dn[t];if(e.value.test()){await e.value.load();return}}}let $s;function Cf(){if(typeof $s=="boolean")return $s;try{$s=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{$s=!1}return $s}function ja(s,t,e=2){const r=t&&t.length,i=r?t[0]*e:s.length;let n=Mh(s,0,i,e,!0);const a=[];if(!n||n.next===n.prev)return a;let o,l,h;if(r&&(n=Ef(s,t,n,e)),s.length>80*e){o=s[0],l=s[1];let c=o,u=l;for(let f=e;f<i;f+=e){const d=s[f],p=s[f+1];d<o&&(o=d),p<l&&(l=p),d>c&&(c=d),p>u&&(u=p)}h=Math.max(c-o,u-l),h=h!==0?32767/h:0}return hr(n,a,e,o,l,h,0),a}function Mh(s,t,e,r,i){let n;if(i===Nf(s,t,e,r)>0)for(let a=t;a<e;a+=r)n=Xa(a/r|0,s[a],s[a+1],n);else for(let a=e-r;a>=t;a-=r)n=Xa(a/r|0,s[a],s[a+1],n);return n&&ws(n,n.next)&&(ur(n),n=n.next),n}function Qe(s,t){if(!s)return s;t||(t=s);let e=s,r;do if(r=!1,!e.steiner&&(ws(e,e.next)||j(e.prev,e,e.next)===0)){if(ur(e),e=t=e.prev,e===e.next)break;r=!0}else e=e.next;while(r||e!==t);return t}function hr(s,t,e,r,i,n,a){if(!s)return;!a&&n&&Gf(s,r,i,n);let o=s;for(;s.prev!==s.next;){const l=s.prev,h=s.next;if(n?Mf(s,r,i,n):Pf(s)){t.push(l.i,s.i,h.i),ur(s),s=h.next,o=h.next;continue}if(s=h,s===o){a?a===1?(s=Tf(Qe(s),t),hr(s,t,e,r,i,n,2)):a===2&&kf(s,t,e,r,i,n):hr(Qe(s),t,e,r,i,n,1);break}}}function Pf(s){const t=s.prev,e=s,r=s.next;if(j(t,e,r)>=0)return!1;const i=t.x,n=e.x,a=r.x,o=t.y,l=e.y,h=r.y,c=Math.min(i,n,a),u=Math.min(o,l,h),f=Math.max(i,n,a),d=Math.max(o,l,h);let p=r.next;for(;p!==t;){if(p.x>=c&&p.x<=f&&p.y>=u&&p.y<=d&&Ks(i,o,n,l,a,h,p.x,p.y)&&j(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Mf(s,t,e,r){const i=s.prev,n=s,a=s.next;if(j(i,n,a)>=0)return!1;const o=i.x,l=n.x,h=a.x,c=i.y,u=n.y,f=a.y,d=Math.min(o,l,h),p=Math.min(c,u,f),y=Math.max(o,l,h),m=Math.max(c,u,f),g=fn(d,p,t,e,r),x=fn(y,m,t,e,r);let _=s.prevZ,b=s.nextZ;for(;_&&_.z>=g&&b&&b.z<=x;){if(_.x>=d&&_.x<=y&&_.y>=p&&_.y<=m&&_!==i&&_!==a&&Ks(o,c,l,u,h,f,_.x,_.y)&&j(_.prev,_,_.next)>=0||(_=_.prevZ,b.x>=d&&b.x<=y&&b.y>=p&&b.y<=m&&b!==i&&b!==a&&Ks(o,c,l,u,h,f,b.x,b.y)&&j(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;_&&_.z>=g;){if(_.x>=d&&_.x<=y&&_.y>=p&&_.y<=m&&_!==i&&_!==a&&Ks(o,c,l,u,h,f,_.x,_.y)&&j(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=x;){if(b.x>=d&&b.x<=y&&b.y>=p&&b.y<=m&&b!==i&&b!==a&&Ks(o,c,l,u,h,f,b.x,b.y)&&j(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function Tf(s,t){let e=s;do{const r=e.prev,i=e.next.next;!ws(r,i)&&kh(r,e,e.next,i)&&cr(r,i)&&cr(i,r)&&(t.push(r.i,e.i,i.i),ur(e),ur(e.next),e=s=i),e=e.next}while(e!==s);return Qe(e)}function kf(s,t,e,r,i,n){let a=s;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&Of(a,o)){let l=Eh(a,o);a=Qe(a,a.next),l=Qe(l,l.next),hr(a,t,e,r,i,n,0),hr(l,t,e,r,i,n,0);return}o=o.next}a=a.next}while(a!==s)}function Ef(s,t,e,r){const i=[];for(let n=0,a=t.length;n<a;n++){const o=t[n]*r,l=n<a-1?t[n+1]*r:s.length,h=Mh(s,o,l,r,!1);h===h.next&&(h.steiner=!0),i.push(Df(h))}i.sort(If);for(let n=0;n<i.length;n++)e=Rf(i[n],e);return e}function If(s,t){let e=s.x-t.x;if(e===0&&(e=s.y-t.y,e===0)){const r=(s.next.y-s.y)/(s.next.x-s.x),i=(t.next.y-t.y)/(t.next.x-t.x);e=r-i}return e}function Rf(s,t){const e=Bf(s,t);if(!e)return t;const r=Eh(e,s);return Qe(r,r.next),Qe(e,e.next)}function Bf(s,t){let e=t;const r=s.x,i=s.y;let n=-1/0,a;if(ws(s,e))return e;do{if(ws(s,e.next))return e.next;if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){const u=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(u<=r&&u>n&&(n=u,a=e.x<e.next.x?e:e.next,u===r))return a}e=e.next}while(e!==t);if(!a)return null;const o=a,l=a.x,h=a.y;let c=1/0;e=a;do{if(r>=e.x&&e.x>=l&&r!==e.x&&Th(i<h?r:n,i,l,h,i<h?n:r,i,e.x,e.y)){const u=Math.abs(i-e.y)/(r-e.x);cr(e,s)&&(u<c||u===c&&(e.x>a.x||e.x===a.x&&Ff(a,e)))&&(a=e,c=u)}e=e.next}while(e!==o);return a}function Ff(s,t){return j(s.prev,s,t.prev)<0&&j(t.next,s,s.next)<0}function Gf(s,t,e,r){let i=s;do i.z===0&&(i.z=fn(i.x,i.y,t,e,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==s);i.prevZ.nextZ=null,i.prevZ=null,Lf(i)}function Lf(s){let t,e=1;do{let r=s,i;s=null;let n=null;for(t=0;r;){t++;let a=r,o=0;for(let h=0;h<e&&(o++,a=a.nextZ,!!a);h++);let l=e;for(;o>0||l>0&&a;)o!==0&&(l===0||!a||r.z<=a.z)?(i=r,r=r.nextZ,o--):(i=a,a=a.nextZ,l--),n?n.nextZ=i:s=i,i.prevZ=n,n=i;r=a}n.nextZ=null,e*=2}while(t>1);return s}function fn(s,t,e,r,i){return s=(s-e)*i|0,t=(t-r)*i|0,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,s|t<<1}function Df(s){let t=s,e=s;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==s);return e}function Th(s,t,e,r,i,n,a,o){return(i-a)*(t-o)>=(s-a)*(n-o)&&(s-a)*(r-o)>=(e-a)*(t-o)&&(e-a)*(n-o)>=(i-a)*(r-o)}function Ks(s,t,e,r,i,n,a,o){return!(s===a&&t===o)&&Th(s,t,e,r,i,n,a,o)}function Of(s,t){return s.next.i!==t.i&&s.prev.i!==t.i&&!zf(s,t)&&(cr(s,t)&&cr(t,s)&&Uf(s,t)&&(j(s.prev,s,t.prev)||j(s,t.prev,t))||ws(s,t)&&j(s.prev,s,s.next)>0&&j(t.prev,t,t.next)>0)}function j(s,t,e){return(t.y-s.y)*(e.x-t.x)-(t.x-s.x)*(e.y-t.y)}function ws(s,t){return s.x===t.x&&s.y===t.y}function kh(s,t,e,r){const i=Br(j(s,t,e)),n=Br(j(s,t,r)),a=Br(j(e,r,s)),o=Br(j(e,r,t));return!!(i!==n&&a!==o||i===0&&Rr(s,e,t)||n===0&&Rr(s,r,t)||a===0&&Rr(e,s,r)||o===0&&Rr(e,t,r))}function Rr(s,t,e){return t.x<=Math.max(s.x,e.x)&&t.x>=Math.min(s.x,e.x)&&t.y<=Math.max(s.y,e.y)&&t.y>=Math.min(s.y,e.y)}function Br(s){return s>0?1:s<0?-1:0}function zf(s,t){let e=s;do{if(e.i!==s.i&&e.next.i!==s.i&&e.i!==t.i&&e.next.i!==t.i&&kh(e,e.next,s,t))return!0;e=e.next}while(e!==s);return!1}function cr(s,t){return j(s.prev,s,s.next)<0?j(s,t,s.next)>=0&&j(s,s.prev,t)>=0:j(s,t,s.prev)<0||j(s,s.next,t)<0}function Uf(s,t){let e=s,r=!1;const i=(s.x+t.x)/2,n=(s.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&i<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(r=!r),e=e.next;while(e!==s);return r}function Eh(s,t){const e=pn(s.i,s.x,s.y),r=pn(t.i,t.x,t.y),i=s.next,n=t.prev;return s.next=t,t.prev=s,e.next=i,i.prev=e,r.next=e,e.prev=r,n.next=r,r.prev=n,r}function Xa(s,t,e,r){const i=pn(s,t,e);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function ur(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function pn(s,t,e){return{i:s,x:t,y:e,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function Nf(s,t,e,r){let i=0;for(let n=t,a=e-r;n<e;n+=r)i+=(s[a]-s[n])*(s[n+1]+s[a+1]),a=n;return i}const $f=ja.default||ja;var Ih=(s=>(s[s.NONE=0]="NONE",s[s.COLOR=16384]="COLOR",s[s.STENCIL=1024]="STENCIL",s[s.DEPTH=256]="DEPTH",s[s.COLOR_DEPTH=16640]="COLOR_DEPTH",s[s.COLOR_STENCIL=17408]="COLOR_STENCIL",s[s.DEPTH_STENCIL=1280]="DEPTH_STENCIL",s[s.ALL=17664]="ALL",s))(Ih||{});class Vf{constructor(t){this.items=[],this._name=t}emit(t,e,r,i,n,a,o,l){const{name:h,items:c}=this;for(let u=0,f=c.length;u<f;u++)c[u][h](t,e,r,i,n,a,o,l);return this}add(t){return t[this._name]&&(this.remove(t),this.items.push(t)),this}remove(t){const e=this.items.indexOf(t);return e!==-1&&this.items.splice(e,1),this}contains(t){return this.items.indexOf(t)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const Wf=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],Rh=class Bh extends pe{constructor(t){super(),this.tick=0,this.uid=J("renderer"),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=t.type,this.name=t.name,this.config=t;const e=[...Wf,...this.config.runners??[]];this._addRunners(...e),this._unsafeEvalCheck()}async init(t={}){const e=t.skipExtensionImports===!0?!0:t.manageImports===!1;await Sf(e),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const r in this._systemsHash)t={...this._systemsHash[r].constructor.defaultOptions,...t};t={...Bh.defaultOptions,...t},this._roundPixels=t.roundPixels?1:0;for(let r=0;r<this.runners.init.items.length;r++)await this.runners.init.items[r].init(t);this._initOptions=t}render(t,e){this.tick++;let r=t;if(r instanceof ue&&(r={container:r},e&&(V(rt,"passing a second argument is deprecated, please use render options instead"),r.target=e.renderTexture)),r.target||(r.target=this.view.renderTarget),r.target===this.view.renderTarget&&(this._lastObjectRendered=r.container,r.clearColor??(r.clearColor=this.background.colorRgba),r.clear??(r.clear=this.background.clearBeforeRender)),r.clearColor){const i=Array.isArray(r.clearColor)&&r.clearColor.length===4;r.clearColor=i?r.clearColor:Lt.shared.setValue(r.clearColor).toArray()}r.transform||(r.container.updateLocalTransform(),r.transform=r.container.localTransform),r.container.visible&&(r.container.enableRenderGroup(),this.runners.prerender.emit(r),this.runners.renderStart.emit(r),this.runners.render.emit(r),this.runners.renderEnd.emit(r),this.runners.postrender.emit(r))}resize(t,e,r){const i=this.view.resolution;this.view.resize(t,e,r),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),r!==void 0&&r!==i&&this.runners.resolutionChange.emit(r)}clear(t={}){const e=this;t.target||(t.target=e.renderTarget.renderTarget),t.clearColor||(t.clearColor=this.background.colorRgba),t.clear??(t.clear=Ih.ALL);const{clear:r,clearColor:i,target:n,mipLevel:a,layer:o}=t;Lt.shared.setValue(i??this.background.colorRgba),e.renderTarget.clear(n,r,Lt.shared.toArray(),a??0,o??0)}get resolution(){return this.view.resolution}set resolution(t){this.view.resolution=t,this.runners.resolutionChange.emit(t)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...t){t.forEach(e=>{this.runners[e]=new Vf(e)})}_addSystems(t){let e;for(e in t){const r=t[e];this._addSystem(r.value,r.name)}}_addSystem(t,e){const r=new t(this);if(this[e])throw new Error(`Whoops! The name "${e}" is already in use`);this[e]=r,this._systemsHash[e]=r;for(const i in this.runners)this.runners[i].add(r);return this}_addPipes(t,e){const r=e.reduce((i,n)=>(i[n.name]=n.value,i),{});t.forEach(i=>{const n=i.value,a=i.name,o=r[a];this.renderPipes[a]=new n(this,o?new o:null),this.runners.destroy.add(this.renderPipes[a])})}destroy(t=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(t),(t===!0||typeof t=="object"&&t.releaseGlobalResources)&&ri.release(),Object.values(this.runners).forEach(e=>{e.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(t){return this.textureGenerator.generateTexture(t)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!Cf())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};Rh.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Fh=Rh,Fr;function Hf(s){return Fr!==void 0||(Fr=(()=>{const t={stencil:!0,failIfMajorPerformanceCaveat:s??Fh.defaultOptions.failIfMajorPerformanceCaveat};try{if(!tt.get().getWebGLRenderingContext())return!1;let r=tt.get().createCanvas().getContext("webgl",t);const i=!!r?.getContextAttributes()?.stencil;if(r){const n=r.getExtension("WEBGL_lose_context");n&&n.loseContext()}return r=null,i}catch{return!1}})()),Fr}let Gr;async function jf(s={}){return Gr!==void 0||(Gr=await(async()=>{const t=tt.get().getNavigator().gpu;if(!t)return!1;try{return await(await t.requestAdapter(s)).requestDevice(),!0}catch{return!1}})()),Gr}const Ya=["webgl","webgpu","canvas"];async function Xf(s){let t=[];s.preference?(t.push(s.preference),Ya.forEach(n=>{n!==s.preference&&t.push(n)})):t=Ya.slice();let e,r={};for(let n=0;n<t.length;n++){const a=t[n];if(a==="webgpu"&&await jf()){const{WebGPURenderer:o}=await ds(async()=>{const{WebGPURenderer:l}=await import("./WebGPURenderer-CwNZDwNR.js");return{WebGPURenderer:l}},__vite__mapDeps([3,4,5,2,6]));e=o,r={...s,...s.webgpu};break}else if(a==="webgl"&&Hf(s.failIfMajorPerformanceCaveat??Fh.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:o}=await ds(async()=>{const{WebGLRenderer:l}=await import("./WebGLRenderer-BtnqX3ch.js");return{WebGLRenderer:l}},__vite__mapDeps([7,4,5,2]));e=o,r={...s,...s.webgl};break}else if(a==="canvas"){const{CanvasRenderer:o}=await ds(async()=>{const{CanvasRenderer:l}=await import("./CanvasRenderer-BIUS979K.js");return{CanvasRenderer:l}},__vite__mapDeps([8,5,2]));e=o,r={...s,...s.canvasOptions};break}}if(delete r.webgpu,delete r.webgl,delete r.canvasOptions,!e)throw new Error("No available renderer for the current environment");const i=new e;return await i.init(r),i}const Gh="8.16.0";class Lh{static init(){globalThis.__PIXI_APP_INIT__?.(this,Gh)}static destroy(){}}Lh.extension=k.Application;class Yf{constructor(t){this._renderer=t}init(){globalThis.__PIXI_RENDERER_INIT__?.(this._renderer,Gh)}destroy(){this._renderer=null}}Yf.extension={type:[k.WebGLSystem,k.WebGPUSystem],name:"initHook",priority:-10};class Dh{static init(t){Object.defineProperty(this,"resizeTo",{configurable:!0,set(e){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=e,e&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{if(!this._resizeTo)return;this._cancelResize();let e,r;if(this._resizeTo===globalThis.window)e=globalThis.innerWidth,r=globalThis.innerHeight;else{const{clientWidth:i,clientHeight:n}=this._resizeTo;e=i,r=n}this.renderer.resize(e,r),this.render()},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}Dh.extension=k.Application;class Oh{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{configurable:!0,set(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Xr.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?cs.shared:new cs,t.autoStart&&this.start()}static destroy(){if(this._ticker){const t=this._ticker;this.ticker=null,t.destroy()}}}Oh.extension=k.Application;X.add(Dh);X.add(Oh);const zh=class mn{constructor(...t){this.stage=new ue,t[0]!==void 0&&V(rt,"Application constructor options are deprecated, please use Application.init() instead.")}async init(t){t={...t},this.stage||(this.stage=new ue),this.renderer=await Xf(t),mn._plugins.forEach(e=>{e.init.call(this,t)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return V(rt,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(t=!1,e=!1){const r=mn._plugins.slice(0);r.reverse(),r.forEach(i=>{i.destroy.call(this)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null}};zh._plugins=[];let Uh=zh;X.handleByList(k.Application,Uh._plugins);X.add(Lh);const Fi={test(s){return typeof s=="string"&&s.startsWith("info face=")},parse(s){const t=s.match(/^[a-z]+\s+.+$/gm),e={info:[],common:[],page:[],char:[],chars:[],kerning:[],kernings:[],distanceField:[]};for(const u in t){const f=t[u].match(/^[a-z]+/gm)[0],d=t[u].match(/[a-zA-Z]+=([^\s"']+|"([^"]*)")/gm),p={};for(const y in d){const m=d[y].split("="),g=m[0],x=m[1].replace(/"/gm,""),_=parseFloat(x),b=isNaN(_)?x:_;p[g]=b}e[f].push(p)}const r={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},[i]=e.info,[n]=e.common,[a]=e.distanceField??[];a&&(r.distanceField={range:parseInt(a.distanceRange,10),type:a.fieldType}),r.fontSize=parseInt(i.size,10),r.fontFamily=i.face,r.lineHeight=parseInt(n.lineHeight,10);const o=e.page;for(let u=0;u<o.length;u++)r.pages.push({id:parseInt(o[u].id,10)||0,file:o[u].file});const l={};r.baseLineOffset=r.lineHeight-parseInt(n.base,10);const h=e.char;for(let u=0;u<h.length;u++){const f=h[u],d=parseInt(f.id,10);let p=f.letter??f.char??String.fromCharCode(d);p==="space"&&(p=" "),l[d]=p,r.chars[p]={id:d,page:parseInt(f.page,10)||0,x:parseInt(f.x,10),y:parseInt(f.y,10),width:parseInt(f.width,10),height:parseInt(f.height,10),xOffset:parseInt(f.xoffset,10),yOffset:parseInt(f.yoffset,10),xAdvance:parseInt(f.xadvance,10),kerning:{}}}const c=e.kerning||[];for(let u=0;u<c.length;u++){const f=parseInt(c[u].first,10),d=parseInt(c[u].second,10),p=parseInt(c[u].amount,10);r.chars[l[d]].kerning[l[f]]=p}return r}},qa={test(s){const t=s;return typeof t!="string"&&"getElementsByTagName"in t&&t.getElementsByTagName("page").length&&t.getElementsByTagName("info")[0].getAttribute("face")!==null},parse(s){const t={chars:{},pages:[],lineHeight:0,fontSize:0,fontFamily:"",distanceField:null,baseLineOffset:0},e=s.getElementsByTagName("info")[0],r=s.getElementsByTagName("common")[0],i=s.getElementsByTagName("distanceField")[0];i&&(t.distanceField={type:i.getAttribute("fieldType"),range:parseInt(i.getAttribute("distanceRange"),10)});const n=s.getElementsByTagName("page"),a=s.getElementsByTagName("char"),o=s.getElementsByTagName("kerning");t.fontSize=parseInt(e.getAttribute("size"),10),t.fontFamily=e.getAttribute("face"),t.lineHeight=parseInt(r.getAttribute("lineHeight"),10);for(let h=0;h<n.length;h++)t.pages.push({id:parseInt(n[h].getAttribute("id"),10)||0,file:n[h].getAttribute("file")});const l={};t.baseLineOffset=t.lineHeight-parseInt(r.getAttribute("base"),10);for(let h=0;h<a.length;h++){const c=a[h],u=parseInt(c.getAttribute("id"),10);let f=c.getAttribute("letter")??c.getAttribute("char")??String.fromCharCode(u);f==="space"&&(f=" "),l[u]=f,t.chars[f]={id:u,page:parseInt(c.getAttribute("page"),10)||0,x:parseInt(c.getAttribute("x"),10),y:parseInt(c.getAttribute("y"),10),width:parseInt(c.getAttribute("width"),10),height:parseInt(c.getAttribute("height"),10),xOffset:parseInt(c.getAttribute("xoffset"),10),yOffset:parseInt(c.getAttribute("yoffset"),10),xAdvance:parseInt(c.getAttribute("xadvance"),10),kerning:{}}}for(let h=0;h<o.length;h++){const c=parseInt(o[h].getAttribute("first"),10),u=parseInt(o[h].getAttribute("second"),10),f=parseInt(o[h].getAttribute("amount"),10);t.chars[l[u]].kerning[l[c]]=f}return t}},Ka={test(s){return typeof s=="string"&&s.match(/<font(\s|>)/)?qa.test(tt.get().parseXML(s)):!1},parse(s){return qa.parse(tt.get().parseXML(s))}},qf=[".xml",".fnt"],Kf={extension:{type:k.CacheParser,name:"cacheBitmapFont"},test:s=>!!s?.pages&&!!s?.chars&&typeof s?.fontFamily=="string",getCacheableAssets(s,t){const e={};return s.forEach(r=>{e[r]=t,e[`${r}-bitmap`]=t}),e[`${t.fontFamily}-bitmap`]=t,e}},Zf={extension:{type:k.LoadParser,priority:ke.Normal},name:"loadBitmapFont",id:"bitmap-font",test(s){return qf.includes(Tt.extname(s).toLowerCase())},async testParse(s){return Fi.test(s)||Ka.test(s)},async parse(s,t,e){const r=Fi.test(s)?Fi.parse(s):Ka.parse(s),{src:i}=t,{pages:n}=r,a=[],o=r.distanceField?{scaleMode:"linear",alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:!1,resolution:1}:{};for(let f=0;f<n.length;++f){const d=n[f].file;let p=Tt.join(Tt.dirname(i),d);p=ln(p,i),a.push({src:p,data:o})}const[l,{BitmapFont:h}]=await Promise.all([e.load(a),ds(()=>import("./BitmapFont-B46MHoBj.js"),__vite__mapDeps([9,6]))]),c=a.map(f=>l[f.src]);return new h({data:r,textures:c},i)},async load(s,t){return await(await tt.get().fetch(s)).text()},async unload(s,t,e){await Promise.all(s.pages.map(r=>e.unload(r.texture.source._sourceOrigin))),s.destroy()}};class Qf{constructor(t,e=!1){this._loader=t,this._assetList=[],this._isLoading=!1,this._maxConcurrent=1,this.verbose=e}add(t){t.forEach(e=>{this._assetList.push(e)}),this.verbose&&console.log("[BackgroundLoader] assets: ",this._assetList),this._isActive&&!this._isLoading&&this._next()}async _next(){if(this._assetList.length&&this._isActive){this._isLoading=!0;const t=[],e=Math.min(this._assetList.length,this._maxConcurrent);for(let r=0;r<e;r++)t.push(this._assetList.pop());await this._loader.load(t),this._isLoading=!1,this._next()}}get active(){return this._isActive}set active(t){this._isActive!==t&&(this._isActive=t,t&&!this._isLoading&&this._next())}}const Jf={extension:{type:k.CacheParser,name:"cacheTextureArray"},test:s=>Array.isArray(s)&&s.every(t=>t instanceof U),getCacheableAssets:(s,t)=>{const e={};return s.forEach(r=>{t.forEach((i,n)=>{e[r+(n===0?"":n+1)]=i})}),e}};async function Nh(s){if("Image"in globalThis)return new Promise(t=>{const e=new Image;e.onload=()=>{t(!0)},e.onerror=()=>{t(!1)},e.src=s});if("createImageBitmap"in globalThis&&"fetch"in globalThis){try{const t=await(await fetch(s)).blob();await createImageBitmap(t)}catch{return!1}return!0}return!1}const tp={extension:{type:k.DetectionParser,priority:1},test:async()=>Nh("data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAAB0AAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAIAAAACAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQ0MAAAAABNjb2xybmNseAACAAIAAYAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAACVtZGF0EgAKCBgANogQEAwgMg8f8D///8WfhwB8+ErK42A="),add:async s=>[...s,"avif"],remove:async s=>s.filter(t=>t!=="avif")},Za=["png","jpg","jpeg"],ep={extension:{type:k.DetectionParser,priority:-1},test:()=>Promise.resolve(!0),add:async s=>[...s,...Za],remove:async s=>s.filter(t=>!Za.includes(t))},sp="WorkerGlobalScope"in globalThis&&globalThis instanceof globalThis.WorkerGlobalScope;function ai(s){return sp?!1:document.createElement("video").canPlayType(s)!==""}const rp={extension:{type:k.DetectionParser,priority:0},test:async()=>ai("video/mp4"),add:async s=>[...s,"mp4","m4v"],remove:async s=>s.filter(t=>t!=="mp4"&&t!=="m4v")},ip={extension:{type:k.DetectionParser,priority:0},test:async()=>ai("video/ogg"),add:async s=>[...s,"ogv"],remove:async s=>s.filter(t=>t!=="ogv")},np={extension:{type:k.DetectionParser,priority:0},test:async()=>ai("video/webm"),add:async s=>[...s,"webm"],remove:async s=>s.filter(t=>t!=="webm")},ap={extension:{type:k.DetectionParser,priority:0},test:async()=>Nh("data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA="),add:async s=>[...s,"webp"],remove:async s=>s.filter(t=>t!=="webp")},$h=class $r{constructor(){this.loadOptions={...$r.defaultOptions},this._parsers=[],this._parsersValidated=!1,this.parsers=new Proxy(this._parsers,{set:(t,e,r)=>(this._parsersValidated=!1,t[e]=r,!0)}),this.promiseCache={}}reset(){this._parsersValidated=!1,this.promiseCache={}}_getLoadPromiseAndParser(t,e){const r={promise:null,parser:null};return r.promise=(async()=>{let i=null,n=null;if((e.parser||e.loadParser)&&(n=this._parserHash[e.parser||e.loadParser],e.loadParser&&q(`[Assets] "loadParser" is deprecated, use "parser" instead for ${t}`),n||q(`[Assets] specified load parser "${e.parser||e.loadParser}" not found while loading ${t}`)),!n){for(let a=0;a<this.parsers.length;a++){const o=this.parsers[a];if(o.load&&o.test?.(t,e,this)){n=o;break}}if(!n)return q(`[Assets] ${t} could not be loaded as we don't know how to parse it, ensure the correct parser has been added`),null}i=await n.load(t,e,this),r.parser=n;for(let a=0;a<this.parsers.length;a++){const o=this.parsers[a];o.parse&&o.parse&&await o.testParse?.(i,e,this)&&(i=await o.parse(i,e,this)||i,r.parser=o)}return i})(),r}async load(t,e){this._parsersValidated||this._validateParsers();const r=typeof e=="function"?{...$r.defaultOptions,...this.loadOptions,onProgress:e}:{...$r.defaultOptions,...this.loadOptions,...e||{}},{onProgress:i,onError:n,strategy:a,retryCount:o,retryDelay:l}=r;let h=0;const c={},u=Yr(t),f=Ht(t,y=>({alias:[y],src:y,data:{}})),d=f.reduce((y,m)=>y+(m.progressSize||1),0),p=f.map(async y=>{const m=Tt.toAbsolute(y.src);c[y.src]||(await this._loadAssetWithRetry(m,y,{onProgress:i,onError:n,strategy:a,retryCount:o,retryDelay:l},c),h+=y.progressSize||1,i&&i(h/d))});return await Promise.all(p),u?c[f[0].src]:c}async unload(t){const r=Ht(t,i=>({alias:[i],src:i})).map(async i=>{const n=Tt.toAbsolute(i.src),a=this.promiseCache[n];if(a){const o=await a.promise;delete this.promiseCache[n],await a.parser?.unload?.(o,i,this)}});await Promise.all(r)}_validateParsers(){this._parsersValidated=!0,this._parserHash=this._parsers.filter(t=>t.name||t.id).reduce((t,e)=>(!e.name&&!e.id?q("[Assets] parser should have an id"):(t[e.name]||t[e.id])&&q(`[Assets] parser id conflict "${e.id}"`),t[e.name]=e,e.id&&(t[e.id]=e),t),{})}async _loadAssetWithRetry(t,e,r,i){let n=0;const{onError:a,strategy:o,retryCount:l,retryDelay:h}=r,c=u=>new Promise(f=>setTimeout(f,u));for(;;)try{this.promiseCache[t]||(this.promiseCache[t]=this._getLoadPromiseAndParser(t,e)),i[e.src]=await this.promiseCache[t].promise;return}catch(u){delete this.promiseCache[t],delete i[e.src],n++;const f=o!=="retry"||n>l;if(o==="retry"&&!f){a&&a(u,e),await c(h);continue}if(o==="skip"){a&&a(u,e);return}a&&a(u,e);const d=new Error(`[Loader.load] Failed to load ${t}.
${u}`);throw u instanceof Error&&u.stack&&(d.stack=u.stack),d}}};$h.defaultOptions={onProgress:void 0,onError:void 0,strategy:"throw",retryCount:3,retryDelay:250};let op=$h;function Fs(s,t){if(Array.isArray(t)){for(const e of t)if(s.startsWith(`data:${e}`))return!0;return!1}return s.startsWith(`data:${t}`)}function Gs(s,t){const e=s.split("?")[0],r=Tt.extname(e).toLowerCase();return Array.isArray(t)?t.includes(r):r===t}const lp=".json",hp="application/json",cp={extension:{type:k.LoadParser,priority:ke.Low},name:"loadJson",id:"json",test(s){return Fs(s,hp)||Gs(s,lp)},async load(s){return await(await tt.get().fetch(s)).json()}},up=".txt",dp="text/plain",fp={name:"loadTxt",id:"text",extension:{type:k.LoadParser,priority:ke.Low,name:"loadTxt"},test(s){return Fs(s,dp)||Gs(s,up)},async load(s){return await(await tt.get().fetch(s)).text()}},pp=["normal","bold","100","200","300","400","500","600","700","800","900"],mp=[".ttf",".otf",".woff",".woff2"],gp=["font/ttf","font/otf","font/woff","font/woff2"],yp=/^(--|-?[A-Z_])[0-9A-Z_-]*$/i;function _p(s){const t=Tt.extname(s),i=Tt.basename(s,t).replace(/(-|_)/g," ").toLowerCase().split(" ").map(o=>o.charAt(0).toUpperCase()+o.slice(1));let n=i.length>0;for(const o of i)if(!o.match(yp)){n=!1;break}let a=i.join(" ");return n||(a=`"${a.replace(/[\\"]/g,"\\$&")}"`),a}const xp=/^[0-9A-Za-z%:/?#\[\]@!\$&'()\*\+,;=\-._~]*$/;function bp(s){return xp.test(s)?s:encodeURI(s)}const vp={extension:{type:k.LoadParser,priority:ke.Low},name:"loadWebFont",id:"web-font",test(s){return Fs(s,gp)||Gs(s,mp)},async load(s,t){const e=tt.get().getFontFaceSet();if(e){const r=[],i=t.data?.family??_p(s),n=t.data?.weights?.filter(o=>pp.includes(o))??["normal"],a=t.data??{};for(let o=0;o<n.length;o++){const l=n[o],h=new FontFace(i,`url(${bp(s)})`,{...a,weight:l});await h.load(),e.add(h),r.push(h)}return ht.has(`${i}-and-url`)?ht.get(`${i}-and-url`).entries.push({url:s,faces:r}):ht.set(`${i}-and-url`,{entries:[{url:s,faces:r}]}),r.length===1?r[0]:r}return q("[loadWebFont] FontFace API is not supported. Skipping loading font"),null},unload(s){const t=Array.isArray(s)?s:[s],e=t[0].family,r=ht.get(`${e}-and-url`),i=r.entries.find(n=>n.faces.some(a=>t.indexOf(a)!==-1));i.faces=i.faces.filter(n=>t.indexOf(n)===-1),i.faces.length===0&&(r.entries=r.entries.filter(n=>n!==i)),t.forEach(n=>{tt.get().getFontFaceSet().delete(n)}),r.entries.length===0&&ht.remove(`${e}-and-url`)}};var Gi,Qa;function wp(){if(Qa)return Gi;Qa=1,Gi=e;var s={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},t=/([astvzqmhlc])([^astvzqmhlc]*)/ig;function e(n){var a=[];return n.replace(t,function(o,l,h){var c=l.toLowerCase();for(h=i(h),c=="m"&&h.length>2&&(a.push([l].concat(h.splice(0,2))),c="l",l=l=="m"?"l":"L");;){if(h.length==s[c])return h.unshift(l),a.push(h);if(h.length<s[c])throw new Error("malformed path data");a.push([l].concat(h.splice(0,s[c])))}}),a}var r=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig;function i(n){var a=n.match(r);return a?a.map(Number):[]}return Gi}var Ap=wp();const Sp=Ol(Ap);function Cp(s,t){const e=Sp(s),r=[];let i=null,n=0,a=0;for(let o=0;o<e.length;o++){const l=e[o],h=l[0],c=l;switch(h){case"M":n=c[1],a=c[2],t.moveTo(n,a);break;case"m":n+=c[1],a+=c[2],t.moveTo(n,a);break;case"H":n=c[1],t.lineTo(n,a);break;case"h":n+=c[1],t.lineTo(n,a);break;case"V":a=c[1],t.lineTo(n,a);break;case"v":a+=c[1],t.lineTo(n,a);break;case"L":n=c[1],a=c[2],t.lineTo(n,a);break;case"l":n+=c[1],a+=c[2],t.lineTo(n,a);break;case"C":n=c[5],a=c[6],t.bezierCurveTo(c[1],c[2],c[3],c[4],n,a);break;case"c":t.bezierCurveTo(n+c[1],a+c[2],n+c[3],a+c[4],n+c[5],a+c[6]),n+=c[5],a+=c[6];break;case"S":n=c[3],a=c[4],t.bezierCurveToShort(c[1],c[2],n,a);break;case"s":t.bezierCurveToShort(n+c[1],a+c[2],n+c[3],a+c[4]),n+=c[3],a+=c[4];break;case"Q":n=c[3],a=c[4],t.quadraticCurveTo(c[1],c[2],n,a);break;case"q":t.quadraticCurveTo(n+c[1],a+c[2],n+c[3],a+c[4]),n+=c[3],a+=c[4];break;case"T":n=c[1],a=c[2],t.quadraticCurveToShort(n,a);break;case"t":n+=c[1],a+=c[2],t.quadraticCurveToShort(n,a);break;case"A":n=c[6],a=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,a);break;case"a":n+=c[6],a+=c[7],t.arcToSvg(c[1],c[2],c[3],c[4],c[5],n,a);break;case"Z":case"z":t.closePath(),r.length>0&&(i=r.pop(),i?(n=i.startX,a=i.startY):(n=0,a=0)),i=null;break;default:q(`Unknown SVG path command: ${h}`)}h!=="Z"&&h!=="z"&&i===null&&(i={startX:n,startY:a},r.push(i))}return t}class $n{constructor(t=0,e=0,r=0){this.type="circle",this.x=t,this.y=e,this.radius=r}clone(){return new $n(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;const r=this.radius*this.radius;let i=this.x-t,n=this.y-e;return i*=i,n*=n,i+n<=r}strokeContains(t,e,r,i=.5){if(this.radius===0)return!1;const n=this.x-t,a=this.y-e,o=this.radius,l=(1-i)*r,h=Math.sqrt(n*n+a*a);return h<=o+l&&h>o-(r-l)}getBounds(t){return t||(t=new ct),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=this.radius*2,t.height=this.radius*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}class Vn{constructor(t=0,e=0,r=0,i=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=r,this.halfHeight=i}clone(){return new Vn(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let r=(t-this.x)/this.halfWidth,i=(e-this.y)/this.halfHeight;return r*=r,i*=i,r+i<=1}strokeContains(t,e,r,i=.5){const{halfWidth:n,halfHeight:a}=this;if(n<=0||a<=0)return!1;const o=r*(1-i),l=r-o,h=n-l,c=a-l,u=n+o,f=a+o,d=t-this.x,p=e-this.y,y=d*d/(h*h)+p*p/(c*c),m=d*d/(u*u)+p*p/(f*f);return y>1&&m<=1}getBounds(t){return t||(t=new ct),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=this.halfWidth*2,t.height=this.halfHeight*2,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}function Pp(s,t,e,r,i,n){const a=s-e,o=t-r,l=i-e,h=n-r,c=a*l+o*h,u=l*l+h*h;let f=-1;u!==0&&(f=c/u);let d,p;f<0?(d=e,p=r):f>1?(d=i,p=n):(d=e+f*l,p=r+f*h);const y=s-d,m=t-p;return y*y+m*m}let Mp,Tp;class ir{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if(typeof e[0]!="number"){const r=[];for(let i=0,n=e.length;i<n;i++)r.push(e[i].x,e[i].y);e=r}this.points=e,this.closePath=!0}isClockwise(){let t=0;const e=this.points,r=e.length;for(let i=0;i<r;i+=2){const n=e[i],a=e[i+1],o=e[(i+2)%r],l=e[(i+3)%r];t+=(o-n)*(l+a)}return t<0}containsPolygon(t){const e=this.getBounds(Mp),r=t.getBounds(Tp);if(!e.containsRect(r))return!1;const i=t.points;for(let n=0;n<i.length;n+=2){const a=i[n],o=i[n+1];if(!this.contains(a,o))return!1}return!0}clone(){const t=this.points.slice(),e=new ir(t);return e.closePath=this.closePath,e}contains(t,e){let r=!1;const i=this.points.length/2;for(let n=0,a=i-1;n<i;a=n++){const o=this.points[n*2],l=this.points[n*2+1],h=this.points[a*2],c=this.points[a*2+1];l>e!=c>e&&t<(h-o)*((e-l)/(c-l))+o&&(r=!r)}return r}strokeContains(t,e,r,i=.5){const n=r*r,a=n*(1-i),o=n-a,{points:l}=this,h=l.length-(this.closePath?0:2);for(let c=0;c<h;c+=2){const u=l[c],f=l[c+1],d=l[(c+2)%l.length],p=l[(c+3)%l.length],y=Pp(t,e,u,f,d,p),m=Math.sign((d-u)*(e-f)-(p-f)*(t-u));if(y<=(m<0?o:a))return!0}return!1}getBounds(t){t||(t=new ct);const e=this.points;let r=1/0,i=-1/0,n=1/0,a=-1/0;for(let o=0,l=e.length;o<l;o+=2){const h=e[o],c=e[o+1];r=h<r?h:r,i=h>i?h:i,n=c<n?c:n,a=c>a?c:a}return t.x=r,t.width=i-r,t.y=n,t.height=a-n,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return V("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return V("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}const Lr=(s,t,e,r,i,n,a)=>{const o=s-e,l=t-r,h=Math.sqrt(o*o+l*l);return h>=i-n&&h<=i+a};class Wn{constructor(t=0,e=0,r=0,i=0,n=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=r,this.height=i,this.radius=n}getBounds(t){return t||(t=new ct),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new Wn(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){const r=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+r&&e<=this.y+this.height-r||t>=this.x+r&&t<=this.x+this.width-r)return!0;let i=t-(this.x+r),n=e-(this.y+r);const a=r*r;if(i*i+n*n<=a||(i=t-(this.x+this.width-r),i*i+n*n<=a)||(n=e-(this.y+this.height-r),i*i+n*n<=a)||(i=t-(this.x+r),i*i+n*n<=a))return!0}return!1}strokeContains(t,e,r,i=.5){const{x:n,y:a,width:o,height:l,radius:h}=this,c=r*(1-i),u=r-c,f=n+h,d=a+h,p=o-h*2,y=l-h*2,m=n+o,g=a+l;return(t>=n-c&&t<=n+u||t>=m-u&&t<=m+c)&&e>=d&&e<=d+y||(e>=a-c&&e<=a+u||e>=g-u&&e<=g+c)&&t>=f&&t<=f+p?!0:t<f&&e<d&&Lr(t,e,f,d,h,u,c)||t>m-h&&e<d&&Lr(t,e,m-h,d,h,u,c)||t>m-h&&e>g-h&&Lr(t,e,m-h,g-h,h,u,c)||t<f&&e>g-h&&Lr(t,e,f,g-h,h,u,c)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}const Vh={};function kp(s,t,e){let r=2166136261;for(let i=0;i<t;i++)r^=s[i].uid,r=Math.imul(r,16777619),r>>>=0;return Vh[r]||Ep(s,t,r,e)}function Ep(s,t,e,r){const i={};let n=0;for(let o=0;o<r;o++){const l=o<t?s[o]:U.EMPTY.source;i[n++]=l.source,i[n++]=l.style}const a=new Nr(i);return Vh[e]=a,a}class Ja{constructor(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData),this.size=this.rawBinaryData.byteLength}get int8View(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View}get uint8View(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View}get int16View(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View}get int32View(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View}get float64View(){return this._float64Array||(this._float64Array=new Float64Array(this.rawBinaryData)),this._float64Array}get bigUint64View(){return this._bigUint64Array||(this._bigUint64Array=new BigUint64Array(this.rawBinaryData)),this._bigUint64Array}view(t){return this[`${t}View`]}destroy(){this.rawBinaryData=null,this.uint32View=null,this.float32View=null,this.uint16View=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._int32View=null,this._float64Array=null,this._bigUint64Array=null}static sizeOf(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(`${t} isn't a valid view type`)}}}function to(s,t,e,r){if(e??(e=0),r??(r=Math.min(s.byteLength-e,t.byteLength)),!(e&7)&&!(r&7)){const i=r/8;new Float64Array(t,0,i).set(new Float64Array(s,e,i))}else if(!(e&3)&&!(r&3)){const i=r/4;new Float32Array(t,0,i).set(new Float32Array(s,e,i))}else new Uint8Array(t).set(new Uint8Array(s,e,r))}const Ip={normal:"normal-npm",add:"add-npm",screen:"screen-npm"};var Rp=(s=>(s[s.DISABLED=0]="DISABLED",s[s.RENDERING_MASK_ADD=1]="RENDERING_MASK_ADD",s[s.MASK_ACTIVE=2]="MASK_ACTIVE",s[s.INVERSE_MASK_ACTIVE=3]="INVERSE_MASK_ACTIVE",s[s.RENDERING_MASK_REMOVE=4]="RENDERING_MASK_REMOVE",s[s.NONE=5]="NONE",s))(Rp||{});function eo(s,t){return t.alphaMode==="no-premultiply-alpha"&&Ip[s]||s}const Bp=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function Fp(s){let t="";for(let e=0;e<s;++e)e>0&&(t+=`
else `),e<s-1&&(t+=`if(test == ${e}.0){}`);return t}function Gp(s,t){if(s===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");const e=t.createShader(t.FRAGMENT_SHADER);try{for(;;){const r=Bp.replace(/%forloop%/gi,Fp(s));if(t.shaderSource(e,r),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))s=s/2|0;else break}}finally{t.deleteShader(e)}return s}let rs=null;function Lp(){if(rs)return rs;const s=_h();return rs=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),rs=Gp(rs,s),s.getExtension("WEBGL_lose_context")?.loseContext(),rs}class Dp{constructor(){this.ids=Object.create(null),this.textures=[],this.count=0}clear(){for(let t=0;t<this.count;t++){const e=this.textures[t];this.textures[t]=null,this.ids[e.uid]=null}this.count=0}}class Op{constructor(){this.renderPipeId="batch",this.action="startBatch",this.start=0,this.size=0,this.textures=new Dp,this.blendMode="normal",this.topology="triangle-strip",this.canBundle=!0}destroy(){this.textures=null,this.gpuBindGroup=null,this.bindGroup=null,this.batcher=null,this.elements=null}}const nr=[];let qr=0;ri.register({clear:()=>{if(nr.length>0)for(const s of nr)s&&s.destroy();nr.length=0,qr=0}});function so(){return qr>0?nr[--qr]:new Op}function ro(s){s.elements=null,nr[qr++]=s}let Vs=0;const Wh=class Hh{constructor(t){this.uid=J("batcher"),this.dirty=!0,this.batchIndex=0,this.batches=[],this._elements=[],t={...Hh.defaultOptions,...t},t.maxTextures||(V("v8.8.0","maxTextures is a required option for Batcher now, please pass it in the options"),t.maxTextures=Lp());const{maxTextures:e,attributesInitialSize:r,indicesInitialSize:i}=t;this.attributeBuffer=new Ja(r*4),this.indexBuffer=new Uint16Array(i),this.maxTextures=e}begin(){this.elementSize=0,this.elementStart=0,this.indexSize=0,this.attributeSize=0;for(let t=0;t<this.batchIndex;t++)ro(this.batches[t]);this.batchIndex=0,this._batchIndexStart=0,this._batchIndexSize=0,this.dirty=!0}add(t){this._elements[this.elementSize++]=t,t._indexStart=this.indexSize,t._attributeStart=this.attributeSize,t._batcher=this,this.indexSize+=t.indexSize,this.attributeSize+=t.attributeSize*this.vertexSize}checkAndUpdateTexture(t,e){const r=t._batch.textures.ids[e._source.uid];return!r&&r!==0?!1:(t._textureId=r,t.texture=e,!0)}updateElement(t){this.dirty=!0;const e=this.attributeBuffer;t.packAsQuad?this.packQuadAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId):this.packAttributes(t,e.float32View,e.uint32View,t._attributeStart,t._textureId)}break(t){const e=this._elements;if(!e[this.elementStart])return;let r=so(),i=r.textures;i.clear();const n=e[this.elementStart];let a=eo(n.blendMode,n.texture._source),o=n.topology;this.attributeSize*4>this.attributeBuffer.size&&this._resizeAttributeBuffer(this.attributeSize*4),this.indexSize>this.indexBuffer.length&&this._resizeIndexBuffer(this.indexSize);const l=this.attributeBuffer.float32View,h=this.attributeBuffer.uint32View,c=this.indexBuffer;let u=this._batchIndexSize,f=this._batchIndexStart,d="startBatch",p=[];const y=this.maxTextures;for(let m=this.elementStart;m<this.elementSize;++m){const g=e[m];e[m]=null;const _=g.texture._source,b=eo(g.blendMode,_),S=a!==b||o!==g.topology;if(_._batchTick===Vs&&!S){g._textureId=_._textureBindLocation,u+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,h,g._attributeStart,g._textureId),this.packQuadIndex(c,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,h,g._attributeStart,g._textureId),this.packIndex(g,c,g._indexStart,g._attributeStart/this.vertexSize)),g._batch=r,p.push(g);continue}_._batchTick=Vs,(i.count>=y||S)&&(this._finishBatch(r,f,u-f,i,a,o,t,d,p),d="renderBatch",f=u,a=b,o=g.topology,r=so(),i=r.textures,i.clear(),p=[],++Vs),g._textureId=_._textureBindLocation=i.count,i.ids[_.uid]=i.count,i.textures[i.count++]=_,g._batch=r,p.push(g),u+=g.indexSize,g.packAsQuad?(this.packQuadAttributes(g,l,h,g._attributeStart,g._textureId),this.packQuadIndex(c,g._indexStart,g._attributeStart/this.vertexSize)):(this.packAttributes(g,l,h,g._attributeStart,g._textureId),this.packIndex(g,c,g._indexStart,g._attributeStart/this.vertexSize))}i.count>0&&(this._finishBatch(r,f,u-f,i,a,o,t,d,p),f=u,++Vs),this.elementStart=this.elementSize,this._batchIndexStart=f,this._batchIndexSize=u}_finishBatch(t,e,r,i,n,a,o,l,h){t.gpuBindGroup=null,t.bindGroup=null,t.action=l,t.batcher=this,t.textures=i,t.blendMode=n,t.topology=a,t.start=e,t.size=r,t.elements=h,++Vs,this.batches[this.batchIndex++]=t,o.add(t)}finish(t){this.break(t)}ensureAttributeBuffer(t){t*4<=this.attributeBuffer.size||this._resizeAttributeBuffer(t*4)}ensureIndexBuffer(t){t<=this.indexBuffer.length||this._resizeIndexBuffer(t)}_resizeAttributeBuffer(t){const e=Math.max(t,this.attributeBuffer.size*2),r=new Ja(e);to(this.attributeBuffer.rawBinaryData,r.rawBinaryData),this.attributeBuffer=r}_resizeIndexBuffer(t){const e=this.indexBuffer;let r=Math.max(t,e.length*1.5);r+=r%2;const i=r>65535?new Uint32Array(r):new Uint16Array(r);if(i.BYTES_PER_ELEMENT!==e.BYTES_PER_ELEMENT)for(let n=0;n<e.length;n++)i[n]=e[n];else to(e.buffer,i.buffer);this.indexBuffer=i}packQuadIndex(t,e,r){t[e]=r+0,t[e+1]=r+1,t[e+2]=r+2,t[e+3]=r+0,t[e+4]=r+2,t[e+5]=r+3}packIndex(t,e,r,i){const n=t.indices,a=t.indexSize,o=t.indexOffset,l=t.attributeOffset;for(let h=0;h<a;h++)e[r++]=i+n[h+o]-l}destroy(t={}){if(this.batches!==null){for(let e=0;e<this.batchIndex;e++)ro(this.batches[e]);this.batches=null,this.geometry.destroy(!0),this.geometry=null,t.shader&&(this.shader?.destroy(),this.shader=null);for(let e=0;e<this._elements.length;e++)this._elements[e]&&(this._elements[e]._batch=null);this._elements=null,this.indexBuffer=null,this.attributeBuffer.destroy(),this.attributeBuffer=null}}};Wh.defaultOptions={maxTextures:null,attributesInitialSize:4,indicesInitialSize:6};let zp=Wh;var bt=(s=>(s[s.MAP_READ=1]="MAP_READ",s[s.MAP_WRITE=2]="MAP_WRITE",s[s.COPY_SRC=4]="COPY_SRC",s[s.COPY_DST=8]="COPY_DST",s[s.INDEX=16]="INDEX",s[s.VERTEX=32]="VERTEX",s[s.UNIFORM=64]="UNIFORM",s[s.STORAGE=128]="STORAGE",s[s.INDIRECT=256]="INDIRECT",s[s.QUERY_RESOLVE=512]="QUERY_RESOLVE",s[s.STATIC=1024]="STATIC",s))(bt||{});class dr extends pe{constructor(t){let{data:e,size:r}=t;const{usage:i,label:n,shrinkToFit:a}=t;super(),this._gpuData=Object.create(null),this._gcLastUsed=-1,this.autoGarbageCollect=!0,this.uid=J("buffer"),this._resourceType="buffer",this._resourceId=J("resource"),this._touched=0,this._updateID=1,this._dataInt32=null,this.shrinkToFit=!0,this.destroyed=!1,e instanceof Array&&(e=new Float32Array(e)),this._data=e,r??(r=e?.byteLength);const o=!!e;this.descriptor={size:r,usage:i,mappedAtCreation:o,label:n},this.shrinkToFit=a??!0}get data(){return this._data}set data(t){this.setDataWithSize(t,t.length,!0)}get dataInt32(){return this._dataInt32||(this._dataInt32=new Int32Array(this.data.buffer)),this._dataInt32}get static(){return!!(this.descriptor.usage&bt.STATIC)}set static(t){t?this.descriptor.usage|=bt.STATIC:this.descriptor.usage&=~bt.STATIC}setDataWithSize(t,e,r){if(this._updateID++,this._updateSize=e*t.BYTES_PER_ELEMENT,this._data===t){r&&this.emit("update",this);return}const i=this._data;if(this._data=t,this._dataInt32=null,!i||i.length!==t.length){!this.shrinkToFit&&i&&t.byteLength<i.byteLength?r&&this.emit("update",this):(this.descriptor.size=t.byteLength,this._resourceId=J("resource"),this.emit("change",this));return}r&&this.emit("update",this)}update(t){this._updateSize=t??this._updateSize,this._updateID++,this.emit("update",this)}unload(){this.emit("unload",this);for(const t in this._gpuData)this._gpuData[t]?.destroy();this._gpuData=Object.create(null)}destroy(){this.destroyed=!0,this.unload(),this.emit("destroy",this),this.emit("change",this),this._data=null,this.descriptor=null,this.removeAllListeners()}}function jh(s,t){if(!(s instanceof dr)){let e=t?bt.INDEX:bt.VERTEX;s instanceof Array&&(t?(s=new Uint32Array(s),e=bt.INDEX|bt.COPY_DST):(s=new Float32Array(s),e=bt.VERTEX|bt.COPY_DST)),s=new dr({data:s,label:t?"index-mesh-buffer":"vertex-mesh-buffer",usage:e})}return s}function Up(s,t,e){const r=s.getAttribute(t);if(!r)return e.minX=0,e.minY=0,e.maxX=0,e.maxY=0,e;const i=r.buffer.data;let n=1/0,a=1/0,o=-1/0,l=-1/0;const h=i.BYTES_PER_ELEMENT,c=(r.offset||0)/h,u=(r.stride||8)/h;for(let f=c;f<i.length;f+=u){const d=i[f],p=i[f+1];d>o&&(o=d),p>l&&(l=p),d<n&&(n=d),p<a&&(a=p)}return e.minX=n,e.minY=a,e.maxX=o,e.maxY=l,e}function Np(s){return(s instanceof dr||Array.isArray(s)||s.BYTES_PER_ELEMENT)&&(s={buffer:s}),s.buffer=jh(s.buffer,!1),s}class $p extends pe{constructor(t={}){super(),this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this.uid=J("geometry"),this._layoutKey=0,this.instanceCount=1,this._bounds=new qt,this._boundsDirty=!0;const{attributes:e,indexBuffer:r,topology:i}=t;if(this.buffers=[],this.attributes={},e)for(const n in e)this.addAttribute(n,e[n]);this.instanceCount=t.instanceCount??1,r&&this.addIndex(r),this.topology=i||"triangle-list"}onBufferUpdate(){this._boundsDirty=!0,this.emit("update",this)}getAttribute(t){return this.attributes[t]}getIndex(){return this.indexBuffer}getBuffer(t){return this.getAttribute(t).buffer}getSize(){for(const t in this.attributes){const e=this.attributes[t];return e.buffer.data.length/(e.stride/4||e.size)}return 0}addAttribute(t,e){const r=Np(e);this.buffers.indexOf(r.buffer)===-1&&(this.buffers.push(r.buffer),r.buffer.on("update",this.onBufferUpdate,this),r.buffer.on("change",this.onBufferUpdate,this)),this.attributes[t]=r}addIndex(t){this.indexBuffer=jh(t,!0),this.buffers.push(this.indexBuffer)}get bounds(){return this._boundsDirty?(this._boundsDirty=!1,Up(this,"aPosition",this._bounds)):this._bounds}unload(){this.emit("unload",this);for(const t in this._gpuData)this._gpuData[t]?.destroy();this._gpuData=Object.create(null)}destroy(t=!1){this.emit("destroy",this),this.removeAllListeners(),t&&this.buffers.forEach(e=>e.destroy()),this.unload(),this.indexBuffer?.destroy(),this.attributes=null,this.buffers=null,this.indexBuffer=null,this._bounds=null}}const Vp=new Float32Array(1),Wp=new Uint32Array(1);class Hp extends $p{constructor(){const e=new dr({data:Vp,label:"attribute-batch-buffer",usage:bt.VERTEX|bt.COPY_DST,shrinkToFit:!1}),r=new dr({data:Wp,label:"index-batch-buffer",usage:bt.INDEX|bt.COPY_DST,shrinkToFit:!1}),i=24;super({attributes:{aPosition:{buffer:e,format:"float32x2",stride:i,offset:0},aUV:{buffer:e,format:"float32x2",stride:i,offset:8},aColor:{buffer:e,format:"unorm8x4",stride:i,offset:16},aTextureIdAndRound:{buffer:e,format:"uint16x2",stride:i,offset:20}},indexBuffer:r})}}function io(s,t,e){if(s)for(const r in s){const i=r.toLocaleLowerCase(),n=t[i];if(n){let a=s[r];r==="header"&&(a=a.replace(/@in\s+[^;]+;\s*/g,"").replace(/@out\s+[^;]+;\s*/g,"")),e&&n.push(`//----${e}----//`),n.push(a)}else q(`${r} placement hook does not exist in shader`)}}const jp=/\{\{(.*?)\}\}/g;function no(s){const t={};return(s.match(jp)?.map(r=>r.replace(/[{()}]/g,""))??[]).forEach(r=>{t[r]=[]}),t}function ao(s,t){let e;const r=/@in\s+([^;]+);/g;for(;(e=r.exec(s))!==null;)t.push(e[1])}function oo(s,t,e=!1){const r=[];ao(t,r),s.forEach(o=>{o.header&&ao(o.header,r)});const i=r;e&&i.sort();const n=i.map((o,l)=>`       @location(${l}) ${o},`).join(`
`);let a=t.replace(/@in\s+[^;]+;\s*/g,"");return a=a.replace("{{in}}",`
${n}
`),a}function lo(s,t){let e;const r=/@out\s+([^;]+);/g;for(;(e=r.exec(s))!==null;)t.push(e[1])}function Xp(s){const e=/\b(\w+)\s*:/g.exec(s);return e?e[1]:""}function Yp(s){const t=/@.*?\s+/g;return s.replace(t,"")}function qp(s,t){const e=[];lo(t,e),s.forEach(l=>{l.header&&lo(l.header,e)});let r=0;const i=e.sort().map(l=>l.indexOf("builtin")>-1?l:`@location(${r++}) ${l}`).join(`,
`),n=e.sort().map(l=>`       var ${Yp(l)};`).join(`
`),a=`return VSOutput(
            ${e.sort().map(l=>` ${Xp(l)}`).join(`,
`)});`;let o=t.replace(/@out\s+[^;]+;\s*/g,"");return o=o.replace("{{struct}}",`
${i}
`),o=o.replace("{{start}}",`
${n}
`),o=o.replace("{{return}}",`
${a}
`),o}function ho(s,t){let e=s;for(const r in t){const i=t[r];i.join(`
`).length?e=e.replace(`{{${r}}}`,`//-----${r} START-----//
${i.join(`
`)}
//----${r} FINISH----//`):e=e.replace(`{{${r}}}`,"")}return e}const Ae=Object.create(null),Li=new Map;let Kp=0;function Zp({template:s,bits:t}){const e=Xh(s,t);if(Ae[e])return Ae[e];const{vertex:r,fragment:i}=Jp(s,t);return Ae[e]=Yh(r,i,t),Ae[e]}function Qp({template:s,bits:t}){const e=Xh(s,t);return Ae[e]||(Ae[e]=Yh(s.vertex,s.fragment,t)),Ae[e]}function Jp(s,t){const e=t.map(a=>a.vertex).filter(a=>!!a),r=t.map(a=>a.fragment).filter(a=>!!a);let i=oo(e,s.vertex,!0);i=qp(e,i);const n=oo(r,s.fragment,!0);return{vertex:i,fragment:n}}function Xh(s,t){return t.map(e=>(Li.has(e)||Li.set(e,Kp++),Li.get(e))).sort((e,r)=>e-r).join("-")+s.vertex+s.fragment}function Yh(s,t,e){const r=no(s),i=no(t);return e.forEach(n=>{io(n.vertex,r,n.name),io(n.fragment,i,n.name)}),{vertex:ho(s,r),fragment:ho(t,i)}}const tm=`
    @in aPosition: vec2<f32>;
    @in aUV: vec2<f32>;

    @out @builtin(position) vPosition: vec4<f32>;
    @out vUV : vec2<f32>;
    @out vColor : vec4<f32>;

    {{header}}

    struct VSOutput {
        {{struct}}
    };

    @vertex
    fn main( {{in}} ) -> VSOutput {

        var worldTransformMatrix = globalUniforms.uWorldTransformMatrix;
        var modelMatrix = mat3x3<f32>(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        var position = aPosition;
        var uv = aUV;

        {{start}}

        vColor = vec4<f32>(1., 1., 1., 1.);

        {{main}}

        vUV = uv;

        var modelViewProjectionMatrix = globalUniforms.uProjectionMatrix * worldTransformMatrix * modelMatrix;

        vPosition =  vec4<f32>((modelViewProjectionMatrix *  vec3<f32>(position, 1.0)).xy, 0.0, 1.0);

        vColor *= globalUniforms.uWorldColorAlpha;

        {{end}}

        {{return}}
    };
`,em=`
    @in vUV : vec2<f32>;
    @in vColor : vec4<f32>;

    {{header}}

    @fragment
    fn main(
        {{in}}
      ) -> @location(0) vec4<f32> {

        {{start}}

        var outColor:vec4<f32>;

        {{main}}

        var finalColor:vec4<f32> = outColor * vColor;

        {{end}}

        return finalColor;
      };
`,sm=`
    in vec2 aPosition;
    in vec2 aUV;

    out vec4 vColor;
    out vec2 vUV;

    {{header}}

    void main(void){

        mat3 worldTransformMatrix = uWorldTransformMatrix;
        mat3 modelMatrix = mat3(
            1.0, 0.0, 0.0,
            0.0, 1.0, 0.0,
            0.0, 0.0, 1.0
          );
        vec2 position = aPosition;
        vec2 uv = aUV;

        {{start}}

        vColor = vec4(1.);

        {{main}}

        vUV = uv;

        mat3 modelViewProjectionMatrix = uProjectionMatrix * worldTransformMatrix * modelMatrix;

        gl_Position = vec4((modelViewProjectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);

        vColor *= uWorldColorAlpha;

        {{end}}
    }
`,rm=`

    in vec4 vColor;
    in vec2 vUV;

    out vec4 finalColor;

    {{header}}

    void main(void) {

        {{start}}

        vec4 outColor;

        {{main}}

        finalColor = outColor * vColor;

        {{end}}
    }
`,im={name:"global-uniforms-bit",vertex:{header:`
        struct GlobalUniforms {
            uProjectionMatrix:mat3x3<f32>,
            uWorldTransformMatrix:mat3x3<f32>,
            uWorldColorAlpha: vec4<f32>,
            uResolution: vec2<f32>,
        }

        @group(0) @binding(0) var<uniform> globalUniforms : GlobalUniforms;
        `}},nm={name:"global-uniforms-bit",vertex:{header:`
          uniform mat3 uProjectionMatrix;
          uniform mat3 uWorldTransformMatrix;
          uniform vec4 uWorldColorAlpha;
          uniform vec2 uResolution;
        `}};function am({bits:s,name:t}){const e=Zp({template:{fragment:em,vertex:tm},bits:[im,...s]});return ni.from({name:t,vertex:{source:e.vertex,entryPoint:"main"},fragment:{source:e.fragment,entryPoint:"main"}})}function om({bits:s,name:t}){return new bh({name:t,...Qp({template:{vertex:sm,fragment:rm},bits:[nm,...s]})})}const lm={name:"color-bit",vertex:{header:`
            @in aColor: vec4<f32>;
        `,main:`
            vColor *= vec4<f32>(aColor.rgb * aColor.a, aColor.a);
        `}},hm={name:"color-bit",vertex:{header:`
            in vec4 aColor;
        `,main:`
            vColor *= vec4(aColor.rgb * aColor.a, aColor.a);
        `}},Di={};function cm(s){const t=[];if(s===1)t.push("@group(1) @binding(0) var textureSource1: texture_2d<f32>;"),t.push("@group(1) @binding(1) var textureSampler1: sampler;");else{let e=0;for(let r=0;r<s;r++)t.push(`@group(1) @binding(${e++}) var textureSource${r+1}: texture_2d<f32>;`),t.push(`@group(1) @binding(${e++}) var textureSampler${r+1}: sampler;`)}return t.join(`
`)}function um(s){const t=[];if(s===1)t.push("outColor = textureSampleGrad(textureSource1, textureSampler1, vUV, uvDx, uvDy);");else{t.push("switch vTextureId {");for(let e=0;e<s;e++)e===s-1?t.push("  default:{"):t.push(`  case ${e}:{`),t.push(`      outColor = textureSampleGrad(textureSource${e+1}, textureSampler${e+1}, vUV, uvDx, uvDy);`),t.push("      break;}");t.push("}")}return t.join(`
`)}function dm(s){return Di[s]||(Di[s]={name:"texture-batch-bit",vertex:{header:`
                @in aTextureIdAndRound: vec2<u32>;
                @out @interpolate(flat) vTextureId : u32;
            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1)
                {
                    vPosition = vec4<f32>(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
                }
            `},fragment:{header:`
                @in @interpolate(flat) vTextureId: u32;

                ${cm(s)}
            `,main:`
                var uvDx = dpdx(vUV);
                var uvDy = dpdy(vUV);

                ${um(s)}
            `}}),Di[s]}const Oi={};function fm(s){const t=[];for(let e=0;e<s;e++)e>0&&t.push("else"),e<s-1&&t.push(`if(vTextureId < ${e}.5)`),t.push("{"),t.push(`	outColor = texture(uTextures[${e}], vUV);`),t.push("}");return t.join(`
`)}function pm(s){return Oi[s]||(Oi[s]={name:"texture-batch-bit",vertex:{header:`
                in vec2 aTextureIdAndRound;
                out float vTextureId;

            `,main:`
                vTextureId = aTextureIdAndRound.y;
            `,end:`
                if(aTextureIdAndRound.x == 1.)
                {
                    gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
                }
            `},fragment:{header:`
                in float vTextureId;

                uniform sampler2D uTextures[${s}];

            `,main:`

                ${fm(s)}
            `}}),Oi[s]}const mm={name:"round-pixels-bit",vertex:{header:`
            fn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},gm={name:"round-pixels-bit",vertex:{header:`
            vec2 roundPixels(vec2 position, vec2 targetSize)
            {
                return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;
            }
        `}},co={};function ym(s){let t=co[s];if(t)return t;const e=new Int32Array(s);for(let r=0;r<s;r++)e[r]=r;return t=co[s]=new Sh({uTextures:{value:e,type:"i32",size:s}},{isStatic:!0}),t}class uo extends Nn{constructor(t){const e=om({name:"batch",bits:[hm,pm(t),gm]}),r=am({name:"batch",bits:[lm,dm(t),mm]});super({glProgram:e,gpuProgram:r,resources:{batchSamplers:ym(t)}}),this.maxTextures=t}}let Ws=null;const qh=class Kh extends zp{constructor(t){super(t),this.geometry=new Hp,this.name=Kh.extension.name,this.vertexSize=6,Ws??(Ws=new uo(t.maxTextures)),this.shader=Ws}packAttributes(t,e,r,i,n){const a=n<<16|t.roundPixels&65535,o=t.transform,l=o.a,h=o.b,c=o.c,u=o.d,f=o.tx,d=o.ty,{positions:p,uvs:y}=t,m=t.color,g=t.attributeOffset,x=g+t.attributeSize;for(let _=g;_<x;_++){const b=_*2,S=p[b],v=p[b+1];e[i++]=l*S+c*v+f,e[i++]=u*v+h*S+d,e[i++]=y[b],e[i++]=y[b+1],r[i++]=m,r[i++]=a}}packQuadAttributes(t,e,r,i,n){const a=t.texture,o=t.transform,l=o.a,h=o.b,c=o.c,u=o.d,f=o.tx,d=o.ty,p=t.bounds,y=p.maxX,m=p.minX,g=p.maxY,x=p.minY,_=a.uvs,b=t.color,S=n<<16|t.roundPixels&65535;e[i+0]=l*m+c*x+f,e[i+1]=u*x+h*m+d,e[i+2]=_.x0,e[i+3]=_.y0,r[i+4]=b,r[i+5]=S,e[i+6]=l*y+c*x+f,e[i+7]=u*x+h*y+d,e[i+8]=_.x1,e[i+9]=_.y1,r[i+10]=b,r[i+11]=S,e[i+12]=l*y+c*g+f,e[i+13]=u*g+h*y+d,e[i+14]=_.x2,e[i+15]=_.y2,r[i+16]=b,r[i+17]=S,e[i+18]=l*m+c*g+f,e[i+19]=u*g+h*m+d,e[i+20]=_.x3,e[i+21]=_.y3,r[i+22]=b,r[i+23]=S}_updateMaxTextures(t){this.shader.maxTextures!==t&&(Ws=new uo(t),this.shader=Ws)}destroy(){this.shader=null,super.destroy()}};qh.extension={type:[k.Batcher],name:"default"};let _m=qh;class oi{constructor(t){this.items=Object.create(null);const{renderer:e,type:r,onUnload:i,priority:n,name:a}=t;this._renderer=e,e.gc.addResourceHash(this,"items",r,n??0),this._onUnload=i,this.name=a}add(t){return this.items[t.uid]?!1:(this.items[t.uid]=t,t.once("unload",this.remove,this),t._gcLastUsed=this._renderer.gc.now,!0)}remove(t,...e){if(!this.items[t.uid])return;const r=t._gpuData[this._renderer.uid];r&&(this._onUnload?.(t,...e),r.destroy(),t._gpuData[this._renderer.uid]=null,this.items[t.uid]=null)}removeAll(...t){Object.values(this.items).forEach(e=>e&&this.remove(e,...t))}destroy(...t){this.removeAll(...t),this.items=Object.create(null),this._renderer=null,this._onUnload=null}}function xm(s,t,e,r,i,n,a,o=null){let l=0;e*=t,i*=n;const h=o.a,c=o.b,u=o.c,f=o.d,d=o.tx,p=o.ty;for(;l<a;){const y=s[e],m=s[e+1];r[i]=h*y+u*m+d,r[i+1]=c*y+f*m+p,i+=n,e+=t,l++}}function bm(s,t,e,r){let i=0;for(t*=e;i<r;)s[t]=0,s[t+1]=0,t+=e,i++}function Zh(s,t,e,r,i){const n=t.a,a=t.b,o=t.c,l=t.d,h=t.tx,c=t.ty;e||(e=0),r||(r=2),i||(i=s.length/r-e);let u=e*r;for(let f=0;f<i;f++){const d=s[u],p=s[u+1];s[u]=n*d+o*p+h,s[u+1]=a*d+l*p+c,u+=r}}const vm=new D;class Hn{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){const t=this.baseColor,e=t>>16|t&65280|(t&255)<<16,r=this.renderable;return r?Ql(e,r.groupColor)+(this.alpha*r.groupAlpha*255<<24):e+(this.alpha*255<<24)}get transform(){return this.renderable?.groupTransform||vm}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}const fr={extension:{type:k.ShapeBuilder,name:"circle"},build(s,t){let e,r,i,n,a,o;if(s.type==="circle"){const b=s;if(a=o=b.radius,a<=0)return!1;e=b.x,r=b.y,i=n=0}else if(s.type==="ellipse"){const b=s;if(a=b.halfWidth,o=b.halfHeight,a<=0||o<=0)return!1;e=b.x,r=b.y,i=n=0}else{const b=s,S=b.width/2,v=b.height/2;e=b.x+S,r=b.y+v,a=o=Math.max(0,Math.min(b.radius,Math.min(S,v))),i=S-a,n=v-o}if(i<0||n<0)return!1;const l=Math.ceil(2.3*Math.sqrt(a+o)),h=l*8+(i?4:0)+(n?4:0);if(h===0)return!1;if(l===0)return t[0]=t[6]=e+i,t[1]=t[3]=r+n,t[2]=t[4]=e-i,t[5]=t[7]=r-n,!0;let c=0,u=l*4+(i?2:0)+2,f=u,d=h,p=i+a,y=n,m=e+p,g=e-p,x=r+y;if(t[c++]=m,t[c++]=x,t[--u]=x,t[--u]=g,n){const b=r-y;t[f++]=g,t[f++]=b,t[--d]=b,t[--d]=m}for(let b=1;b<l;b++){const S=Math.PI/2*(b/l),v=i+Math.cos(S)*a,w=n+Math.sin(S)*o,P=e+v,C=e-v,A=r+w,M=r-w;t[c++]=P,t[c++]=A,t[--u]=A,t[--u]=C,t[f++]=C,t[f++]=M,t[--d]=M,t[--d]=P}p=i,y=n+o,m=e+p,g=e-p,x=r+y;const _=r-y;return t[c++]=m,t[c++]=x,t[--d]=_,t[--d]=m,i&&(t[c++]=g,t[c++]=x,t[--d]=_,t[--d]=g),!0},triangulate(s,t,e,r,i,n){if(s.length===0)return;let a=0,o=0;for(let c=0;c<s.length;c+=2)a+=s[c],o+=s[c+1];a/=s.length/2,o/=s.length/2;let l=r;t[l*e]=a,t[l*e+1]=o;const h=l++;for(let c=0;c<s.length;c+=2)t[l*e]=s[c],t[l*e+1]=s[c+1],c>0&&(i[n++]=l,i[n++]=h,i[n++]=l-1),l++;i[n++]=h+1,i[n++]=h,i[n++]=l-1}},wm={...fr,extension:{...fr.extension,name:"ellipse"}},Am={...fr,extension:{...fr.extension,name:"roundedRectangle"}},Qh=1e-4,fo=1e-4;function Sm(s){const t=s.length;if(t<6)return 1;let e=0;for(let r=0,i=s[t-2],n=s[t-1];r<t;r+=2){const a=s[r],o=s[r+1];e+=(a-i)*(o+n),i=a,n=o}return e<0?-1:1}function po(s,t,e,r,i,n,a,o){const l=s-e*i,h=t-r*i,c=s+e*n,u=t+r*n;let f,d;a?(f=r,d=-e):(f=-r,d=e);const p=l+f,y=h+d,m=c+f,g=u+d;return o.push(p,y),o.push(m,g),2}function Fe(s,t,e,r,i,n,a,o){const l=e-s,h=r-t;let c=Math.atan2(l,h),u=Math.atan2(i-s,n-t);o&&c<u?c+=Math.PI*2:!o&&c>u&&(u+=Math.PI*2);let f=c;const d=u-c,p=Math.abs(d),y=Math.sqrt(l*l+h*h),m=(15*p*Math.sqrt(y)/Math.PI>>0)+1,g=d/m;if(f+=g,o){a.push(s,t),a.push(e,r);for(let x=1,_=f;x<m;x++,_+=g)a.push(s,t),a.push(s+Math.sin(_)*y,t+Math.cos(_)*y);a.push(s,t),a.push(i,n)}else{a.push(e,r),a.push(s,t);for(let x=1,_=f;x<m;x++,_+=g)a.push(s+Math.sin(_)*y,t+Math.cos(_)*y),a.push(s,t);a.push(i,n),a.push(s,t)}return m*2}function Cm(s,t,e,r,i,n){const a=Qh;if(s.length===0)return;const o=t;let l=o.alignment;if(t.alignment!==.5){let O=Sm(s);l=(l-.5)*O+.5}const h=new yt(s[0],s[1]),c=new yt(s[s.length-2],s[s.length-1]),u=r,f=Math.abs(h.x-c.x)<a&&Math.abs(h.y-c.y)<a;if(u){s=s.slice(),f&&(s.pop(),s.pop(),c.set(s[s.length-2],s[s.length-1]));const O=(h.x+c.x)*.5,$t=(c.y+h.y)*.5;s.unshift(O,$t),s.push(O,$t)}const d=i,p=s.length/2;let y=s.length;const m=d.length/2,g=o.width/2,x=g*g,_=o.miterLimit*o.miterLimit;let b=s[0],S=s[1],v=s[2],w=s[3],P=0,C=0,A=-(S-w),M=b-v,E=0,N=0,$=Math.sqrt(A*A+M*M);A/=$,M/=$,A*=g,M*=g;const Nt=l,T=(1-Nt)*2,R=Nt*2;u||(o.cap==="round"?y+=Fe(b-A*(T-R)*.5,S-M*(T-R)*.5,b-A*T,S-M*T,b+A*R,S+M*R,d,!0)+2:o.cap==="square"&&(y+=po(b,S,A,M,T,R,!0,d))),d.push(b-A*T,S-M*T),d.push(b+A*R,S+M*R);for(let O=1;O<p-1;++O){b=s[(O-1)*2],S=s[(O-1)*2+1],v=s[O*2],w=s[O*2+1],P=s[(O+1)*2],C=s[(O+1)*2+1],A=-(S-w),M=b-v,$=Math.sqrt(A*A+M*M),A/=$,M/=$,A*=g,M*=g,E=-(w-C),N=v-P,$=Math.sqrt(E*E+N*N),E/=$,N/=$,E*=g,N*=g;const $t=v-b,ge=S-w,ye=v-P,Ee=C-w,vr=$t*ye+ge*Ee,Ie=ge*ye-Ee*$t,_e=Ie<0;if(Math.abs(Ie)<.001*Math.abs(vr)){d.push(v-A*T,w-M*T),d.push(v+A*R,w+M*R),vr>=0&&(o.join==="round"?y+=Fe(v,w,v-A*T,w-M*T,v-E*T,w-N*T,d,!1)+4:y+=2,d.push(v-E*R,w-N*R),d.push(v+E*T,w+N*T));continue}const Ls=(-A+b)*(-M+w)-(-A+v)*(-M+S),Ds=(-E+P)*(-N+w)-(-E+v)*(-N+C),ts=($t*Ds-ye*Ls)/Ie,Re=(Ee*Ls-ge*Ds)/Ie,es=(ts-v)*(ts-v)+(Re-w)*(Re-w),se=v+(ts-v)*T,re=w+(Re-w)*T,ie=v-(ts-v)*R,Zt=w-(Re-w)*R,ci=Math.min($t*$t+ge*ge,ye*ye+Ee*Ee),G=_e?T:R,Be=ci+G*G*x;es<=Be?o.join==="bevel"||es/x>_?(_e?(d.push(se,re),d.push(v+A*R,w+M*R),d.push(se,re),d.push(v+E*R,w+N*R)):(d.push(v-A*T,w-M*T),d.push(ie,Zt),d.push(v-E*T,w-N*T),d.push(ie,Zt)),y+=2):o.join==="round"?_e?(d.push(se,re),d.push(v+A*R,w+M*R),y+=Fe(v,w,v+A*R,w+M*R,v+E*R,w+N*R,d,!0)+4,d.push(se,re),d.push(v+E*R,w+N*R)):(d.push(v-A*T,w-M*T),d.push(ie,Zt),y+=Fe(v,w,v-A*T,w-M*T,v-E*T,w-N*T,d,!1)+4,d.push(v-E*T,w-N*T),d.push(ie,Zt)):(d.push(se,re),d.push(ie,Zt)):(d.push(v-A*T,w-M*T),d.push(v+A*R,w+M*R),o.join==="round"?_e?y+=Fe(v,w,v+A*R,w+M*R,v+E*R,w+N*R,d,!0)+2:y+=Fe(v,w,v-A*T,w-M*T,v-E*T,w-N*T,d,!1)+2:o.join==="miter"&&es/x<=_&&(_e?(d.push(ie,Zt),d.push(ie,Zt)):(d.push(se,re),d.push(se,re)),y+=2),d.push(v-E*T,w-N*T),d.push(v+E*R,w+N*R),y+=2)}b=s[(p-2)*2],S=s[(p-2)*2+1],v=s[(p-1)*2],w=s[(p-1)*2+1],A=-(S-w),M=b-v,$=Math.sqrt(A*A+M*M),A/=$,M/=$,A*=g,M*=g,d.push(v-A*T,w-M*T),d.push(v+A*R,w+M*R),u||(o.cap==="round"?y+=Fe(v-A*(T-R)*.5,w-M*(T-R)*.5,v-A*T,w-M*T,v+A*R,w+M*R,d,!1)+2:o.cap==="square"&&(y+=po(v,w,A,M,T,R,!1,d)));const me=fo*fo;for(let O=m;O<y+m-2;++O)b=d[O*2],S=d[O*2+1],v=d[(O+1)*2],w=d[(O+1)*2+1],P=d[(O+2)*2],C=d[(O+2)*2+1],!(Math.abs(b*(w-C)+v*(C-S)+P*(S-w))<me)&&n.push(O,O+1,O+2)}function Pm(s,t,e,r){const i=Qh;if(s.length===0)return;const n=s[0],a=s[1],o=s[s.length-2],l=s[s.length-1],h=t||Math.abs(n-o)<i&&Math.abs(a-l)<i,c=e,u=s.length/2,f=c.length/2;for(let d=0;d<u;d++)c.push(s[d*2]),c.push(s[d*2+1]);for(let d=0;d<u-1;d++)r.push(f+d,f+d+1);h&&r.push(f+u-1,f)}function Jh(s,t,e,r,i,n,a){const o=$f(s,t,2);if(!o)return;for(let h=0;h<o.length;h+=3)n[a++]=o[h]+i,n[a++]=o[h+1]+i,n[a++]=o[h+2]+i;let l=i*r;for(let h=0;h<s.length;h+=2)e[l]=s[h],e[l+1]=s[h+1],l+=r}const Mm=[],Tm={extension:{type:k.ShapeBuilder,name:"polygon"},build(s,t){for(let e=0;e<s.points.length;e++)t[e]=s.points[e];return!0},triangulate(s,t,e,r,i,n){Jh(s,Mm,t,e,r,i,n)}},km={extension:{type:k.ShapeBuilder,name:"rectangle"},build(s,t){const e=s,r=e.x,i=e.y,n=e.width,a=e.height;return n>0&&a>0?(t[0]=r,t[1]=i,t[2]=r+n,t[3]=i,t[4]=r+n,t[5]=i+a,t[6]=r,t[7]=i+a,!0):!1},triangulate(s,t,e,r,i,n){let a=0;r*=e,t[r+a]=s[0],t[r+a+1]=s[1],a+=e,t[r+a]=s[2],t[r+a+1]=s[3],a+=e,t[r+a]=s[6],t[r+a+1]=s[7],a+=e,t[r+a]=s[4],t[r+a+1]=s[5],a+=e;const o=r/e;i[n++]=o,i[n++]=o+1,i[n++]=o+2,i[n++]=o+1,i[n++]=o+3,i[n++]=o+2}},Em={extension:{type:k.ShapeBuilder,name:"triangle"},build(s,t){return t[0]=s.x,t[1]=s.y,t[2]=s.x2,t[3]=s.y2,t[4]=s.x3,t[5]=s.y3,!0},triangulate(s,t,e,r,i,n){let a=0;r*=e,t[r+a]=s[0],t[r+a+1]=s[1],a+=e,t[r+a]=s[2],t[r+a+1]=s[3],a+=e,t[r+a]=s[4],t[r+a+1]=s[5];const o=r/e;i[n++]=o,i[n++]=o+1,i[n++]=o+2}},mo=[{offset:0,color:"white"},{offset:1,color:"black"}],jn=class gn{constructor(...t){this.uid=J("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let e=Im(t);e={...e.type==="radial"?gn.defaultRadialOptions:gn.defaultLinearOptions,...Nl(e)},this._textureSize=e.textureSize,this._wrapMode=e.wrapMode,e.type==="radial"?(this.center=e.center,this.outerCenter=e.outerCenter??this.center,this.innerRadius=e.innerRadius,this.outerRadius=e.outerRadius,this.scale=e.scale,this.rotation=e.rotation):(this.start=e.start,this.end=e.end),this.textureSpace=e.textureSpace,this.type=e.type,e.colorStops.forEach(i=>{this.addColorStop(i.offset,i.color)})}addColorStop(t,e){return this.colorStops.push({offset:t,color:Lt.shared.setValue(e).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:r,y:i}=this.end,n=r-t,a=i-e;const o=n<0||a<0;if(this._wrapMode==="clamp-to-edge"){if(n<0){const m=t;t=r,r=m,n*=-1}if(a<0){const m=e;e=i,i=m,a*=-1}}const l=this.colorStops.length?this.colorStops:mo,h=this._textureSize,{canvas:c,context:u}=yo(h,1),f=o?u.createLinearGradient(this._textureSize,0,0,0):u.createLinearGradient(0,0,this._textureSize,0);go(f,l),u.fillStyle=f,u.fillRect(0,0,h,1),this.texture=new U({source:new vs({resource:c,addressMode:this._wrapMode})});const d=Math.sqrt(n*n+a*a),p=Math.atan2(a,n),y=new D;y.scale(d/h,1),y.rotate(p),y.translate(t,e),this.textureSpace==="local"&&y.scale(h,h),this.transform=y}buildGradient(){this.texture||this._tick++,this.type==="linear"?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;const t=this.colorStops.length?this.colorStops:mo,e=this._textureSize,{canvas:r,context:i}=yo(e,e),{x:n,y:a}=this.center,{x:o,y:l}=this.outerCenter,h=this.innerRadius,c=this.outerRadius,u=o-c,f=l-c,d=e/(c*2),p=(n-u)*d,y=(a-f)*d,m=i.createRadialGradient(p,y,h*d,(o-u)*d,(l-f)*d,c*d);go(m,t),i.fillStyle=t[t.length-1].color,i.fillRect(0,0,e,e),i.fillStyle=m,i.translate(p,y),i.rotate(this.rotation),i.scale(1,this.scale),i.translate(-p,-y),i.fillRect(0,0,e,e),this.texture=new U({source:new vs({resource:r,addressMode:this._wrapMode})});const g=new D;g.scale(1/d,1/d),g.translate(u,f),this.textureSpace==="local"&&g.scale(e,e),this.transform=g}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};jn.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"};jn.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"};let br=jn;function go(s,t){for(let e=0;e<t.length;e++){const r=t[e];s.addColorStop(r.offset,r.color)}}function yo(s,t){const e=tt.get().createCanvas(s,t),r=e.getContext("2d");return{canvas:e,context:r}}function Im(s){let t=s[0]??{};return(typeof t=="number"||s[1])&&(V("8.5.2","use options object instead"),t={type:"linear",start:{x:s[0],y:s[1]},end:{x:s[2],y:s[3]},textureSpace:s[4],textureSize:s[5]??br.defaultLinearOptions.textureSize}),t}const Rm=new D,Bm=new ct;function Fm(s,t,e,r){const i=t.matrix?s.copyFrom(t.matrix).invert():s.identity();if(t.textureSpace==="local"){const a=e.getBounds(Bm);t.width&&a.pad(t.width);const{x:o,y:l}=a,h=1/a.width,c=1/a.height,u=-o*h,f=-l*c,d=i.a,p=i.b,y=i.c,m=i.d;i.a*=h,i.b*=h,i.c*=c,i.d*=c,i.tx=u*d+f*y+i.tx,i.ty=u*p+f*m+i.ty}else i.translate(t.texture.frame.x,t.texture.frame.y),i.scale(1/t.texture.source.width,1/t.texture.source.height);const n=t.texture.source.style;return!(t.fill instanceof br)&&n.addressMode==="clamp-to-edge"&&(n.addressMode="repeat",n.update()),r&&i.append(Rm.copyFrom(r).invert()),i}const li={};X.handleByMap(k.ShapeBuilder,li);X.add(km,Tm,Em,fr,wm,Am);const Gm=new ct,Lm=new D;function Dm(s,t){const{geometryData:e,batches:r}=t;r.length=0,e.indices.length=0,e.vertices.length=0,e.uvs.length=0;for(let i=0;i<s.instructions.length;i++){const n=s.instructions[i];if(n.action==="texture")Om(n.data,r,e);else if(n.action==="fill"||n.action==="stroke"){const a=n.action==="stroke",o=n.data.path.shapePath,l=n.data.style,h=n.data.hole;a&&h&&_o(h.shapePath,l,!0,r,e),h&&(o.shapePrimitives[o.shapePrimitives.length-1].holes=h.shapePath.shapePrimitives),_o(o,l,a,r,e)}}}function Om(s,t,e){const r=[],i=li.rectangle,n=Gm;n.x=s.dx,n.y=s.dy,n.width=s.dw,n.height=s.dh;const a=s.transform;if(!i.build(n,r))return;const{vertices:o,uvs:l,indices:h}=e,c=h.length,u=o.length/2;a&&Zh(r,a),i.triangulate(r,o,2,u,h,c);const f=s.image,d=f.uvs;l.push(d.x0,d.y0,d.x1,d.y1,d.x3,d.y3,d.x2,d.y2);const p=At.get(Hn);p.indexOffset=c,p.indexSize=h.length-c,p.attributeOffset=u,p.attributeSize=o.length/2-u,p.baseColor=s.style,p.alpha=s.alpha,p.texture=f,p.geometryData=e,t.push(p)}function _o(s,t,e,r,i){const{vertices:n,uvs:a,indices:o}=i;s.shapePrimitives.forEach(({shape:l,transform:h,holes:c})=>{const u=[],f=li[l.type];if(!f.build(l,u))return;const d=o.length,p=n.length/2;let y="triangle-list";if(h&&Zh(u,h),e){const _=l.closePath??!0,b=t;b.pixelLine?(Pm(u,_,n,o),y="line-list"):Cm(u,b,!1,_,n,o)}else if(c){const _=[],b=u.slice();zm(c).forEach(v=>{_.push(b.length/2),b.push(...v)}),Jh(b,_,n,2,p,o,d)}else f.triangulate(u,n,2,p,o,d);const m=a.length/2,g=t.texture;if(g!==U.WHITE){const _=Fm(Lm,t,l,h);xm(n,2,p,a,m,2,n.length/2-p,_)}else bm(a,m,2,n.length/2-p);const x=At.get(Hn);x.indexOffset=d,x.indexSize=o.length-d,x.attributeOffset=p,x.attributeSize=n.length/2-p,x.baseColor=t.color,x.alpha=t.alpha,x.texture=g,x.geometryData=i,x.topology=y,r.push(x)})}function zm(s){const t=[];for(let e=0;e<s.length;e++){const r=s[e].shape,i=[];li[r.type].build(r,i)&&t.push(i)}return t}class Um{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}reset(){this.batches&&this.batches.forEach(t=>{At.return(t)}),this.graphicsData&&At.return(this.graphicsData),this.isBatchable=!1,this.context=null,this.batches.length=0,this.geometryData.indices.length=0,this.geometryData.vertices.length=0,this.geometryData.uvs.length=0,this.graphicsData=null}destroy(){this.reset(),this.batches=null,this.geometryData=null}}class Nm{constructor(){this.instructions=new zn}init(t){const e=t.maxTextures;this.batcher?this.batcher._updateMaxTextures(e):this.batcher=new _m({maxTextures:e}),this.instructions.reset()}get geometry(){return V(cd,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}const Xn=class yn{constructor(t){this._renderer=t,this._managedContexts=new oi({renderer:t,type:"resource",name:"graphicsContext"})}init(t){yn.defaultOptions.bezierSmoothness=t?.bezierSmoothness??yn.defaultOptions.bezierSmoothness}getContextRenderData(t){return t._gpuData[this._renderer.uid].graphicsData||this._initContextRenderData(t)}updateGpuContext(t){const e=!!t._gpuData[this._renderer.uid],r=t._gpuData[this._renderer.uid]||this._initContext(t);if(t.dirty||!e){e&&r.reset(),Dm(t,r);const i=t.batchMode;t.customShader||i==="no-batch"?r.isBatchable=!1:i==="auto"?r.isBatchable=r.geometryData.vertices.length<400:r.isBatchable=!0,t.dirty=!1}return r}getGpuContext(t){return t._gpuData[this._renderer.uid]||this._initContext(t)}_initContextRenderData(t){const e=At.get(Nm,{maxTextures:this._renderer.limits.maxBatchableTextures}),r=t._gpuData[this._renderer.uid],{batches:i,geometryData:n}=r;r.graphicsData=e;const a=n.vertices.length,o=n.indices.length;for(let u=0;u<i.length;u++)i[u].applyTransform=!1;const l=e.batcher;l.ensureAttributeBuffer(a),l.ensureIndexBuffer(o),l.begin();for(let u=0;u<i.length;u++){const f=i[u];l.add(f)}l.finish(e.instructions);const h=l.geometry;h.indexBuffer.setDataWithSize(l.indexBuffer,l.indexSize,!0),h.buffers[0].setDataWithSize(l.attributeBuffer.float32View,l.attributeSize,!0);const c=l.batches;for(let u=0;u<c.length;u++){const f=c[u];f.bindGroup=kp(f.textures.textures,f.textures.count,this._renderer.limits.maxBatchableTextures)}return e}_initContext(t){const e=new Um;return e.context=t,t._gpuData[this._renderer.uid]=e,this._managedContexts.add(t),e}destroy(){this._managedContexts.destroy(),this._renderer=null}};Xn.extension={type:[k.WebGLSystem,k.WebGPUSystem],name:"graphicsContext"};Xn.defaultOptions={bezierSmoothness:.5};let Yn=Xn;const $m=8,Dr=11920929e-14,Vm=1;function tc(s,t,e,r,i,n,a,o,l,h){const u=Math.min(.99,Math.max(0,h??Yn.defaultOptions.bezierSmoothness));let f=(Vm-u)/1;return f*=f,Wm(t,e,r,i,n,a,o,l,s,f),s}function Wm(s,t,e,r,i,n,a,o,l,h){_n(s,t,e,r,i,n,a,o,l,h,0),l.push(a,o)}function _n(s,t,e,r,i,n,a,o,l,h,c){if(c>$m)return;const u=(s+e)/2,f=(t+r)/2,d=(e+i)/2,p=(r+n)/2,y=(i+a)/2,m=(n+o)/2,g=(u+d)/2,x=(f+p)/2,_=(d+y)/2,b=(p+m)/2,S=(g+_)/2,v=(x+b)/2;if(c>0){let w=a-s,P=o-t;const C=Math.abs((e-a)*P-(r-o)*w),A=Math.abs((i-a)*P-(n-o)*w);if(C>Dr&&A>Dr){if((C+A)*(C+A)<=h*(w*w+P*P)){l.push(S,v);return}}else if(C>Dr){if(C*C<=h*(w*w+P*P)){l.push(S,v);return}}else if(A>Dr){if(A*A<=h*(w*w+P*P)){l.push(S,v);return}}else if(w=S-(s+a)/2,P=v-(t+o)/2,w*w+P*P<=h){l.push(S,v);return}}_n(s,t,u,f,g,x,S,v,l,h,c+1),_n(S,v,_,b,y,m,a,o,l,h,c+1)}const Hm=8,jm=11920929e-14,Xm=1;function Ym(s,t,e,r,i,n,a,o){const h=Math.min(.99,Math.max(0,o??Yn.defaultOptions.bezierSmoothness));let c=(Xm-h)/1;return c*=c,qm(t,e,r,i,n,a,s,c),s}function qm(s,t,e,r,i,n,a,o){xn(a,s,t,e,r,i,n,o,0),a.push(i,n)}function xn(s,t,e,r,i,n,a,o,l){if(l>Hm)return;const h=(t+r)/2,c=(e+i)/2,u=(r+n)/2,f=(i+a)/2,d=(h+u)/2,p=(c+f)/2;let y=n-t,m=a-e;const g=Math.abs((r-n)*m-(i-a)*y);if(g>jm){if(g*g<=o*(y*y+m*m)){s.push(d,p);return}}else if(y=d-(t+n)/2,m=p-(e+a)/2,y*y+m*m<=o){s.push(d,p);return}xn(s,t,e,h,c,d,p,o,l+1),xn(s,d,p,u,f,n,a,o,l+1)}function ec(s,t,e,r,i,n,a,o){let l=Math.abs(i-n);(!a&&i>n||a&&n>i)&&(l=2*Math.PI-l),o||(o=Math.max(6,Math.floor(6*Math.pow(r,1/3)*(l/Math.PI)))),o=Math.max(o,3);let h=l/o,c=i;h*=a?-1:1;for(let u=0;u<o+1;u++){const f=Math.cos(c),d=Math.sin(c),p=t+f*r,y=e+d*r;s.push(p,y),c+=h}}function Km(s,t,e,r,i,n){const a=s[s.length-2],l=s[s.length-1]-e,h=a-t,c=i-e,u=r-t,f=Math.abs(l*u-h*c);if(f<1e-8||n===0){(s[s.length-2]!==t||s[s.length-1]!==e)&&s.push(t,e);return}const d=l*l+h*h,p=c*c+u*u,y=l*c+h*u,m=n*Math.sqrt(d)/f,g=n*Math.sqrt(p)/f,x=m*y/d,_=g*y/p,b=m*u+g*h,S=m*c+g*l,v=h*(g+x),w=l*(g+x),P=u*(m+_),C=c*(m+_),A=Math.atan2(w-S,v-b),M=Math.atan2(C-S,P-b);ec(s,b+t,S+e,n,A,M,h*c>u*l)}const ar=Math.PI*2,zi={centerX:0,centerY:0,ang1:0,ang2:0},Ui=({x:s,y:t},e,r,i,n,a,o,l)=>{s*=e,t*=r;const h=i*s-n*t,c=n*s+i*t;return l.x=h+a,l.y=c+o,l};function Zm(s,t){const e=t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=t===1.5707963267948966?.551915024494:e,i=Math.cos(s),n=Math.sin(s),a=Math.cos(s+t),o=Math.sin(s+t);return[{x:i-n*r,y:n+i*r},{x:a+o*r,y:o-a*r},{x:a,y:o}]}const xo=(s,t,e,r)=>{const i=s*r-t*e<0?-1:1;let n=s*e+t*r;return n>1&&(n=1),n<-1&&(n=-1),i*Math.acos(n)},Qm=(s,t,e,r,i,n,a,o,l,h,c,u,f)=>{const d=Math.pow(i,2),p=Math.pow(n,2),y=Math.pow(c,2),m=Math.pow(u,2);let g=d*p-d*m-p*y;g<0&&(g=0),g/=d*m+p*y,g=Math.sqrt(g)*(a===o?-1:1);const x=g*i/n*u,_=g*-n/i*c,b=h*x-l*_+(s+e)/2,S=l*x+h*_+(t+r)/2,v=(c-x)/i,w=(u-_)/n,P=(-c-x)/i,C=(-u-_)/n,A=xo(1,0,v,w);let M=xo(v,w,P,C);o===0&&M>0&&(M-=ar),o===1&&M<0&&(M+=ar),f.centerX=b,f.centerY=S,f.ang1=A,f.ang2=M};function Jm(s,t,e,r,i,n,a,o=0,l=0,h=0){if(n===0||a===0)return;const c=Math.sin(o*ar/360),u=Math.cos(o*ar/360),f=u*(t-r)/2+c*(e-i)/2,d=-c*(t-r)/2+u*(e-i)/2;if(f===0&&d===0)return;n=Math.abs(n),a=Math.abs(a);const p=Math.pow(f,2)/Math.pow(n,2)+Math.pow(d,2)/Math.pow(a,2);p>1&&(n*=Math.sqrt(p),a*=Math.sqrt(p)),Qm(t,e,r,i,n,a,l,h,c,u,f,d,zi);let{ang1:y,ang2:m}=zi;const{centerX:g,centerY:x}=zi;let _=Math.abs(m)/(ar/4);Math.abs(1-_)<1e-7&&(_=1);const b=Math.max(Math.ceil(_),1);m/=b;let S=s[s.length-2],v=s[s.length-1];const w={x:0,y:0};for(let P=0;P<b;P++){const C=Zm(y,m),{x:A,y:M}=Ui(C[0],n,a,u,c,g,x,w),{x:E,y:N}=Ui(C[1],n,a,u,c,g,x,w),{x:$,y:Nt}=Ui(C[2],n,a,u,c,g,x,w);tc(s,S,v,A,M,E,N,$,Nt),S=$,v=Nt,y+=m}}function tg(s,t,e){const r=(a,o)=>{const l=o.x-a.x,h=o.y-a.y,c=Math.sqrt(l*l+h*h),u=l/c,f=h/c;return{len:c,nx:u,ny:f}},i=(a,o)=>{a===0?s.moveTo(o.x,o.y):s.lineTo(o.x,o.y)};let n=t[t.length-1];for(let a=0;a<t.length;a++){const o=t[a%t.length],l=o.radius??e;if(l<=0){i(a,o),n=o;continue}const h=t[(a+1)%t.length],c=r(o,n),u=r(o,h);if(c.len<1e-4||u.len<1e-4){i(a,o),n=o;continue}let f=Math.asin(c.nx*u.ny-c.ny*u.nx),d=1,p=!1;c.nx*u.nx-c.ny*-u.ny<0?f<0?f=Math.PI+f:(f=Math.PI-f,d=-1,p=!0):f>0&&(d=-1,p=!0);const y=f/2;let m,g=Math.abs(Math.cos(y)*l/Math.sin(y));g>Math.min(c.len/2,u.len/2)?(g=Math.min(c.len/2,u.len/2),m=Math.abs(g*Math.sin(y)/Math.cos(y))):m=l;const x=o.x+u.nx*g+-u.ny*m*d,_=o.y+u.ny*g+u.nx*m*d,b=Math.atan2(c.ny,c.nx)+Math.PI/2*d,S=Math.atan2(u.ny,u.nx)-Math.PI/2*d;a===0&&s.moveTo(x+Math.cos(b)*m,_+Math.sin(b)*m),s.arc(x,_,m,b,S,p),n=o}}function eg(s,t,e,r){const i=(o,l)=>Math.sqrt((o.x-l.x)**2+(o.y-l.y)**2),n=(o,l,h)=>({x:o.x+(l.x-o.x)*h,y:o.y+(l.y-o.y)*h}),a=t.length;for(let o=0;o<a;o++){const l=t[(o+1)%a],h=l.radius??e;if(h<=0){o===0?s.moveTo(l.x,l.y):s.lineTo(l.x,l.y);continue}const c=t[o],u=t[(o+2)%a],f=i(c,l);let d;if(f<1e-4)d=l;else{const m=Math.min(f/2,h);d=n(l,c,m/f)}const p=i(u,l);let y;if(p<1e-4)y=l;else{const m=Math.min(p/2,h);y=n(l,u,m/p)}o===0?s.moveTo(d.x,d.y):s.lineTo(d.x,d.y),s.quadraticCurveTo(l.x,l.y,y.x,y.y,r)}}const sg=new ct;class rg{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new qt,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();const r=this._currentPoly.points,i=r[r.length-2],n=r[r.length-1];return(i!==t||n!==e)&&r.push(t,e),this}arc(t,e,r,i,n,a){this._ensurePoly(!1);const o=this._currentPoly.points;return ec(o,t,e,r,i,n,a),this}arcTo(t,e,r,i,n){this._ensurePoly();const a=this._currentPoly.points;return Km(a,t,e,r,i,n),this}arcToSvg(t,e,r,i,n,a,o){const l=this._currentPoly.points;return Jm(l,this._currentPoly.lastX,this._currentPoly.lastY,a,o,t,e,r,i,n),this}bezierCurveTo(t,e,r,i,n,a,o){this._ensurePoly();const l=this._currentPoly;return tc(this._currentPoly.points,l.lastX,l.lastY,t,e,r,i,n,a,o),this}quadraticCurveTo(t,e,r,i,n){this._ensurePoly();const a=this._currentPoly;return Ym(this._currentPoly.points,a.lastX,a.lastY,t,e,r,i,n),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0),t.transform(e));const r=this.shapePrimitives,i=r.length;for(let n=0;n<t.instructions.length;n++){const a=t.instructions[n];this[a.action](...a.data)}if(t.checkForHoles&&r.length-i>1){let n=null;for(let a=i;a<r.length;a++){const o=r[a];if(o.shape.type==="polygon"){const l=o.shape,h=n?.shape;h&&h.containsPolygon(l)?(n.holes||(n.holes=[]),n.holes.push(o),r.copyWithin(a,a+1),r.length--,a--):n=o}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,r,i,n){return this.drawShape(new ct(t,e,r,i),n),this}circle(t,e,r,i){return this.drawShape(new $n(t,e,r),i),this}poly(t,e,r){const i=new ir(t);return i.closePath=e,this.drawShape(i,r),this}regularPoly(t,e,r,i,n=0,a){i=Math.max(i|0,3);const o=-1*Math.PI/2+n,l=Math.PI*2/i,h=[];for(let c=0;c<i;c++){const u=o-c*l;h.push(t+r*Math.cos(u),e+r*Math.sin(u))}return this.poly(h,!0,a),this}roundPoly(t,e,r,i,n,a=0,o){if(i=Math.max(i|0,3),n<=0)return this.regularPoly(t,e,r,i,a);const l=r*Math.sin(Math.PI/i)-.001;n=Math.min(n,l);const h=-1*Math.PI/2+a,c=Math.PI*2/i,u=(i-2)*Math.PI/i/2;for(let f=0;f<i;f++){const d=f*c+h,p=t+r*Math.cos(d),y=e+r*Math.sin(d),m=d+Math.PI+u,g=d-Math.PI-u,x=p+n*Math.cos(m),_=y+n*Math.sin(m),b=p+n*Math.cos(g),S=y+n*Math.sin(g);f===0?this.moveTo(x,_):this.lineTo(x,_),this.quadraticCurveTo(p,y,b,S,o)}return this.closePath()}roundShape(t,e,r=!1,i){return t.length<3?this:(r?eg(this,t,e,i):tg(this,t,e),this.closePath())}filletRect(t,e,r,i,n){if(n===0)return this.rect(t,e,r,i);const a=Math.min(r,i)/2,o=Math.min(a,Math.max(-a,n)),l=t+r,h=e+i,c=o<0?-o:0,u=Math.abs(o);return this.moveTo(t,e+u).arcTo(t+c,e+c,t+u,e,u).lineTo(l-u,e).arcTo(l-c,e+c,l,e+u,u).lineTo(l,h-u).arcTo(l-c,h-c,t+r-u,h,u).lineTo(t+u,h).arcTo(t+c,h-c,t,h-u,u).closePath()}chamferRect(t,e,r,i,n,a){if(n<=0)return this.rect(t,e,r,i);const o=Math.min(n,Math.min(r,i)/2),l=t+r,h=e+i,c=[t+o,e,l-o,e,l,e+o,l,h-o,l-o,h,t+o,h,t,h-o,t,e+o];for(let u=c.length-1;u>=2;u-=2)c[u]===c[u-2]&&c[u-1]===c[u-3]&&c.splice(u-1,2);return this.poly(c,!0,a)}ellipse(t,e,r,i,n){return this.drawShape(new Vn(t,e,r,i),n),this}roundRect(t,e,r,i,n,a){return this.drawShape(new Wn(t,e,r,i,n),a),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let r=this._currentPoly;return r&&this.endPoly(),r=new ir,r.points.push(t,e),this._currentPoly=r,this}endPoly(t=!1){const e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new ir,t)){const e=this.shapePrimitives[this.shapePrimitives.length-1];if(e){let r=e.shape.x,i=e.shape.y;if(e.transform&&!e.transform.isIdentity()){const n=e.transform,a=r;r=n.a*r+n.c*i+n.tx,i=n.b*a+n.d*i+n.ty}this._currentPoly.points.push(r,i)}else this._currentPoly.points.push(0,0)}}buildPath(){const t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){const r=t.instructions[e];this[r.action](...r.data)}this.finish()}get bounds(){const t=this._bounds;t.clear();const e=this.shapePrimitives;for(let r=0;r<e.length;r++){const i=e[r],n=i.shape.getBounds(sg);i.transform?t.addRect(n,i.transform):t.addRect(n)}return t}}class ce{constructor(t,e=!1){this.instructions=[],this.uid=J("graphicsPath"),this._dirty=!0,this.checkForHoles=e,typeof t=="string"?Cp(t,this):this.instructions=t?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new rg(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,r,i,n){const a=this.instructions[this.instructions.length-1],o=this.getLastPoint(yt.shared);let l=0,h=0;if(!a||a.action!=="bezierCurveTo")l=o.x,h=o.y;else{l=a.data[2],h=a.data[3];const c=o.x,u=o.y;l=c+(c-l),h=u+(u-h)}return this.instructions.push({action:"bezierCurveTo",data:[l,h,t,e,r,i,n]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,r){const i=this.instructions[this.instructions.length-1],n=this.getLastPoint(yt.shared);let a=0,o=0;if(!i||i.action!=="quadraticCurveTo")a=n.x,o=n.y;else{a=i.data[0],o=i.data[1];const l=n.x,h=n.y;a=l+(l-a),o=h+(h-o)}return this.instructions.push({action:"quadraticCurveTo",data:[a,o,t,e,r]}),this._dirty=!0,this}rect(t,e,r,i,n){return this.instructions.push({action:"rect",data:[t,e,r,i,n]}),this._dirty=!0,this}circle(t,e,r,i){return this.instructions.push({action:"circle",data:[t,e,r,i]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,r,i,n,a,o){n||(n=i/2);const l=-1*Math.PI/2+a,h=r*2,c=Math.PI*2/h,u=[];for(let f=0;f<h;f++){const d=f%2?n:i,p=f*c+l;u.push(t+d*Math.cos(p),e+d*Math.sin(p))}return this.poly(u,!0,o),this}clone(t=!1){const e=new ce;if(e.checkForHoles=this.checkForHoles,!t)e.instructions=this.instructions.slice();else for(let r=0;r<this.instructions.length;r++){const i=this.instructions[r];e.instructions.push({action:i.action,data:i.data.slice()})}return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;const e=t.a,r=t.b,i=t.c,n=t.d,a=t.tx,o=t.ty;let l=0,h=0,c=0,u=0,f=0,d=0,p=0,y=0;for(let m=0;m<this.instructions.length;m++){const g=this.instructions[m],x=g.data;switch(g.action){case"moveTo":case"lineTo":l=x[0],h=x[1],x[0]=e*l+i*h+a,x[1]=r*l+n*h+o;break;case"bezierCurveTo":c=x[0],u=x[1],f=x[2],d=x[3],l=x[4],h=x[5],x[0]=e*c+i*u+a,x[1]=r*c+n*u+o,x[2]=e*f+i*d+a,x[3]=r*f+n*d+o,x[4]=e*l+i*h+a,x[5]=r*l+n*h+o;break;case"quadraticCurveTo":c=x[0],u=x[1],l=x[2],h=x[3],x[0]=e*c+i*u+a,x[1]=r*c+n*u+o,x[2]=e*l+i*h+a,x[3]=r*l+n*h+o;break;case"arcToSvg":l=x[5],h=x[6],p=x[0],y=x[1],x[0]=e*p+i*y,x[1]=r*p+n*y,x[5]=e*l+i*h+a,x[6]=r*l+n*h+o;break;case"circle":x[4]=Hs(x[3],t);break;case"rect":x[4]=Hs(x[4],t);break;case"ellipse":x[8]=Hs(x[8],t);break;case"roundRect":x[5]=Hs(x[5],t);break;case"addPath":x[0].transform(t);break;case"poly":x[2]=Hs(x[2],t);break;default:q("unknown transform action",g.action);break}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,r=this.instructions[e];if(!r)return t.x=0,t.y=0,t;for(;r.action==="closePath";){if(e--,e<0)return t.x=0,t.y=0,t;r=this.instructions[e]}switch(r.action){case"moveTo":case"lineTo":t.x=r.data[0],t.y=r.data[1];break;case"quadraticCurveTo":t.x=r.data[2],t.y=r.data[3];break;case"bezierCurveTo":t.x=r.data[4],t.y=r.data[5];break;case"arc":case"arcToSvg":t.x=r.data[5],t.y=r.data[6];break;case"addPath":r.data[0].getLastPoint(t);break}return t}}function Hs(s,t){return s?s.prepend(t):t.clone()}function Y(s,t,e){const r=s.getAttribute(t);return r?Number(r):e}function ig(s,t){const e=s.querySelectorAll("defs");for(let r=0;r<e.length;r++){const i=e[r];for(let n=0;n<i.children.length;n++){const a=i.children[n];switch(a.nodeName.toLowerCase()){case"lineargradient":t.defs[a.id]=ng(a);break;case"radialgradient":t.defs[a.id]=ag();break}}}}function ng(s){const t=Y(s,"x1",0),e=Y(s,"y1",0),r=Y(s,"x2",1),i=Y(s,"y2",0),n=s.getAttribute("gradientUnits")||"objectBoundingBox",a=new br(t,e,r,i,n==="objectBoundingBox"?"local":"global");for(let o=0;o<s.children.length;o++){const l=s.children[o],h=Y(l,"offset",0),c=Lt.shared.setValue(l.getAttribute("stop-color")).toNumber();a.addColorStop(h,c)}return a}function ag(s){return q("[SVG Parser] Radial gradients are not yet supported"),new br(0,0,1,0)}function bo(s){const t=s.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return t?t[1]:""}const vo={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function sc(s,t){const e=s.getAttribute("style"),r={},i={},n={strokeStyle:r,fillStyle:i,useFill:!1,useStroke:!1};for(const a in vo){const o=s.getAttribute(a);o&&wo(t,n,a,o.trim())}if(e){const a=e.split(";");for(let o=0;o<a.length;o++){const l=a[o].trim(),[h,c]=l.split(":");vo[h]&&wo(t,n,h,c.trim())}}return{strokeStyle:n.useStroke?r:null,fillStyle:n.useFill?i:null,useFill:n.useFill,useStroke:n.useStroke}}function wo(s,t,e,r){switch(e){case"stroke":if(r!=="none"){if(r.startsWith("url(")){const i=bo(r);t.strokeStyle.fill=s.defs[i]}else t.strokeStyle.color=Lt.shared.setValue(r).toNumber();t.useStroke=!0}break;case"stroke-width":t.strokeStyle.width=Number(r);break;case"fill":if(r!=="none"){if(r.startsWith("url(")){const i=bo(r);t.fillStyle.fill=s.defs[i]}else t.fillStyle.color=Lt.shared.setValue(r).toNumber();t.useFill=!0}break;case"fill-opacity":t.fillStyle.alpha=Number(r);break;case"stroke-opacity":t.strokeStyle.alpha=Number(r);break;case"opacity":t.fillStyle.alpha=Number(r),t.strokeStyle.alpha=Number(r);break}}function og(s){if(s.length<=2)return!0;const t=s.map(o=>o.area).sort((o,l)=>l-o),[e,r]=t,i=t[t.length-1],n=e/r,a=r/i;return!(n>3&&a<2)}function lg(s){return s.split(/(?=[Mm])/).filter(r=>r.trim().length>0)}function hg(s){const t=s.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!t||t.length<4)return 0;const e=t.map(Number),r=[],i=[];for(let c=0;c<e.length;c+=2)c+1<e.length&&(r.push(e[c]),i.push(e[c+1]));if(r.length===0||i.length===0)return 0;const n=Math.min(...r),a=Math.max(...r),o=Math.min(...i),l=Math.max(...i);return(a-n)*(l-o)}function Ao(s,t){const e=new ce(s,!1);for(const r of e.instructions)t.instructions.push(r)}function cg(s,t){if(typeof s=="string"){const a=document.createElement("div");a.innerHTML=s.trim(),s=a.querySelector("svg")}const e={context:t,defs:{},path:new ce};ig(s,e);const r=s.children,{fillStyle:i,strokeStyle:n}=sc(s,e);for(let a=0;a<r.length;a++){const o=r[a];o.nodeName.toLowerCase()!=="defs"&&rc(o,e,i,n)}return t}function rc(s,t,e,r){const i=s.children,{fillStyle:n,strokeStyle:a}=sc(s,t);n&&e?e={...e,...n}:n&&(e=n),a&&r?r={...r,...a}:a&&(r=a);const o=!e&&!r;o&&(e={color:0});let l,h,c,u,f,d,p,y,m,g,x,_,b,S,v,w,P;switch(s.nodeName.toLowerCase()){case"path":{S=s.getAttribute("d");const C=s.getAttribute("fill-rule"),A=lg(S),M=C==="evenodd",E=A.length>1;if(M&&E){const $=A.map(T=>({path:T,area:hg(T)}));if($.sort((T,R)=>R.area-T.area),A.length>3||!og($))for(let T=0;T<$.length;T++){const R=$[T],me=T===0;t.context.beginPath();const O=new ce(void 0,!0);Ao(R.path,O),t.context.path(O),me?(e&&t.context.fill(e),r&&t.context.stroke(r)):t.context.cut()}else for(let T=0;T<$.length;T++){const R=$[T],me=T%2===1;t.context.beginPath();const O=new ce(void 0,!0);Ao(R.path,O),t.context.path(O),me?t.context.cut():(e&&t.context.fill(e),r&&t.context.stroke(r))}}else{const $=C?C==="evenodd":!0;v=new ce(S,$),t.context.path(v),e&&t.context.fill(e),r&&t.context.stroke(r)}break}case"circle":p=Y(s,"cx",0),y=Y(s,"cy",0),m=Y(s,"r",0),t.context.ellipse(p,y,m,m),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"rect":l=Y(s,"x",0),h=Y(s,"y",0),w=Y(s,"width",0),P=Y(s,"height",0),g=Y(s,"rx",0),x=Y(s,"ry",0),g||x?t.context.roundRect(l,h,w,P,g||x):t.context.rect(l,h,w,P),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"ellipse":p=Y(s,"cx",0),y=Y(s,"cy",0),g=Y(s,"rx",0),x=Y(s,"ry",0),t.context.beginPath(),t.context.ellipse(p,y,g,x),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"line":c=Y(s,"x1",0),u=Y(s,"y1",0),f=Y(s,"x2",0),d=Y(s,"y2",0),t.context.beginPath(),t.context.moveTo(c,u),t.context.lineTo(f,d),r&&t.context.stroke(r);break;case"polygon":b=s.getAttribute("points"),_=b.match(/-?\d+/g).map(C=>parseInt(C,10)),t.context.poly(_,!0),e&&t.context.fill(e),r&&t.context.stroke(r);break;case"polyline":b=s.getAttribute("points"),_=b.match(/-?\d+/g).map(C=>parseInt(C,10)),t.context.poly(_,!1),r&&t.context.stroke(r);break;case"g":case"svg":break;default:{q(`[SVG parser] <${s.nodeName}> elements unsupported`);break}}o&&(e=null);for(let C=0;C<i.length;C++)rc(i[C],t,e,r)}const So={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class ug{constructor(t,e){this.uid=J("fillPattern"),this._tick=0,this.transform=new D,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=So[e].addressModeU,t.source.style.addressModeV=So[e].addressModeV)}setTransform(t){const e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._tick++}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture=t,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}function dg(s){return Lt.isColorLike(s)}function Co(s){return s instanceof ug}function Po(s){return s instanceof br}function fg(s){return s instanceof U}function pg(s,t,e){const r=Lt.shared.setValue(t??0);return s.color=r.toNumber(),s.alpha=r.alpha===1?e.alpha:r.alpha,s.texture=U.WHITE,{...e,...s}}function mg(s,t,e){return s.texture=t,{...e,...s}}function Mo(s,t,e){return s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,{...e,...s}}function To(s,t,e){return t.buildGradient(),s.fill=t,s.color=16777215,s.texture=t.texture,s.matrix=t.transform,s.textureSpace=t.textureSpace,{...e,...s}}function gg(s,t){const e={...t,...s},r=Lt.shared.setValue(e.color);return e.alpha*=r.alpha,e.color=r.toNumber(),e}function Zs(s,t){if(s==null)return null;const e={},r=s;return dg(s)?pg(e,s,t):fg(s)?mg(e,s,t):Co(s)?Mo(e,s,t):Po(s)?To(e,s,t):r.fill&&Co(r.fill)?Mo(r,r.fill,t):r.fill&&Po(r.fill)?To(r,r.fill,t):gg(r,t)}function ko(s,t){const{width:e,alignment:r,miterLimit:i,cap:n,join:a,pixelLine:o,...l}=t,h=Zs(s,l);return h?{width:e,alignment:r,miterLimit:i,cap:n,join:a,pixelLine:o,...h}:null}const yg=new yt,Eo=new D,qn=class Jt extends pe{constructor(){super(...arguments),this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this.uid=J("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this.destroyed=!1,this._activePath=new ce,this._transform=new D,this._fillStyle={...Jt.defaultFillStyle},this._strokeStyle={...Jt.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new qt,this._boundsDirty=!0}clone(){const t=new Jt;return t.batchMode=this.batchMode,t.instructions=this.instructions.slice(),t._activePath=this._activePath.clone(),t._transform=this._transform.clone(),t._fillStyle={...this._fillStyle},t._strokeStyle={...this._strokeStyle},t._stateStack=this._stateStack.slice(),t._bounds=this._bounds.clone(),t._boundsDirty=!0,t}get fillStyle(){return this._fillStyle}set fillStyle(t){this._fillStyle=Zs(t,Jt.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(t){this._strokeStyle=ko(t,Jt.defaultStrokeStyle)}setFillStyle(t){return this._fillStyle=Zs(t,Jt.defaultFillStyle),this}setStrokeStyle(t){return this._strokeStyle=Zs(t,Jt.defaultStrokeStyle),this}texture(t,e,r,i,n,a){return this.instructions.push({action:"texture",data:{image:t,dx:r||0,dy:i||0,dw:n||t.frame.width,dh:a||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e||e===0?Lt.shared.setValue(e).toNumber():16777215}}),this.onUpdate(),this}beginPath(){return this._activePath=new ce,this}fill(t,e){let r;const i=this.instructions[this.instructions.length-1];return this._tick===0&&i?.action==="stroke"?r=i.data.path:r=this._activePath.clone(),r?(t!=null&&(e!==void 0&&typeof t=="number"&&(V(rt,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),t={color:t,alpha:e}),this._fillStyle=Zs(t,Jt.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}_initNextPathLocation(){const{x:t,y:e}=this._activePath.getLastPoint(yt.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(t){let e;const r=this.instructions[this.instructions.length-1];return this._tick===0&&r?.action==="fill"?e=r.data.path:e=this._activePath.clone(),e?(t!=null&&(this._strokeStyle=ko(t,Jt.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:e}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0,this):this}cut(){for(let t=0;t<2;t++){const e=this.instructions[this.instructions.length-1-t],r=this._activePath.clone();if(e&&(e.action==="stroke"||e.action==="fill"))if(e.data.hole)e.data.hole.addPath(r);else{e.data.hole=r;break}}return this._initNextPathLocation(),this}arc(t,e,r,i,n,a){this._tick++;const o=this._transform;return this._activePath.arc(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,r,i,n,a),this}arcTo(t,e,r,i,n){this._tick++;const a=this._transform;return this._activePath.arcTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*r+a.c*i+a.tx,a.b*r+a.d*i+a.ty,n),this}arcToSvg(t,e,r,i,n,a,o){this._tick++;const l=this._transform;return this._activePath.arcToSvg(t,e,r,i,n,l.a*a+l.c*o+l.tx,l.b*a+l.d*o+l.ty),this}bezierCurveTo(t,e,r,i,n,a,o){this._tick++;const l=this._transform;return this._activePath.bezierCurveTo(l.a*t+l.c*e+l.tx,l.b*t+l.d*e+l.ty,l.a*r+l.c*i+l.tx,l.b*r+l.d*i+l.ty,l.a*n+l.c*a+l.tx,l.b*n+l.d*a+l.ty,o),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,e,r,i){return this._tick++,this._activePath.ellipse(t,e,r,i,this._transform.clone()),this}circle(t,e,r){return this._tick++,this._activePath.circle(t,e,r,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;const r=this._transform;return this._activePath.lineTo(r.a*t+r.c*e+r.tx,r.b*t+r.d*e+r.ty),this}moveTo(t,e){this._tick++;const r=this._transform,i=this._activePath.instructions,n=r.a*t+r.c*e+r.tx,a=r.b*t+r.d*e+r.ty;return i.length===1&&i[0].action==="moveTo"?(i[0].data[0]=n,i[0].data[1]=a,this):(this._activePath.moveTo(n,a),this)}quadraticCurveTo(t,e,r,i,n){this._tick++;const a=this._transform;return this._activePath.quadraticCurveTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*r+a.c*i+a.tx,a.b*r+a.d*i+a.ty,n),this}rect(t,e,r,i){return this._tick++,this._activePath.rect(t,e,r,i,this._transform.clone()),this}roundRect(t,e,r,i,n){return this._tick++,this._activePath.roundRect(t,e,r,i,n,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,r,i,n=0,a){return this._tick++,this._activePath.regularPoly(t,e,r,i,n,a),this}roundPoly(t,e,r,i,n,a){return this._tick++,this._activePath.roundPoly(t,e,r,i,n,a),this}roundShape(t,e,r,i){return this._tick++,this._activePath.roundShape(t,e,r,i),this}filletRect(t,e,r,i,n){return this._tick++,this._activePath.filletRect(t,e,r,i,n),this}chamferRect(t,e,r,i,n,a){return this._tick++,this._activePath.chamferRect(t,e,r,i,n,a),this}star(t,e,r,i,n=0,a=0){return this._tick++,this._activePath.star(t,e,r,i,n,a,this._transform.clone()),this}svg(t){return this._tick++,cg(t,this),this}restore(){const t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,r,i,n,a){return t instanceof D?(this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty),this):(this._transform.set(t,e,r,i,n,a),this)}transform(t,e,r,i,n,a){return t instanceof D?(this._transform.append(t),this):(Eo.set(t,e,r,i,n,a),this._transform.append(Eo),this)}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,!this.dirty&&(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;const t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){const r=this.instructions[e],i=r.action;if(i==="fill"){const n=r.data;t.addBounds(n.path.bounds)}else if(i==="texture"){const n=r.data;t.addFrame(n.dx,n.dy,n.dx+n.dw,n.dy+n.dh,n.transform)}if(i==="stroke"){const n=r.data,a=n.style.alignment,o=n.style.width*(1-a),l=n.path.bounds;t.addFrame(l.minX-o,l.minY-o,l.maxX+o,l.maxY+o)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;const e=this.instructions;let r=!1;for(let i=0;i<e.length;i++){const n=e[i],a=n.data,o=a.path;if(!n.action||!o)continue;const l=a.style,h=o.shapePath.shapePrimitives;for(let c=0;c<h.length;c++){const u=h[c].shape;if(!l||!u)continue;const f=h[c].transform,d=f?f.applyInverse(t,yg):t;if(n.action==="fill")r=u.contains(d.x,d.y);else{const y=l;r=u.strokeContains(d.x,d.y,y.width,y.alignment)}const p=a.hole;if(p){const y=p.shapePath?.shapePrimitives;if(y)for(let m=0;m<y.length;m++)y[m].shape.contains(d.x,d.y)&&(r=!1)}if(r)return!0}}return r}unload(){this.emit("unload",this);for(const t in this._gpuData)this._gpuData[t]?.destroy();this._gpuData=Object.create(null)}destroy(t=!1){if(this.destroyed)return;if(this.destroyed=!0,this._stateStack.length=0,this._transform=null,this.unload(),this.emit("destroy",this),this.removeAllListeners(),typeof t=="boolean"?t:t?.texture){const r=typeof t=="boolean"?t:t?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(r)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(r))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}};qn.defaultFillStyle={color:16777215,alpha:1,texture:U.WHITE,matrix:null,fill:null,textureSpace:"local"};qn.defaultStrokeStyle={width:1,color:16777215,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:U.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1};let as=qn;function Kn(s,t=1){const e=Bs.RETINA_PREFIX?.exec(s);return e?parseFloat(e[1]):t}function Zn(s,t,e){s.label=e,s._sourceOrigin=e;const r=new U({source:s,label:e}),i=()=>{delete t.promiseCache[e],ht.has(e)&&ht.remove(e)};return r.source.once("destroy",()=>{t.promiseCache[e]&&(q("[Assets] A TextureSource managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the TextureSource."),i())}),r.once("destroy",()=>{s.destroyed||(q("[Assets] A Texture managed by Assets was destroyed instead of unloaded! Use Assets.unload() instead of destroying the Texture."),i())}),r}const _g=".svg",xg="image/svg+xml",bg={extension:{type:k.LoadParser,priority:ke.Low,name:"loadSVG"},name:"loadSVG",id:"svg",config:{crossOrigin:"anonymous",parseAsGraphicsContext:!1},test(s){return Fs(s,xg)||Gs(s,_g)},async load(s,t,e){return t.data?.parseAsGraphicsContext??this.config.parseAsGraphicsContext?wg(s):vg(s,t,e,this.config.crossOrigin)},unload(s){s.destroy(!0)}};async function vg(s,t,e,r){const i=await tt.get().fetch(s),n=tt.get().createImage();n.src=`data:image/svg+xml;charset=utf-8,${encodeURIComponent(await i.text())}`,n.crossOrigin=r,await n.decode();const a=t.data?.width??n.width,o=t.data?.height??n.height,l=t.data?.resolution||Kn(s),h=Math.ceil(a*l),c=Math.ceil(o*l),u=tt.get().createCanvas(h,c),f=u.getContext("2d");f.imageSmoothingEnabled=!0,f.imageSmoothingQuality="high",f.drawImage(n,0,0,a*l,o*l);const{parseAsGraphicsContext:d,...p}=t.data??{},y=new vs({resource:u,alphaMode:"premultiply-alpha-on-upload",resolution:l,...p});return Zn(y,e,s)}async function wg(s){const e=await(await tt.get().fetch(s)).text(),r=new as;return r.svg(e),r}const Ag=`(function () {
    'use strict';

    const WHITE_PNG = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=";
    async function checkImageBitmap() {
      try {
        if (typeof createImageBitmap !== "function") return false;
        const response = await fetch(WHITE_PNG);
        const imageBlob = await response.blob();
        const imageBitmap = await createImageBitmap(imageBlob);
        return imageBitmap.width === 1 && imageBitmap.height === 1;
      } catch (_e) {
        return false;
      }
    }
    void checkImageBitmap().then((result) => {
      self.postMessage(result);
    });

})();
`;let fs=null,bn=class{constructor(){fs||(fs=URL.createObjectURL(new Blob([Ag],{type:"application/javascript"}))),this.worker=new Worker(fs)}};bn.revokeObjectURL=function(){fs&&(URL.revokeObjectURL(fs),fs=null)};const Sg=`(function () {
    'use strict';

    async function loadImageBitmap(url, alphaMode) {
      const response = await fetch(url);
      if (!response.ok) {
        throw new Error(\`[WorkerManager.loadImageBitmap] Failed to fetch \${url}: \${response.status} \${response.statusText}\`);
      }
      const imageBlob = await response.blob();
      return alphaMode === "premultiplied-alpha" ? createImageBitmap(imageBlob, { premultiplyAlpha: "none" }) : createImageBitmap(imageBlob);
    }
    self.onmessage = async (event) => {
      try {
        const imageBitmap = await loadImageBitmap(event.data.data[0], event.data.data[1]);
        self.postMessage({
          data: imageBitmap,
          uuid: event.data.uuid,
          id: event.data.id
        }, [imageBitmap]);
      } catch (e) {
        self.postMessage({
          error: e,
          uuid: event.data.uuid,
          id: event.data.id
        });
      }
    };

})();
`;let ps=null;class ic{constructor(){ps||(ps=URL.createObjectURL(new Blob([Sg],{type:"application/javascript"}))),this.worker=new Worker(ps)}}ic.revokeObjectURL=function(){ps&&(URL.revokeObjectURL(ps),ps=null)};let Io=0,Ni;class Cg{constructor(){this._initialized=!1,this._createdWorkers=0,this._workerPool=[],this._queue=[],this._resolveHash={}}isImageBitmapSupported(){return this._isImageBitmapSupported!==void 0?this._isImageBitmapSupported:(this._isImageBitmapSupported=new Promise(t=>{const{worker:e}=new bn;e.addEventListener("message",r=>{e.terminate(),bn.revokeObjectURL(),t(r.data)})}),this._isImageBitmapSupported)}loadImageBitmap(t,e){return this._run("loadImageBitmap",[t,e?.data?.alphaMode])}async _initWorkers(){this._initialized||(this._initialized=!0)}_getWorker(){Ni===void 0&&(Ni=navigator.hardwareConcurrency||4);let t=this._workerPool.pop();return!t&&this._createdWorkers<Ni&&(this._createdWorkers++,t=new ic().worker,t.addEventListener("message",e=>{this._complete(e.data),this._returnWorker(e.target),this._next()})),t}_returnWorker(t){this._workerPool.push(t)}_complete(t){this._resolveHash[t.uuid]&&(t.error!==void 0?this._resolveHash[t.uuid].reject(t.error):this._resolveHash[t.uuid].resolve(t.data),delete this._resolveHash[t.uuid])}async _run(t,e){await this._initWorkers();const r=new Promise((i,n)=>{this._queue.push({id:t,arguments:e,resolve:i,reject:n})});return this._next(),r}_next(){if(!this._queue.length)return;const t=this._getWorker();if(!t)return;const e=this._queue.pop(),r=e.id;this._resolveHash[Io]={resolve:e.resolve,reject:e.reject},t.postMessage({data:e.arguments,uuid:Io++,id:r})}reset(){this._workerPool.forEach(t=>t.terminate()),this._workerPool.length=0,Object.values(this._resolveHash).forEach(({reject:t})=>{t?.(new Error("WorkerManager has been reset before completion"))}),this._resolveHash={},this._queue.length=0,this._initialized=!1,this._createdWorkers=0}}const Ro=new Cg,Pg=[".jpeg",".jpg",".png",".webp",".avif"],Mg=["image/jpeg","image/png","image/webp","image/avif"];async function Tg(s,t){const e=await tt.get().fetch(s);if(!e.ok)throw new Error(`[loadImageBitmap] Failed to fetch ${s}: ${e.status} ${e.statusText}`);const r=await e.blob();return t?.data?.alphaMode==="premultiplied-alpha"?createImageBitmap(r,{premultiplyAlpha:"none"}):createImageBitmap(r)}const nc={name:"loadTextures",id:"texture",extension:{type:k.LoadParser,priority:ke.High,name:"loadTextures"},config:{preferWorkers:!0,preferCreateImageBitmap:!0,crossOrigin:"anonymous"},test(s){return Fs(s,Mg)||Gs(s,Pg)},async load(s,t,e){let r=null;globalThis.createImageBitmap&&this.config.preferCreateImageBitmap?this.config.preferWorkers&&await Ro.isImageBitmapSupported()?r=await Ro.loadImageBitmap(s,t):r=await Tg(s,t):r=await new Promise((n,a)=>{r=tt.get().createImage(),r.crossOrigin=this.config.crossOrigin,r.src=s,r.complete?n(r):(r.onload=()=>{n(r)},r.onerror=a)});const i=new vs({resource:r,alphaMode:"premultiply-alpha-on-upload",resolution:t.data?.resolution||Kn(s),...t.data});return Zn(i,e,s)},unload(s){s.destroy(!0)}},kg=[".mp4",".m4v",".webm",".ogg",".ogv",".h264",".avi",".mov"];let $i,Vi;function Eg(s,t,e){e===void 0&&!t.startsWith("data:")?s.crossOrigin=Rg(t):e!==!1&&(s.crossOrigin=typeof e=="string"?e:"anonymous")}function Ig(s){return new Promise((t,e)=>{s.addEventListener("canplaythrough",r),s.addEventListener("error",i),s.load();function r(){n(),t()}function i(a){n(),e(a)}function n(){s.removeEventListener("canplaythrough",r),s.removeEventListener("error",i)}})}function Rg(s,t=globalThis.location){if(s.startsWith("data:"))return"";t||(t=globalThis.location);const e=new URL(s,document.baseURI);return e.hostname!==t.hostname||e.port!==t.port||e.protocol!==t.protocol?"anonymous":""}function Bg(){const s=[],t=[];for(const e of kg){const r=rr.MIME_TYPES[e.substring(1)]||`video/${e.substring(1)}`;ai(r)&&(s.push(e),t.includes(r)||t.push(r))}return{validVideoExtensions:s,validVideoMime:t}}const Fg={name:"loadVideo",id:"video",extension:{type:k.LoadParser,name:"loadVideo"},test(s){if(!$i||!Vi){const{validVideoExtensions:r,validVideoMime:i}=Bg();$i=r,Vi=i}const t=Fs(s,Vi),e=Gs(s,$i);return t||e},async load(s,t,e){const r={...rr.defaultOptions,resolution:t.data?.resolution||Kn(s),alphaMode:t.data?.alphaMode||await dh(),...t.data},i=document.createElement("video"),n={preload:r.autoLoad!==!1?"auto":void 0,"webkit-playsinline":r.playsinline!==!1?"":void 0,playsinline:r.playsinline!==!1?"":void 0,muted:r.muted===!0?"":void 0,loop:r.loop===!0?"":void 0,autoplay:r.autoPlay!==!1?"":void 0};Object.keys(n).forEach(l=>{const h=n[l];h!==void 0&&i.setAttribute(l,h)}),r.muted===!0&&(i.muted=!0),Eg(i,s,r.crossorigin);const a=document.createElement("source");let o;if(r.mime)o=r.mime;else if(s.startsWith("data:"))o=s.slice(5,s.indexOf(";"));else if(!s.startsWith("blob:")){const l=s.split("?")[0].slice(s.lastIndexOf(".")+1).toLowerCase();o=rr.MIME_TYPES[l]||`video/${l}`}return a.src=s,o&&(a.type=o),new Promise((l,h)=>{r.preload&&!r.autoPlay&&i.load(),i.addEventListener("canplay",c),i.addEventListener("error",u),a.addEventListener("error",u),i.appendChild(a);async function c(){const d=new rr({...r,resource:i});f(),t.data.preload&&await Ig(i),l(Zn(d,e,s))}function u(d){f(),h(d)}function f(){i.removeEventListener("canplay",c),i.removeEventListener("error",u),a.removeEventListener("error",u)}})},unload(s){s.destroy(!0)}},ac={extension:{type:k.ResolveParser,name:"resolveTexture"},test:nc.test,parse:s=>({resolution:parseFloat(Bs.RETINA_PREFIX.exec(s)?.[1]??"1"),format:s.split(".").pop(),src:s})},Gg={extension:{type:k.ResolveParser,priority:-2,name:"resolveJson"},test:s=>Bs.RETINA_PREFIX.test(s)&&s.endsWith(".json"),parse:ac.parse};class Lg{constructor(){this._detections=[],this._initialized=!1,this.resolver=new Bs,this.loader=new op,this.cache=ht,this._backgroundLoader=new Qf(this.loader),this._backgroundLoader.active=!0,this.reset()}async init(t={}){if(this._initialized){q("[Assets]AssetManager already initialized, did you load before calling this Assets.init()?");return}if(this._initialized=!0,t.defaultSearchParams&&this.resolver.setDefaultSearchParams(t.defaultSearchParams),t.basePath&&(this.resolver.basePath=t.basePath),t.bundleIdentifier&&this.resolver.setBundleIdentifier(t.bundleIdentifier),t.manifest){let n=t.manifest;typeof n=="string"&&(n=await this.load(n)),this.resolver.addManifest(n)}const e=t.texturePreference?.resolution??1,r=typeof e=="number"?[e]:e,i=await this._detectFormats({preferredFormats:t.texturePreference?.format,skipDetections:t.skipDetections,detections:this._detections});this.resolver.prefer({params:{format:i,resolution:r}}),t.preferences&&this.setPreferences(t.preferences),t.loadOptions&&(this.loader.loadOptions={...this.loader.loadOptions,...t.loadOptions})}add(t){this.resolver.add(t)}async load(t,e){this._initialized||await this.init();const r=Yr(t),i=Ht(t).map(o=>{if(typeof o!="string"){const l=this.resolver.getAlias(o);return l.some(h=>!this.resolver.hasKey(h))&&this.add(o),Array.isArray(l)?l[0]:l}return this.resolver.hasKey(o)||this.add({alias:o,src:o}),o}),n=this.resolver.resolve(i),a=await this._mapLoadToResolve(n,e);return r?a[i[0]]:a}addBundle(t,e){this.resolver.addBundle(t,e)}async loadBundle(t,e){this._initialized||await this.init();let r=!1;typeof t=="string"&&(r=!0,t=[t]);const i=this.resolver.resolveBundle(t),n={},a=Object.keys(i);let o=0;const l=[],h=()=>{e?.(l.reduce((u,f)=>u+f,0)/o)},c=a.map((u,f)=>{const d=i[u],p=Object.values(d),m=[...new Set(p.flat())].reduce((g,x)=>g+(x.progressSize||1),0);return l.push(0),o+=m,this._mapLoadToResolve(d,g=>{l[f]=g*m,h()}).then(g=>{n[u]=g})});return await Promise.all(c),r?n[t[0]]:n}async backgroundLoad(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolve(t);this._backgroundLoader.add(Object.values(e))}async backgroundLoadBundle(t){this._initialized||await this.init(),typeof t=="string"&&(t=[t]);const e=this.resolver.resolveBundle(t);Object.values(e).forEach(r=>{this._backgroundLoader.add(Object.values(r))})}reset(){this.resolver.reset(),this.loader.reset(),this.cache.reset(),this._initialized=!1}get(t){if(typeof t=="string")return ht.get(t);const e={};for(let r=0;r<t.length;r++)e[r]=ht.get(t[r]);return e}async _mapLoadToResolve(t,e){const r=[...new Set(Object.values(t))];this._backgroundLoader.active=!1;const i=await this.loader.load(r,e);this._backgroundLoader.active=!0;const n={};return r.forEach(a=>{const o=i[a.src],l=[a.src];a.alias&&l.push(...a.alias),l.forEach(h=>{n[h]=o}),ht.set(l,o)}),n}async unload(t){this._initialized||await this.init();const e=Ht(t).map(i=>typeof i!="string"?i.src:i),r=this.resolver.resolve(e);await this._unloadFromResolved(r)}async unloadBundle(t){this._initialized||await this.init(),t=Ht(t);const e=this.resolver.resolveBundle(t),r=Object.keys(e).map(i=>this._unloadFromResolved(e[i]));await Promise.all(r)}async _unloadFromResolved(t){const e=Object.values(t);e.forEach(r=>{ht.remove(r.src)}),await this.loader.unload(e)}async _detectFormats(t){let e=[];t.preferredFormats&&(e=Array.isArray(t.preferredFormats)?t.preferredFormats:[t.preferredFormats]);for(const r of t.detections)t.skipDetections||await r.test()?e=await r.add(e):t.skipDetections||(e=await r.remove(e));return e=e.filter((r,i)=>e.indexOf(r)===i),e}get detections(){return this._detections}setPreferences(t){this.loader.parsers.forEach(e=>{e.config&&Object.keys(e.config).filter(r=>r in t).forEach(r=>{e.config[r]=t[r]})})}}const Qs=new Lg;X.handleByList(k.LoadParser,Qs.loader.parsers).handleByList(k.ResolveParser,Qs.resolver.parsers).handleByList(k.CacheParser,Qs.cache.parsers).handleByList(k.DetectionParser,Qs.detections);X.add(Jf,ep,tp,ap,rp,ip,np,cp,fp,vp,bg,nc,Fg,Zf,Kf,ac,Gg);const Bo={loader:k.LoadParser,resolver:k.ResolveParser,cache:k.CacheParser,detection:k.DetectionParser};X.handle(k.Asset,s=>{const t=s.ref;Object.entries(Bo).filter(([e])=>!!t[e]).forEach(([e,r])=>X.add(Object.assign(t[e],{extension:t[e].extension??r})))},s=>{const t=s.ref;Object.keys(Bo).filter(e=>!!t[e]).forEach(e=>X.remove(t[e]))});class Dg{constructor(){this.isBatchable=!1}reset(){this.isBatchable=!1,this.context=null,this.graphicsData&&(this.graphicsData.destroy(),this.graphicsData=null)}destroy(){this.reset()}}class Og{constructor(){this.instructions=new zn}init(){this.instructions.reset()}destroy(){this.instructions.destroy(),this.instructions=null}}const Qn=class vn{constructor(t){this._renderer=t,this._managedContexts=new oi({renderer:t,type:"resource",name:"graphicsContext"})}init(t){vn.defaultOptions.bezierSmoothness=t?.bezierSmoothness??vn.defaultOptions.bezierSmoothness}getContextRenderData(t){return this.getGpuContext(t).graphicsData||this._initContextRenderData(t)}updateGpuContext(t){const e=t._gpuData,r=!!e[this._renderer.uid],i=e[this._renderer.uid]||this._initContext(t);return(t.dirty||!r)&&(r&&i.reset(),i.isBatchable=!1,t.dirty=!1),i}getGpuContext(t){return t._gpuData[this._renderer.uid]||this._initContext(t)}_initContextRenderData(t){const e=new Og,r=this.getGpuContext(t);return r.graphicsData=e,e.init(),e}_initContext(t){const e=new Dg;return e.context=t,t._gpuData[this._renderer.uid]=e,this._managedContexts.add(t),e}destroy(){this._managedContexts.destroy(),this._renderer=null}};Qn.extension={type:[k.CanvasSystem],name:"graphicsContext"};Qn.defaultOptions={bezierSmoothness:.5};let zg=Qn;class oc{constructor(t,e){this.state=Ph.for2d(),this.renderer=t,this._adaptor=e,this.renderer.runners.contextChange.add(this),this._managedGraphics=new oi({renderer:t,type:"renderable",priority:-1,name:"graphics"})}contextChange(){this._adaptor.contextChange(this.renderer)}validateRenderable(t){return!1}addRenderable(t,e){this._managedGraphics.add(t),this.renderer.renderPipes.batch.break(e),e.add(t)}updateRenderable(t){}execute(t){t.isRenderable&&this._adaptor.execute(this,t)}destroy(){this._managedGraphics.destroy(),this.renderer=null,this._adaptor.destroy(),this._adaptor=null}}oc.extension={type:[k.CanvasPipes],name:"graphics"};function Ug(s,t,e){const r=(s>>24&255)/255;t[e++]=(s&255)/255*r,t[e++]=(s>>8&255)/255*r,t[e++]=(s>>16&255)/255*r,t[e++]=r}class Ng{constructor(){this.batches=[],this.batched=!1}destroy(){this.batches.forEach(t=>{At.return(t)}),this.batches.length=0}}class lc{constructor(t,e){this.state=Ph.for2d(),this.renderer=t,this._adaptor=e,this.renderer.runners.contextChange.add(this),this._managedGraphics=new oi({renderer:t,type:"renderable",priority:-1,name:"graphics"})}contextChange(){this._adaptor.contextChange(this.renderer)}validateRenderable(t){const e=t.context,r=!!t._gpuData,n=this.renderer.graphicsContext.updateGpuContext(e);return!!(n.isBatchable||r!==n.isBatchable)}addRenderable(t,e){const i=this.renderer.graphicsContext.updateGpuContext(t.context);t.didViewUpdate&&this._rebuild(t),i.isBatchable?this._addToBatcher(t,e):(this.renderer.renderPipes.batch.break(e),e.add(t))}updateRenderable(t){const r=this._getGpuDataForRenderable(t).batches;for(let i=0;i<r.length;i++){const n=r[i];n._batcher.updateElement(n)}}execute(t){if(!t.isRenderable)return;const e=this.renderer,r=t.context;if(!e.graphicsContext.getGpuContext(r).batches.length)return;const n=r.customShader||this._adaptor.shader;this.state.blendMode=t.groupBlendMode;const a=n.resources.localUniforms.uniforms;a.uTransformMatrix=t.groupTransform,a.uRound=e._roundPixels|t._roundPixels,Ug(t.groupColorAlpha,a.uColor,0),this._adaptor.execute(this,t)}_rebuild(t){const e=this._getGpuDataForRenderable(t),i=this.renderer.graphicsContext.updateGpuContext(t.context);e.destroy(),i.isBatchable&&this._updateBatchesForRenderable(t,e)}_addToBatcher(t,e){const r=this.renderer.renderPipes.batch,i=this._getGpuDataForRenderable(t).batches;for(let n=0;n<i.length;n++){const a=i[n];r.addToBatch(a,e)}}_getGpuDataForRenderable(t){return t._gpuData[this.renderer.uid]||this._initGpuDataForRenderable(t)}_initGpuDataForRenderable(t){const e=new Ng;return t._gpuData[this.renderer.uid]=e,this._managedGraphics.add(t),e}_updateBatchesForRenderable(t,e){const r=t.context,n=this.renderer.graphicsContext.getGpuContext(r),a=this.renderer._roundPixels|t._roundPixels;e.batches=n.batches.map(o=>{const l=At.get(Hn);return o.copyTo(l),l.renderable=t,l.roundPixels=a,l})}destroy(){this._managedGraphics.destroy(),this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null}}lc.extension={type:[k.WebGLPipes,k.WebGPUPipes],name:"graphics"};X.add(oc);X.add(lc);X.add(zg);X.add(Yn);class Kr extends rh{constructor(t){t instanceof as&&(t={context:t});const{context:e,roundPixels:r,...i}=t||{};super({label:"Graphics",...i}),this.renderPipeId="graphics",e?this.context=e:(this.context=this._ownedContext=new as,this.context.autoGarbageCollect=this.autoGarbageCollect),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=r??!1}set context(t){t!==this._context&&(this._context&&(this._context.off("update",this.onViewUpdate,this),this._context.off("unload",this.unload,this)),this._context=t,this._context.on("update",this.onViewUpdate,this),this._context.on("unload",this.unload,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(t===!0||t?.context===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_onTouch(t){this._gcLastUsed=t,this._context._gcLastUsed=t}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new Kr(this._context.clone()):(this._ownedContext=null,new Kr(this._context))}lineStyle(t,e,r){V(rt,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");const i={};return t&&(i.width=t),e&&(i.color=e),r&&(i.alpha=r),this.context.strokeStyle=i,this}beginFill(t,e){V(rt,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");const r={};return t!==void 0&&(r.color=t),e!==void 0&&(r.alpha=e),this.context.fillStyle=r,this}endFill(){V(rt,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();const t=this.context.strokeStyle;return(t.width!==as.defaultStrokeStyle.width||t.color!==as.defaultStrokeStyle.color||t.alpha!==as.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return V(rt,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return V(rt,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return V(rt,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return V(rt,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return V(rt,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return V(rt,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}class Zr extends U{static create(t){const{dynamic:e,...r}=t;return new Zr({source:new Ut(r),dynamic:e??!1})}resize(t,e,r){return this.source.resize(t,e,r),this}}X.add(td,ed);class lt{constructor(t=0,e=0){this.x=t,this.y=e}set(t,e){return this.x=t,this.y=e,this}copyFrom(t){return this.x=t.x,this.y=t.y,this}add(t){return new lt(this.x+t.x,this.y+t.y)}addMut(t){return this.x+=t.x,this.y+=t.y,this}sub(t){return new lt(this.x-t.x,this.y-t.y)}scale(t){return new lt(this.x*t,this.y*t)}scaleMut(t){return this.x*=t,this.y*=t,this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSq(){return this.x*this.x+this.y*this.y}normalize(){const t=this.length();return t===0?new lt:this.scale(1/t)}distanceTo(t){return this.sub(t).length()}dot(t){return this.x*t.x+this.y*t.y}angle(){return Math.atan2(this.y,this.x)}static fromAngle(t,e=1){return new lt(Math.cos(t)*e,Math.sin(t)*e)}clone(){return new lt(this.x,this.y)}}class $g{position=new lt;velocity=new lt;size=4;rotation=0;rotationSpeed=0;opacity=1;color=16777215;skewX=0;scaleXOscillation=0;scaleXPhase=0;scaleXSpeed=0;age=0;lifetime=10;alive=!1;textureId;reset(t,e,r,i,n,a,o,l,h,c){this.position.set(t,e),this.velocity.set(r,i),this.size=n,this.rotation=a,this.rotationSpeed=(Math.random()-.5)*2,this.opacity=o,this.lifetime=l,this.color=h,this.age=0,this.alive=!0,this.textureId=c,this.skewX=0,this.scaleXOscillation=.3+Math.random()*.5,this.scaleXPhase=Math.random()*Math.PI*2,this.scaleXSpeed=1.5+Math.random()*2}update(t){if(this.alive){if(this.age+=t,this.age>=this.lifetime){this.alive=!1;return}this.position.addMut(this.velocity.scale(t)),this.rotation+=this.rotationSpeed*t,this.scaleXPhase+=this.scaleXSpeed*t}}get currentScaleX(){return 1-Math.sin(this.scaleXPhase)*this.scaleXOscillation}get lifeRatio(){return Math.min(this.age/this.lifetime,1)}}function is(s,t){return Math.random()*(t-s)+s}function Vg(s){return typeof s=="number"?s:s[Math.floor(Math.random()*s.length)]}function Wg(s,t){switch(s.type){case"point":return new lt(s.x,s.y);case"line":{const e=Math.random(),r=s.x1===-1?0:s.x1,i=s.x2===-1?t.width:s.x2,n=s.y1===-1?0:s.y1,a=s.y2===-1?t.height:s.y2;return new lt(r+(i-r)*e,n+(a-n)*e)}case"rect":{const e=s.x===-1?0:s.x,r=s.y===-1?0:s.y,i=s.width===-1?t.width:s.width,n=s.height===-1?t.height:s.height;return new lt(e+Math.random()*i,r+Math.random()*n)}}}class Hg{config;particles=[];pool=[];spawnAccumulator=0;constructor(t){this.config=t}acquire(){return this.pool.pop()??new $g}release(t){t.alive=!1,this.pool.push(t)}emit(t,e){for(this.spawnAccumulator+=this.config.spawnRate*t;this.spawnAccumulator>=1&&!(this.particles.length>=this.config.maxParticles);)this.spawnAccumulator-=1,this.spawnOne(e)}spawnOne(t){const e=this.config,r=Wg(e.spawnArea,t),i=is(e.initialDirection[0],e.initialDirection[1]),n=is(e.initialSpeed[0],e.initialSpeed[1]),a=lt.fromAngle(i,n),o=this.acquire();o.reset(r.x,r.y,a.x,a.y,is(e.initialSize[0],e.initialSize[1]),is(e.initialRotation[0],e.initialRotation[1]),is(e.initialOpacity[0],e.initialOpacity[1]),is(e.particleLifetime[0],e.particleLifetime[1]),Vg(e.color),e.texture),this.particles.push(o)}update(t){for(let e=this.particles.length-1;e>=0;e--){const r=this.particles[e];r.update(t),r.alive||(this.release(r),this.particles[e]=this.particles[this.particles.length-1],this.particles.pop())}}clear(){for(const t of this.particles)this.release(t);this.particles.length=0,this.spawnAccumulator=0}get particleCount(){return this.particles.length}}class jg{direction;constructor(t,e=Math.PI/2){this.direction=lt.fromAngle(e,t)}apply(t,e){t.velocity.addMut(this.direction.scale(e))}}class Xg{baseDirection;variability;constructor(t,e=0,r=0){this.baseDirection=lt.fromAngle(e,t),this.variability=r}apply(t,e,r){let i=this.baseDirection.x,n=this.baseDirection.y;if(this.variability>0){const a=Math.sin(r*.7+t.position.y*.01)*this.variability;i+=a,n+=Math.sin(r*1.1)*this.variability*.3}t.velocity.x+=i*e,t.velocity.y+=n*e}}class Yg{frequency;amplitude;constructor(t,e){this.frequency=t,this.amplitude=e}apply(t,e,r){const i=t.position.x*.005*this.frequency,n=t.position.y*.005*this.frequency,a=r*this.frequency,o=Math.sin(i*1.7+a*.8)*.5+Math.sin(n*2.3+a*.6)*.3+Math.sin((i+n)*1.1+a*1.2)*.2,l=Math.cos(i*2.1+a*.9)*.4+Math.cos(n*1.5+a*.7)*.35+Math.cos((i-n)*1.8+a*1.1)*.25;t.velocity.x+=o*this.amplitude*e,t.velocity.y+=l*this.amplitude*e}}class qg{constructor(t,e,r){this.target=t,this.strength=e,this.radius=r}apply(t,e){const r=this.target.sub(t.position),i=r.lengthSq();if(i>this.radius*this.radius||i<1)return;const n=Math.sqrt(i),a=this.strength*(1-n/this.radius)/n;t.velocity.x+=r.x*a*e,t.velocity.y+=r.y*a*e}}class hc{constructor(t,e,r){this.target=t,this.strength=e,this.radius=r}apply(t,e){const r=t.position.sub(this.target),i=r.lengthSq();if(i>this.radius*this.radius||i<1)return;const n=Math.sqrt(i),a=this.strength*(1-n/this.radius)/n;t.velocity.x+=r.x*a*e,t.velocity.y+=r.y*a*e}}function Kg(s){switch(s.type){case"gravity":return new jg(s.strength,s.angle);case"wind":return new Xg(s.strength,s.angle,s.variability);case"turbulence":return new Yg(s.frequency,s.amplitude);case"attract":return new qg(new lt(s.x,s.y),s.strength,s.radius);case"repel":return new hc(new lt(s.x,s.y),s.strength,s.radius)}}class Fo{emitters=[];forces=[];bounds={width:800,height:600};time=0;loadPreset(t){this.clear(),this.addEmitter(new Hg(t.emitter));for(const e of t.forces)this.addForce(Kg(e))}addEmitter(t){this.emitters.push(t)}removeEmitter(t){const e=this.emitters.indexOf(t);e!==-1&&this.emitters.splice(e,1)}addForce(t){this.forces.push(t)}clearForces(){this.forces.length=0}setBounds(t,e){this.bounds.width=t,this.bounds.height=e}update(t){this.time+=t;for(const e of this.emitters){e.emit(t,this.bounds);for(const r of e.particles)for(const i of this.forces)i.apply(r,t,this.time);e.update(t)}}clear(){for(const t of this.emitters)t.clear();this.emitters.length=0,this.forces.length=0,this.time=0}get totalParticles(){let t=0;for(const e of this.emitters)t+=e.particleCount;return t}}const Zg={snowflake:["assets/particles/snowflake.svg"],raindrop:["assets/particles/raindrop.svg"],sakura:["assets/particles/sakura.svg"],leaf:["assets/particles/leaf1.svg","assets/particles/leaf2.svg"]},Or=64;class Go{app;container;pool=[];activeCount=0;textures=new Map;fallbackTexture=null;loaded=!1;particleTextureCache=new WeakMap;constructor(t){this.app=t,this.container=new ue,this.app.stage.addChild(this.container),this.loadTextures()}async loadTextures(){const t="/ForFun_PicIsFalling/site/";this.fallbackTexture=this.createCircleTexture();for(const[e,r]of Object.entries(Zg)){const i=[];for(const n of r)try{const a=`${t}${n}`,o=await Qs.load(a),l=this.rasterize(o);i.push(l)}catch{}i.length>0&&this.textures.set(e,i)}this.loaded=!0}rasterize(t){const e=Zr.create({width:Or,height:Or}),r=new Ze(t);return r.width=Or,r.height=Or,this.app.renderer.render({container:r,target:e}),r.destroy(),e}createCircleTexture(){const t=Zr.create({width:32,height:32}),e=new Kr;return e.circle(16,16,14),e.fill(16777215),this.app.renderer.render({container:e,target:t}),e.destroy(),t}getTexture(t){const e=this.particleTextureCache.get(t),r=t.textureId??"";if(e&&e.key===r)return e.tex;let i;if(t.textureId&&this.textures.has(t.textureId)){const n=this.textures.get(t.textureId);i=n[Math.floor(Math.random()*n.length)]}else i=this.fallbackTexture;return this.particleTextureCache.set(t,{key:r,tex:i}),i}ensureCapacity(t){for(;this.pool.length<t;){const e=new Ze;e.anchor.set(.5),e.visible=!1,this.container.addChild(e),this.pool.push({sprite:e,active:!1,textureKey:""})}}sync(t){if(!this.loaded)return;const e=[];for(const r of t.emitters)for(const i of r.particles)i.alive&&e.push(i);this.ensureCapacity(e.length);for(let r=e.length;r<this.activeCount;r++)this.pool[r].sprite.visible=!1,this.pool[r].active=!1;for(let r=0;r<e.length;r++){const i=e[r],n=this.pool[r],a=this.getTexture(i);n.sprite.texture!==a&&(n.sprite.texture=a),n.sprite.x=i.position.x,n.sprite.y=i.position.y;const o=i.size/8;n.sprite.scale.set(o*i.currentScaleX,o),n.sprite.rotation=i.rotation,n.sprite.alpha=i.opacity,n.sprite.tint=i.color,n.sprite.visible=!0,n.active=!0}this.activeCount=e.length}clear(){for(let t=0;t<this.activeCount;t++)this.pool[t].sprite.visible=!1,this.pool[t].active=!1;this.activeCount=0}destroy(){this.container.destroy({children:!0})}}const Jn={name:"snow",label:"âï¸ ë",emitter:{spawnRate:40,maxParticles:800,spawnArea:{type:"line",x1:-1,y1:-20,x2:-1,y2:-20},particleLifetime:[8,16],initialSpeed:[20,60],initialDirection:[Math.PI*.4,Math.PI*.6],initialSize:[2,8],initialRotation:[0,Math.PI*2],initialOpacity:[.4,1],color:16777215,texture:"snowflake"},forces:[{type:"gravity",strength:15},{type:"turbulence",frequency:.4,amplitude:25}],background:{type:"gradient",gradient:"linear-gradient(180deg, #0a1628 0%, #1a2a4a 40%, #2c3e6b 70%, #3d5a80 100%)"}},cc={name:"rain",label:"ð§ï¸ ë¹",emitter:{spawnRate:120,maxParticles:2e3,spawnArea:{type:"line",x1:-1,y1:-30,x2:-1,y2:-30},particleLifetime:[2,5],initialSpeed:[150,250],initialDirection:[Math.PI*.47,Math.PI*.53],initialSize:[1,3],initialRotation:[0,0],initialOpacity:[.3,.7],color:[11193599,8956637,10075118],texture:"raindrop"},forces:[{type:"gravity",strength:80},{type:"wind",strength:15,angle:0,variability:8}],background:{type:"gradient",gradient:"linear-gradient(180deg, #2c3e50 0%, #4a6274 30%, #5a7a8a 60%, #6b8f9e 85%, #3d5c5c 100%)"}},uc={name:"sakura",label:"ð¸ ë²ê½",emitter:{spawnRate:15,maxParticles:300,spawnArea:{type:"line",x1:-1,y1:-20,x2:-1,y2:-20},particleLifetime:[10,20],initialSpeed:[10,35],initialDirection:[Math.PI*.3,Math.PI*.7],initialSize:[3,7],initialRotation:[0,Math.PI*2],initialOpacity:[.6,1],color:[16758725,16751018,16761035,16755387,16769256],texture:"sakura"},forces:[{type:"gravity",strength:8},{type:"wind",strength:12,angle:-.3,variability:15},{type:"turbulence",frequency:.3,amplitude:35}],background:{type:"gradient",gradient:"linear-gradient(180deg, #e8c4d0 0%, #f0d4dd 20%, #fce4ec 45%, #e8b4c8 70%, #5d8a66 85%, #4a7a5a 100%)"}},dc={name:"leaves",label:"ð ëì½",emitter:{spawnRate:10,maxParticles:200,spawnArea:{type:"line",x1:-1,y1:-20,x2:-1,y2:-20},particleLifetime:[12,25],initialSpeed:[15,40],initialDirection:[Math.PI*.25,Math.PI*.75],initialSize:[4,10],initialRotation:[0,Math.PI*2],initialOpacity:[.7,1],color:[13395507,14518340,12277026,15636821,11158545,13399859],texture:"leaf"},forces:[{type:"gravity",strength:10},{type:"wind",strength:18,angle:-.2,variability:20},{type:"turbulence",frequency:.25,amplitude:45}],background:{type:"gradient",gradient:"linear-gradient(180deg, #87CEEB 0%, #b8d4e3 25%, #d4a574 50%, #c4813d 70%, #8b6914 85%, #5a4a2a 100%)"}},ta=[Jn,cc,uc,dc],fc={snow:Jn,rain:cc,sakura:uc,leaves:dc},hi=at("snow"),ea=at(Jn),As=at(40),Ss=at(800),Cs=at(2),Ps=at(8),Ms=at(1),Ts=at(3),ks=at(2),Es=at("#ffffff"),Lo=at(null),Do=at(!1);function Qg(s){return parseInt(s.replace("#",""),16)}const Jg=Yu([ea,As,Ss,Cs,Ps,Ms,Ts,ks,Es],([s,t,e,r,i,n,a,o,l])=>{const h=a*15,c=o*.3;return{...s,emitter:{...s.emitter,spawnRate:t,maxParticles:e,initialSize:[r,i],initialOpacity:[Math.max(.2,n-.3),n],initialSpeed:[h*(1-c),h*(1+c)],color:Qg(l)},forces:s.forces.map(f=>f.type==="gravity"?{...f,strength:a*5}:f)}});function pc(s){hi.set(s.name),ea.set(s),As.set(s.emitter.spawnRate),Ss.set(s.emitter.maxParticles),Cs.set(s.emitter.initialSize[0]),Ps.set(s.emitter.initialSize[1]),Ms.set(s.emitter.initialOpacity[1]);const t=(s.emitter.initialSpeed[0]+s.emitter.initialSpeed[1])/2;Ts.set(Math.round(t/15)),ks.set(2);const e=typeof s.emitter.color=="number"?s.emitter.color:s.emitter.color[0];Es.set("#"+e.toString(16).padStart(6,"0"))}const Oo=at(!0),wn=at("default"),Qr=at("#0d182c"),An=at(null),ms=at(!1),mc=at(null);function ty(s){return s.canvas.toDataURL("image/png")}function ey(s,t="screenshot.png"){const e=ty(s),r=document.createElement("a");r.href=e,r.download=t,r.click()}var sy=nt('<div class="canvas-container svelte-dfb6jk"></div>');function ry(s,t){Ot(t,!0);const e=()=>Z(mc,"$ambientGradient",a),r=()=>Z(Jg,"$livePreset",a),i=()=>Z(ms,"$useBackgroundImage",a),n=()=>Z(An,"$backgroundImage",a),[a,o]=si();let l,h=null,c=null,u=null,f=null,d=[],p=ru(()=>{const C=e();if(C)return C;const A=r();return i()&&n()?`url(${n()})`:A.background?.type==="gradient"&&A.background.gradient?A.background.gradient:"none"});function y(){h&&(h.clear(),h.loadPreset(r()),f&&h.addForce(f))}function m(){if(h){for(const C of h.emitters)C.clear();c?.clear()}}function g(){u&&ey(u)}function x(C){if(!u)return;const A=fc[C];if(!A)return;const M=new Fo;M.setBounds(window.innerWidth,window.innerHeight),M.loadPreset(A),f&&M.addForce(f);const E=new Go(u);d=[...d,{system:M,renderer:E,preset:C}]}function _(C){if(C<0||C>=d.length)return;const A=d[C];A.system.clear(),A.renderer.clear(),A.renderer.destroy(),d=d.filter((M,E)=>E!==C)}function b(){return d.length}Hr(()=>{const C=r();h&&h.emitters.length>0&&(h.emitters[0].config={...C.emitter})}),Dl(async()=>{u=new Uh,await u.init({resizeTo:window,backgroundAlpha:0,antialias:!0}),l.appendChild(u.canvas),h=new Fo,h.setBounds(window.innerWidth,window.innerHeight),h.loadPreset(r()),c=new Go(u);const C=new lt(-9999,-9999);return f=new hc(C,120,100),h.addForce(f),window.addEventListener("resize",()=>{h?.setBounds(window.innerWidth,window.innerHeight);for(const A of d)A.system.setBounds(window.innerWidth,window.innerHeight)}),window.addEventListener("mousemove",A=>{C.set(A.clientX,A.clientY)}),window.addEventListener("mouseleave",()=>{C.set(-9999,-9999)}),u.ticker.add(A=>{const M=A.deltaTime/60;h?.update(M),h&&c?.sync(h);for(const E of d)E.system.update(M),E.renderer.sync(E.system)}),()=>{for(const A of d)A.renderer.destroy();c?.destroy(),u?.destroy(!0)}});var S={apply:y,clear:m,screenshot:g,addLayer:x,removeLayer:_,getLayerCount:b},v=sy();let w;Ll(v,C=>l=C,()=>l),Mt(()=>w=zu(v,"",w,{"background-image":B(p),"background-size":"cover","background-position":"center"})),it(s,v);var P=zt(S);return o(),P}var iy=nt('<div class="slider-control svelte-1en4wt"><div class="label-row svelte-1en4wt"><span class="label-text svelte-1en4wt"> </span> <span class="value-text svelte-1en4wt"> </span></div> <input type="range" class="svelte-1en4wt"/></div>');function be(s,t){Ot(t,!0);let e=xa(t,"step",3,1),r=xa(t,"unit",3,"");var i=iy(),n=F(i),a=F(n),o=F(a),l=I(a,2),h=F(l),c=I(n,2);Mt(()=>{wt(o,t.label),wt(h,`${t.value??""}${r()??""}`),ls(c,"min",t.min),ls(c,"max",t.max),ls(c,"step",e()),Gl(c,t.value),ls(c,"aria-label",t.label)}),st("input",c,u=>t.onchange(Number(u.currentTarget.value))),it(s,i),zt()}fe(["input"]);var ny=nt('<div class="color-picker svelte-nzank0"><span class="label-text svelte-nzank0"> </span> <div class="input-row svelte-nzank0"><input type="color" class="svelte-nzank0"/> <span class="hex-value svelte-nzank0"> </span></div></div>');function zo(s,t){Ot(t,!0);var e=ny(),r=F(e),i=F(r),n=I(r,2),a=F(n),o=I(a,2),l=F(o);Mt(()=>{wt(i,t.label),Gl(a,t.value),wt(l,t.value)}),st("input",a,h=>t.onchange(h.currentTarget.value)),it(s,e),zt()}fe(["input"]);var ay=nt('<img alt="ë¯¸ë¦¬ë³´ê¸°" class="preview svelte-1fhwk8q"/>'),oy=nt('<div class="image-uploader svelte-1fhwk8q"><span class="label-text svelte-1fhwk8q"> </span> <!> <label class="upload-btn svelte-1fhwk8q"><input type="file" accept="image/*" class="svelte-1fhwk8q"/> <span>ì´ë¯¸ì§ ìë¡ë</span></label></div>');function Uo(s,t){Ot(t,!0);function e(c){const f=c.currentTarget.files?.[0];if(!f)return;const d=new FileReader;d.onload=()=>{typeof d.result=="string"&&t.onupload(d.result)},d.readAsDataURL(f)}var r=oy(),i=F(r),n=F(i),a=I(i,2);{var o=c=>{var u=ay();Mt(()=>ls(u,"src",t.preview)),it(c,u)};we(a,c=>{t.preview&&c(o)})}var l=I(a,2),h=F(l);Mt(()=>wt(n,t.label)),st("change",h,e),it(s,r),zt()}fe(["change"]);var ly=nt('<button><span class="preset-label svelte-1rep955"> </span></button>'),hy=nt('<div class="preset-selector svelte-1rep955"></div>');function cy(s,t){Ot(t,!0);var e=hy();jr(e,21,()=>ta,r=>r.name,(r,i)=>{var n=ly();let a;var o=F(n),l=F(o);Mt(()=>{a=lr(n,1,"preset-btn svelte-1rep955",null,a,{active:t.current===B(i).name}),wt(l,B(i).label)}),st("click",n,()=>t.onselect(B(i))),it(r,n)}),it(s,e),zt()}fe(["click"]);Wc();var uy=nt('<button><span class="tab-icon svelte-1swg5ds"> </span> <span class="tab-label svelte-1swg5ds"> </span></button>'),dy=nt('<nav class="mode-tabs svelte-1swg5ds"></nav>');function fy(s,t){Ot(t,!1);const e=()=>Z(wn,"$currentMode",r),[r,i]=si(),n=[{id:"default",label:"ê¸°ë³¸",icon:"â¨"},{id:"ambient",label:"Ambient",icon:"ð"},{id:"create",label:"Create",icon:"ð¨"}];ju();var a=dy();jr(a,5,()=>n,o=>o.id,(o,l)=>{var h=uy();let c;var u=F(h),f=F(u),d=I(u,2),p=F(d);Mt(()=>{c=lr(h,1,"tab svelte-1swg5ds",null,c,{active:e()===B(l).id}),wt(f,B(l).icon),wt(p,B(l).label)}),st("click",h,()=>wn.set(B(l).id)),it(o,h)}),it(s,a),zt(),i()}fe(["click"]);const ns={dawn:{gradient:"linear-gradient(180deg, #1a1a2e 0%, #4a3060 20%, #e07050 50%, #f0a060 70%, #f8d080 100%)",label:"ìë²½"},morning:{gradient:"linear-gradient(180deg, #87CEEB 0%, #a8d8ea 30%, #d4e8f0 60%, #e8f4e8 80%, #90c090 100%)",label:"ìì¹¨"},afternoon:{gradient:"linear-gradient(180deg, #4a90d9 0%, #6aabe0 30%, #87CEEB 55%, #a0d0a0 80%, #70a070 100%)",label:"ë®"},sunset:{gradient:"linear-gradient(180deg, #2d1b4e 0%, #8b3a62 25%, #e06040 50%, #f0a030 75%, #f0c060 100%)",label:"ë¸ì"},evening:{gradient:"linear-gradient(180deg, #0a0a20 0%, #1a1a40 30%, #2a2060 55%, #3a3080 75%, #252050 100%)",label:"ì ë"},night:{gradient:"linear-gradient(180deg, #050510 0%, #0a0a28 30%, #101040 60%, #0d0d30 80%, #080820 100%)",label:"ë°¤"}};function gc(s){const t=new Date().getHours();return t>=5&&t<7?ns.dawn:t>=7&&t<12?ns.morning:t>=12&&t<17?ns.afternoon:t>=17&&t<19?ns.sunset:t>=19&&t<21?ns.evening:ns.night}function py(s){return gc().label}class my{presetList;currentIndex=0;intervalMs;timer=null;onChange;constructor(t,e){this.presetList=[...ta],this.intervalMs=t,this.onChange=e}start(){this.stop(),this.timer=setInterval(()=>{this.currentIndex=(this.currentIndex+1)%this.presetList.length,this.onChange(this.presetList[this.currentIndex])},this.intervalMs)}stop(){this.timer&&(clearInterval(this.timer),this.timer=null)}setInterval(t){this.intervalMs=t,this.timer&&(this.stop(),this.start())}get isRunning(){return this.timer!==null}get current(){return this.presetList[this.currentIndex]}}var gy=nt('<div class="ambient-panel svelte-1av3q76"><section class="svelte-1av3q76"><h3 class="svelte-1av3q76">ð Ambient Mode</h3></section> <section class="svelte-1av3q76"><h4 class="svelte-1av3q76">ìê°ë ë°°ê²½</h4> <p class="desc svelte-1av3q76">íì¬ ìê°ì ë§ë ë°°ê²½ ê·¸ë¼ëì¸í¸ë¥¼ ìë ì ì©í©ëë¤.</p> <button> </button></section> <section class="svelte-1av3q76"><h4 class="svelte-1av3q76">ìë íë¦¬ì ìí</h4> <p class="desc svelte-1av3q76">ì¼ì  ê°ê²©ì¼ë¡ ì´íí¸ê° ìë ì íë©ëë¤.</p> <button> </button> <!></section> <section class="svelte-1av3q76"><h4 class="svelte-1av3q76">ì ì²´íë©´</h4> <button class="toggle-btn wide svelte-1av3q76"> </button></section> <section class="svelte-1av3q76"><h4 class="svelte-1av3q76">ë ì¨ API ì°ë</h4> <span class="badge svelte-1av3q76">ì¤ë¹ ì¤</span></section> <section class="svelte-1av3q76"><h4 class="svelte-1av3q76">ìì ë¹ì£¼ì¼ë¼ì´ì </h4> <span class="badge svelte-1av3q76">ì¤ë¹ ì¤</span></section></div>');function yy(s,t){Ot(t,!0);let e=ft(!1),r=ft(!1),i=ft(30),n=ft(!1),a=ft(Ne(py())),o=null,l=null;function h(){et(e,!B(e)),B(e)?(c(),o=setInterval(c,6e4)):(o&&clearInterval(o),o=null)}function c(){const E=gc();et(a,E.label,!0),t.onTimeBackground(E.gradient)}function u(){et(r,!B(r)),B(r)?(l=new my(B(i)*1e3,E=>{pc(E),t.onApply()}),l.start()):(l?.stop(),l=null)}function f(E){et(i,E,!0),l?.setInterval(E*1e3)}function d(){document.fullscreenElement?(document.exitFullscreen(),et(n,!1)):(document.documentElement.requestFullscreen(),et(n,!0))}qu(()=>{o&&clearInterval(o),l?.stop()});var p=gy(),y=I(F(p),2),m=I(F(y),4);let g;var x=F(m),_=I(y,2),b=I(F(_),4);let S;var v=F(b),w=I(b,2);{var P=E=>{be(E,{label:"ì í ê°ê²©",get value(){return B(i)},min:5,max:120,step:5,unit:"ì´",onchange:f})};we(w,E=>{B(r)&&E(P)})}var C=I(_,2),A=I(F(C),2),M=F(A);Mt(()=>{g=lr(m,1,"toggle-btn svelte-1av3q76",null,g,{active:B(e)}),wt(x,B(e)?`ð¤ï¸ íì± (${B(a)})`:"â¸ï¸ ë¹íì±"),S=lr(b,1,"toggle-btn svelte-1av3q76",null,S,{active:B(r)}),wt(v,B(r)?"ð ìí ì¤":"â¸ï¸ ë¹íì±"),wt(M,B(n)?"ð² ì ì²´íë©´ í´ì ":"ð¥ï¸ ì ì²´íë©´")}),st("click",m,h),st("click",b,u),st("click",A,d),it(s,p),zt()}fe(["click"]);function _y(s,t,e){return{version:1,preset:s,params:t,background:e}}function yc(){return _y(kt(hi),{spawnRate:kt(As),maxParticles:kt(Ss),minSize:kt(Cs),maxSize:kt(Ps),opacity:kt(Ms),speed:kt(Ts),speedVariety:kt(ks),particleColor:kt(Es)},{color:kt(Qr),useImage:kt(ms)})}function xy(){return JSON.stringify(yc(),null,2)}function by(s="scene.json"){const t=xy(),e=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(e),i=document.createElement("a");i.href=r,i.download=s,i.click(),URL.revokeObjectURL(r)}function _c(s){if(s.version!==1)return!1;const t=fc[s.preset];return t&&(hi.set(s.preset),ea.set(t)),As.set(s.params.spawnRate),Ss.set(s.params.maxParticles),Cs.set(s.params.minSize),Ps.set(s.params.maxSize),Ms.set(s.params.opacity),Ts.set(s.params.speed),ks.set(s.params.speedVariety),Es.set(s.params.particleColor),Qr.set(s.background.color),ms.set(s.background.useImage),!0}function vy(s){try{const t=JSON.parse(s);return _c(t)}catch{return!1}}function wy(){return new Promise(s=>{const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=async()=>{const e=t.files?.[0];if(!e){s(!1);return}const r=await e.text();s(vy(r))},t.click()})}function Ay(){const s=yc(),t=JSON.stringify(s),e=btoa(encodeURIComponent(t));return`${window.location.origin+window.location.pathname}?scene=${e}`}function Sy(){const s=Ay();return navigator.clipboard.writeText(s).then(()=>!0,()=>!1)}function Cy(){const t=new URLSearchParams(window.location.search).get("scene");if(!t)return!1;try{const e=decodeURIComponent(atob(t)),r=JSON.parse(e);return _c(r)}catch{return!1}}var Py=nt('<p class="status svelte-ihtysa"> </p>'),My=nt("<option> </option>"),Ty=nt('<div class="layer-item svelte-ihtysa"><span class="layer-name svelte-ihtysa"> </span> <button class="layer-remove svelte-ihtysa">â</button></div>'),ky=nt('<div class="layer-list svelte-ihtysa"></div>'),Ey=nt('<p class="placeholder svelte-ihtysa">ì¶ê°ë ë ì´ì´ê° ììµëë¤.</p>'),Iy=nt('<div class="create-panel svelte-ihtysa"><section class="svelte-ihtysa"><h3 class="svelte-ihtysa">ð¨ Create Mode</h3></section> <section class="svelte-ihtysa"><h4 class="svelte-ihtysa">ì¥ë©´ ì ì¥/ë¶ë¬ì¤ê¸°</h4> <div class="btn-row svelte-ihtysa"><button class="action-btn svelte-ihtysa">ð¾ JSON ì ì¥</button> <button class="action-btn svelte-ihtysa">ð ë¶ë¬ì¤ê¸°</button></div></section> <section class="svelte-ihtysa"><h4 class="svelte-ihtysa">URL ê³µì </h4> <button class="action-btn wide svelte-ihtysa">ð ê³µì  ë§í¬ ë³µì¬</button> <!></section> <section class="svelte-ihtysa"><h4 class="svelte-ihtysa">ì¤í¬ë¦°ì·</h4> <button class="action-btn wide svelte-ihtysa">ð¸ PNG ì¤í¬ë¦°ì· ì ì¥</button></section> <section class="svelte-ihtysa"><h4 class="svelte-ihtysa">ë©í° ë ì´ì´</h4> <p class="desc svelte-ihtysa">ì¬ë¬ ì´íí¸ë¥¼ ëìì ê²¹ì³ ê¹ì´ê°ì ííí©ëë¤.</p> <div class="layer-add svelte-ihtysa"><select class="layer-select svelte-ihtysa"></select> <button class="action-btn svelte-ihtysa">+ ë ì´ì´ ì¶ê°</button></div> <!></section></div>');function Ry(s,t){Ot(t,!0);let e=ft(""),r=ft("snow");async function i(){const P=await Sy();et(e,P?"â ë§í¬ê° ë³µì¬ëììµëë¤!":"â ë³µì¬ ì¤í¨",!0),setTimeout(()=>et(e,""),3e3)}async function n(){await wy()||alert("íì¼ì ë¶ë¬ì¬ ì ììµëë¤.")}var a=Iy(),o=I(F(a),2),l=I(F(o),2),h=F(l),c=I(h,2),u=I(o,2),f=I(F(u),2),d=I(f,2);{var p=P=>{var C=Py(),A=F(C);Mt(()=>wt(A,B(e))),it(P,C)};we(d,P=>{B(e)&&P(p)})}var y=I(u,2),m=I(F(y),2),g=I(y,2),x=I(F(g),4),_=F(x);jr(_,21,()=>ta,P=>P.name,(P,C)=>{var A=My(),M=F(A),E={};Mt(()=>{wt(M,B(C).label),E!==(E=B(C).name)&&(A.value=(A.__value=B(C).name)??"")}),it(P,A)});var b=I(_,2),S=I(x,2);{var v=P=>{var C=ky();jr(C,21,()=>t.layers,Ru,(A,M,E)=>{var N=Ty(),$=F(N),Nt=F($),T=I($,2);Mt(()=>wt(Nt,`ë ì´ì´ ${E+1}: ${B(M)??""}`)),st("click",T,()=>t.onRemoveLayer(E)),it(A,N)}),it(P,C)},w=P=>{var C=Ey();it(P,C)};we(S,P=>{t.layers.length>0?P(v):P(w,!1)})}st("click",h,()=>by()),st("click",c,n),st("click",f,i),st("click",m,function(...P){t.onScreenshot?.apply(this,P)}),Nu(_,()=>B(r),P=>et(r,P)),st("click",b,()=>t.onAddLayer(B(r))),it(s,a),zt()}fe(["click"]);var By=nt('<div class="panel-content svelte-1ky11bv"><!> <section class="svelte-1ky11bv"><h3 class="svelte-1ky11bv">ì´íí¸ ì í</h3> <!></section> <!> <section class="svelte-1ky11bv"><h3 class="svelte-1ky11bv">íí°í´ ì¤ì </h3> <!> <!> <!> <!> <!> <!> <!> <!></section> <section class="svelte-1ky11bv"><h3 class="svelte-1ky11bv">ì»¤ì¤í ì´ë¯¸ì§</h3> <label class="toggle-row svelte-1ky11bv"><input type="checkbox"/> <span>ì´ë¯¸ì§ ëì¡ì´ ì¬ì©</span></label> <!></section> <section class="svelte-1ky11bv"><h3 class="svelte-1ky11bv">ë°°ê²½ ì¤ì </h3> <label class="toggle-row svelte-1ky11bv"><input type="radio" name="bg"/> <span>ë¨ì ë°°ê²½</span></label> <!> <label class="toggle-row svelte-1ky11bv"><input type="radio" name="bg"/> <span>ì´ë¯¸ì§ ë°°ê²½</span></label> <!></section> <div class="button-row svelte-1ky11bv"><button class="btn btn-apply svelte-1ky11bv">ë°ë¡ ì ì©</button> <button class="btn btn-clear svelte-1ky11bv">ëª¨ë ì ê±°</button></div></div>');function Fy(s,t){Ot(t,!0);const e=()=>Z(hi,"$currentPresetName",g),r=()=>Z(wn,"$currentMode",g),i=()=>Z(Ss,"$maxParticles",g),n=()=>Z(As,"$spawnRate",g),a=()=>Z(Cs,"$minSize",g),o=()=>Z(Ps,"$maxSize",g),l=()=>Z(Ms,"$opacity",g),h=()=>Z(Ts,"$speed",g),c=()=>Z(ks,"$speedVariety",g),u=()=>Z(Es,"$particleColor",g),f=()=>Z(Do,"$useCustomTexture",g),d=()=>Z(Lo,"$customTexture",g),p=()=>Z(ms,"$useBackgroundImage",g),y=()=>Z(Qr,"$backgroundColor",g),m=()=>Z(An,"$backgroundImage",g),[g,x]=si();function _(G){pc(G),t.onApply()}var b=By(),S=F(b);fy(S,{});var v=I(S,2),w=I(F(v),2);cy(w,{get current(){return e()},onselect:_});var P=I(v,2);{var C=G=>{yy(G,{get onApply(){return t.onApply},get onTimeBackground(){return t.onTimeBackground}})},A=G=>{Ry(G,{get onScreenshot(){return t.onScreenshot},get onAddLayer(){return t.onAddLayer},get onRemoveLayer(){return t.onRemoveLayer},get layers(){return t.layers}})};we(P,G=>{r()==="ambient"?G(C):r()==="create"&&G(A,1)})}var M=I(P,2),E=I(F(M),2);be(E,{label:"íí°í´ ì",get value(){return i()},min:50,max:3e3,step:50,onchange:G=>Ss.set(G)});var N=I(E,2);be(N,{label:"ìì± ìë",get value(){return n()},min:5,max:200,step:5,unit:"/s",onchange:G=>As.set(G)});var $=I(N,2);be($,{label:"ìµì í¬ê¸°",get value(){return a()},min:1,max:20,step:.5,onchange:G=>Cs.set(G)});var Nt=I($,2);be(Nt,{label:"ìµë í¬ê¸°",get value(){return o()},min:2,max:30,step:.5,onchange:G=>Ps.set(G)});var T=I(Nt,2);be(T,{label:"í¬ëªë",get value(){return l()},min:.1,max:1,step:.05,onchange:G=>Ms.set(G)});var R=I(T,2);be(R,{label:"ëí ìë",get value(){return h()},min:1,max:20,step:.5,onchange:G=>Ts.set(G)});var me=I(R,2);be(me,{label:"ìë ë¤ìì±",get value(){return c()},min:0,max:5,step:.5,onchange:G=>ks.set(G)});var O=I(me,2);zo(O,{label:"íí°í´ ìì",get value(){return u()},onchange:G=>Es.set(G)});var $t=I(M,2),ge=I(F($t),2),ye=F(ge),Ee=I(ge,2);{var vr=G=>{Uo(G,{label:"",get preview(){return d()},onupload:Be=>Lo.set(Be)})};we(Ee,G=>{f()&&G(vr)})}var Ie=I($t,2),_e=I(F(Ie),2),Ls=F(_e),Ds=I(_e,2);{var ts=G=>{zo(G,{label:"",get value(){return y()},onchange:Be=>Qr.set(Be)})};we(Ds,G=>{p()||G(ts)})}var Re=I(Ds,2),es=F(Re),se=I(Re,2);{var re=G=>{Uo(G,{label:"",get preview(){return m()},onupload:Be=>An.set(Be)})};we(se,G=>{p()&&G(re)})}var ie=I(Ie,2),Zt=F(ie),ci=I(Zt,2);Mt(()=>{di(ye,f()),di(Ls,!p()),di(es,p())}),st("change",ye,G=>Do.set(G.currentTarget.checked)),st("change",Ls,()=>ms.set(!1)),st("change",es,()=>ms.set(!0)),st("click",Zt,function(...G){t.onApply?.apply(this,G)}),st("click",ci,function(...G){t.onClear?.apply(this,G)}),it(s,b),zt(),x()}fe(["change","click"]);var Gy=nt('<aside><div class="panel-body svelte-fi6m1m"><!></div> <button class="toggle-btn svelte-fi6m1m" aria-label="í¨ë í ê¸"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></button></aside>');function Ly(s,t){Ot(t,!0);const e=()=>Z(Oo,"$panelOpen",r),[r,i]=si();function n(){Oo.update(d=>!d)}var a=Gy();let o;var l=F(a),h=F(l);Lu(h,()=>t.children);var c=I(l,2),u=F(c),f=F(u);Mt(()=>{o=lr(a,1,"side-panel svelte-fi6m1m",null,o,{open:e()}),ls(f,"d",e()?"M10 3L5 8L10 13":"M6 3L11 8L6 13")}),st("click",c,n),it(s,a),zt(),i()}fe(["click"]);var Dy=nt("<!> <!>",1);function Oy(s,t){Ot(t,!0);let e=ft(void 0),r=ft(Ne([]));function i(){B(e)?.apply()}function n(){B(e)?.clear()}function a(){B(e)?.screenshot()}function o(d){B(e)?.addLayer(d),et(r,[...B(r),d],!0)}function l(d){B(e)?.removeLayer(d),et(r,B(r).filter((p,y)=>y!==d),!0)}function h(d){mc.set(d)}var c=Dy(),u=cu(c);Ll(ry(u,{}),d=>et(e,d,!0),()=>B(e));var f=I(u,2);Ly(f,{children:(d,p)=>{Fy(d,{onApply:i,onClear:n,onScreenshot:a,onAddLayer:o,onRemoveLayer:l,onTimeBackground:h,get layers(){return B(r)}})},$$slots:{default:!0}}),it(s,c),zt()}ku(Oy,{target:document.getElementById("app")});Cy();export{Sh as $,Fh as A,dr as B,Lt as C,tt as D,pe as E,br as F,ni as G,ko as H,V as I,rt as J,Wl as K,ct as L,D as M,vs as N,ht as O,yt as P,kp as Q,cn as R,Nn as S,U as T,Xr as U,oi as V,to as W,Nr as X,Un as Y,Ih as Z,Ut as _,Ph as a,am as a0,lm as a1,mm as a2,dm as a3,dd as a4,_m as a5,At as a6,Kl as a7,qt as a8,sh as a9,La as aa,Ze as ab,Wd as ac,Oa as ad,wi as ae,za as af,jd as ag,Jl as ah,Zr as ai,Ug as aj,Gh as ak,Yf as al,Vf as am,$p as an,Gp as ao,om as ap,hm as aq,gm as ar,pm as as,ym as at,bh as b,ri as c,Rp as d,bt as e,J as f,pf as g,W as h,Ur as i,k as j,Kr as k,Fm as l,Ql as m,Aa as n,Cm as o,ug as p,ch as q,X as r,li as s,cs as t,Cf as u,Md as v,q as w,ue as x,as as y,Zs as z};
